<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="color-scheme" content="light dark">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Neovim help pages, always up-to-date">
<title>Neovim: if_ruby.txt</title>
<link rel="shortcut icon" href="s/h3E0J2MHNKfIuCqP/favicon-neovim.ico">
<!-- favicon taken from https://neovim.io/favicon.ico, which is licensed under CC-BY-3.0: https://creativecommons.org/licenses/by/3.0/ -->

<link rel="stylesheet" href="s/MsMIu46igYudff1x/tom-select.min.css">
<script defer src="s/RLcAbtLBYX-q5me0/tom-select.base.min.js"></script>

<link rel="stylesheet" href="s/QRMkrs52-wJfIQ-w/vimhelp.css">
<noscript><link rel="stylesheet" href="s/eRFCn9A-K4lmzV_A/noscript.css"></noscript>
<script defer src="s/KpwrKyx19dtnhPoe/vimhelp.js"></script>
</head>
<body>




<div class="bar">
  <div class="ql">Quick links:
<a href="index.html">help overview</a> &middot;
<a href="quickref.txt.html">quick reference</a> &middot;
<a href="usr_toc.txt.html">user manual toc</a> &middot;
<a href="index.html#reference_toc">reference manual toc</a>
</div>
  <div class="tag srch need-js">
    <select id="vh-select-tag"></select>
    <div class="placeholder">Go to keyword<span class="not-mobile">&nbsp;(shortcut: <kbd>k</kbd>)</span></div>
  </div>
  <form class="site srch" action="https://duckduckgo.com" method="get" target="_blank" rel="noopener noreferrer">
    <input type="hidden" name="sites" value="neo.vimhelp.org">
    <input type="search" name="q" id="vh-srch-input" placeholder="Site search">
    <div class="placeholder need-js">Site search<span class="not-mobile">&nbsp;(shortcut: <kbd>s</kbd>)</span></div>
  </form>
  <div id="theme-switcher" class="need-js">
  <button id="theme-current" title="Switch theme">Theme</button>
  <div id="theme-dropdown"><ul>
    <li><button id="theme-native" title="Switch to native theme">Native</button></li>
    <li><button id="theme-light" title="Switch to light theme">Light</button></li>
    <li><button id="theme-dark" title="Switch to dark theme">Dark</button></li>
  </ul></div>
</div>

</div>

<main>
<div id="vh-sidebar">
<ul><li><a href="if_ruby.txt.html#">↑Top↑</a></li>
<li><a href="if_ruby.txt.html#ruby-commands">Commands</a></li>
<li><a href="if_ruby.txt.html#ruby-vim">The VIM module</a></li>
<li><a href="if_ruby.txt.html#ruby-buffer">VIM::Buffer objects</a></li>
<li><a href="if_ruby.txt.html#ruby-window">VIM::Window objects</a></li>
<li><a href="if_ruby.txt.html#ruby-globals">Global variables</a></li>
<li><a href="if_ruby.txt.html#ruby-rubyeval">rubyeval() Vim function</a></li>
</ul>
</div>
<div id="vh-content">
<pre>
<span id="if_ruby.txt" class="t">if_ruby.txt</span>          Nvim


		  <span class="i">VIM REFERENCE MANUAL    by Shugo Maeda</span>

The <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> Interface to Vim				<span id="if_ruby" class="t">if_ruby</span> <span id="ruby" class="t">ruby</span> <span id="Ruby" class="t">Ruby</span>

			<span id="E266" class="t">E266</span> <span id="E267" class="t">E267</span> <span id="E268" class="t">E268</span> <span id="E269" class="t">E269</span> <span id="E270" class="t">E270</span> <span id="E271" class="t">E271</span> <span id="E272" class="t">E272</span> <span id="E273" class="t">E273</span>

The <a href="intro.txt.html#home" class="d">home</a> page <a href="luaref.txt.html#for" class="d">for</a> <a href="if_ruby.txt.html#ruby" class="d">ruby</a> <a href="motion.txt.html#is" class="d">is</a> <a class="u" href="https://www.ruby-lang.org/">https://www.ruby-lang.org/</a>.  You can find links <a href="luaref.txt.html#for" class="d">for</a>
downloading <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> there.

                                      Type <a href="various.txt.html#gO" class="l">gO</a> to see the table of contents.

<span class="h">==============================================================================</span>
1. Commands						<span id="ruby-commands" class="t">ruby-commands</span>

							<span id="%3Aruby" class="t">:ruby</span> <span id="%3Arub" class="t">:rub</span>
:rub[y] <span class="s">{cmd}</span>		Execute <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> command <span class="s">{cmd}</span>.  <a href="insert.txt.html#A" class="d">A</a> command to try <a href="motion.txt.html#it" class="d">it</a> out: 
<span class="e">				:ruby print "Hello"</span>
<span class="e"></span>
:rub[y] <a href="change.txt.html#%3C%3C" class="d">&lt;&lt;</a> <span class="s">[trim]</span> [{endmarker}]
<span class="s">{script}</span>
<span class="s">{endmarker}</span>
			Execute <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> <a href="usr_41.txt.html#script" class="d">script</a> <span class="s">{script}</span>.

			If <span class="s">[endmarker]</span> <a href="motion.txt.html#is" class="d">is</a> omitted, <a href="motion.txt.html#it" class="d">it</a> <a href="vim_diff.txt.html#defaults" class="d">defaults</a> to <a href="insert.txt.html#a" class="d">a</a> dot '.'
			like <a href="luaref.txt.html#for" class="d">for</a> the <a href="insert.txt.html#%3Aappend" class="l">:append</a> and <a href="insert.txt.html#%3Ainsert" class="l">:insert</a> commands.  Refer
			to <a href="vimeval.txt.html#%3Alet-heredoc" class="l">:let-heredoc</a> <a href="luaref.txt.html#for" class="d">for</a> more information.


			This form of the <a href="if_ruby.txt.html#%3Aruby" class="l">:ruby</a> command <a href="motion.txt.html#is" class="d">is</a> mainly useful <a href="luaref.txt.html#for" class="d">for</a>
			including <a href="if_ruby.txt.html#ruby" class="d">ruby</a> code in vim scripts.

Example Vim script: 
<span class="e"></span>
<span class="e">	function! RedGem()</span>
<span class="e">	ruby &lt;&lt; EOF</span>
<span class="e">	class Garnet</span>
<span class="e">		def initialize(s)</span>
<span class="e">			@buffer = VIM::Buffer.current</span>
<span class="e">			vimputs(s)</span>
<span class="e">		end</span>
<span class="e">		def vimputs(s)</span>
<span class="e">			@buffer.append(@buffer.count,s)</span>
<span class="e">		end</span>
<span class="e">	end</span>
<span class="e">	gem = Garnet.new("pretty")</span>
<span class="e">	EOF</span>
<span class="e">	endfunction</span>

To see what version of <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> you have: 
<span class="e">	:ruby print RUBY_VERSION</span>


						<span id="%3Arubydo" class="t">:rubydo</span> <span id="%3Arubyd" class="t">:rubyd</span> <span id="E265" class="t">E265</span>
:[range]rubyd[o] <span class="s">{cmd}</span>	Evaluate <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> command <span class="s">{cmd}</span> <a href="luaref.txt.html#for" class="d">for</a> each line in the
			<a href="cmdline.txt.html#%5Brange%5D" class="s">[range]</a>, with $_ being set to the text of each line in
			turn, without <a href="insert.txt.html#a" class="d">a</a> trailing <a href="intro.txt.html#%3CEOL%3E" class="s">&lt;EOL&gt;</a>.  Setting $_ will change
			the text, but <span class="n">note</span> that <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> not possible to add or
			delete lines using this command.
			The default <a href="luaref.txt.html#for" class="d">for</a> <a href="cmdline.txt.html#%5Brange%5D" class="s">[range]</a> <a href="motion.txt.html#is" class="d">is</a> the whole file: "1,$"<a href="repeat.txt.html#." class="d">.</a>

							<span id="%3Arubyfile" class="t">:rubyfile</span> <span id="%3Arubyf" class="t">:rubyf</span>
:rubyf[ile] <a href="editing.txt.html#%7Bfile%7D" class="s">{file}</a>	Execute the <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> <a href="usr_41.txt.html#script" class="d">script</a> in <a href="editing.txt.html#%7Bfile%7D" class="s">{file}</a>.  This <a href="motion.txt.html#is" class="d">is</a> the same <a href="motion.txt.html#as" class="d">as</a>
			`:ruby load <span class="o">'file'</span>`, but allows file name completion.

Executing <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> commands <a href="motion.txt.html#is" class="d">is</a> not possible in the <a href="vimeval.txt.html#sandbox" class="l">sandbox</a><a href="repeat.txt.html#." class="d">.</a>

<span class="h">==============================================================================</span>
2. The VIM module					<span id="ruby-vim" class="t">ruby-vim</span>

<a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> code gets all of its access to vim via the "VIM" module.

Overview 
<span class="e">	print "Hello"			      # displays a message</span>
<span class="e">	VIM.command(cmd)		      # execute an Ex command</span>
<span class="e">	num = VIM::Window.count		      # gets the number of windows</span>
<span class="e">	w = VIM::Window[n]		      # gets window "n"</span>
<span class="e">	cw = VIM::Window.current	      # gets the current window</span>
<span class="e">	num = VIM::Buffer.count		      # gets the number of buffers</span>
<span class="e">	b = VIM::Buffer[n]		      # gets buffer "n"</span>
<span class="e">	cb = VIM::Buffer.current	      # gets the current buffer</span>
<span class="e">	w.height = lines		      # sets the window height</span>
<span class="e">	w.cursor = [row, col]		      # sets the window cursor position</span>
<span class="e">	pos = w.cursor			      # gets an array [row, col]</span>
<span class="e">	name = b.name			      # gets the buffer file name</span>
<span class="e">	line = b[n]			      # gets a line from the buffer</span>
<span class="e">	num = b.count			      # gets the number of lines</span>
<span class="e">	b[n] = str			      # sets a line in the buffer</span>
<span class="e">	b.delete(n)			      # deletes a line</span>
<span class="e">	b.append(n, str)		      # appends a line after n</span>
<span class="e">	line = VIM::Buffer.current.line       # gets the current line</span>
<span class="e">	num = VIM::Buffer.current.line_number # gets the current line number</span>
<span class="e">	VIM::Buffer.current.line = "test"     # sets the current line number</span>


Module Functions:

							<span id="ruby-message" class="t">ruby-message</span>
VIM::message({msg})
	Displays the message <span class="s">{msg}</span>.

							<span id="ruby-set_option" class="t">ruby-set_option</span>
VIM::set_option({arg})
	Sets <a href="insert.txt.html#a" class="d">a</a> vim option.  <span class="s">{arg}</span> can be any argument that the "<a href="options.txt.html#%3Aset" class="d">:set</a>" command
	accepts.  <span class="n">Note</span> that this means that no spaces are allowed in the
	argument!  See <a href="options.txt.html#%3Aset" class="l">:set</a><a href="repeat.txt.html#." class="d">.</a>

							<span id="ruby-command" class="t">ruby-command</span>
VIM::command({cmd})
	Executes <a href="intro.txt.html#Ex" class="d">Ex</a> command <span class="s">{cmd}</span>.

							<span id="ruby-evaluate" class="t">ruby-evaluate</span>
VIM::evaluate({expr})
	Evaluates <span class="s">{expr}</span> using the vim internal <a href="vimeval.txt.html#expression" class="d">expression</a> evaluator (see
	<a href="vimeval.txt.html#expression" class="l">expression</a>).  Returns the <a href="vimeval.txt.html#expression" class="d">expression</a> result <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> string.
	<a href="insert.txt.html#A" class="d">A</a> <a href="vimeval.txt.html#List" class="l">List</a> <a href="motion.txt.html#is" class="d">is</a> turned into <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> by joining the items and <a href="insert.txt.html#inserting" class="d">inserting</a>
	line breaks.

<span class="h">==============================================================================</span>
3. VIM::Buffer <a href="index.txt.html#objects" class="d">objects</a>					<span id="ruby-buffer" class="t">ruby-buffer</span>

VIM::Buffer <a href="index.txt.html#objects" class="d">objects</a> represent vim buffers.

Class Methods:

current		Returns the current buffer object.
<a href="intro.txt.html#count" class="d">count</a>		Returns the number of buffers.
self[{n}]	Returns the buffer object <a href="luaref.txt.html#for" class="d">for</a> the number <span class="s">{n}</span>.  The first number
		<a href="motion.txt.html#is" class="d">is</a> 0.

Methods:

name		Returns the full name of the buffer.
number		Returns the number of the buffer.
<a href="intro.txt.html#count" class="d">count</a>		Returns the number of lines.
length		Returns the number of lines.
self[{n}]	Returns <a href="insert.txt.html#a" class="d">a</a> line from the buffer. <span class="s">{n}</span> <a href="motion.txt.html#is" class="d">is</a> the line number.
self[{n}] <a href="change.txt.html#%3D" class="d">=</a> <span class="s">{str}</span>
		Sets <a href="insert.txt.html#a" class="d">a</a> line in the buffer. <span class="s">{n}</span> <a href="motion.txt.html#is" class="d">is</a> the line number.
delete({n})	Deletes <a href="insert.txt.html#a" class="d">a</a> line from the buffer. <span class="s">{n}</span> <a href="motion.txt.html#is" class="d">is</a> the line number.
append({n}, <span class="s">{str}</span>)
		Appends <a href="insert.txt.html#a" class="d">a</a> line after the line <span class="s">{n}</span>.
line		Returns the current line of the buffer if the buffer <a href="motion.txt.html#is" class="d">is</a>
		active.
line <a href="change.txt.html#%3D" class="d">=</a> <span class="s">{str}</span>    Sets the current line of the buffer if the buffer <a href="motion.txt.html#is" class="d">is</a> active.
line_number     Returns the number of the current line if the buffer <a href="motion.txt.html#is" class="d">is</a>
		active.

<span class="h">==============================================================================</span>
4. VIM::Window <a href="index.txt.html#objects" class="d">objects</a>					<span id="ruby-window" class="t">ruby-window</span>

VIM::Window <a href="index.txt.html#objects" class="d">objects</a> represent vim windows.

Class Methods:

current		Returns the current <a href="windows.txt.html#window" class="d">window</a> object.
<a href="intro.txt.html#count" class="d">count</a>		Returns the number of windows.
self[{n}]	Returns the <a href="windows.txt.html#window" class="d">window</a> object <a href="luaref.txt.html#for" class="d">for</a> the number <span class="s">{n}</span>.  The first number
		<a href="motion.txt.html#is" class="d">is</a> 0.

Methods:

buffer		Returns the buffer displayed in the window.
height		Returns the height of the window.
height <a href="change.txt.html#%3D" class="d">=</a> <span class="s">{n}</span>	Sets the <a href="windows.txt.html#window" class="d">window</a> height to <span class="s">{n}</span>.
width		Returns the width of the window.
width <a href="change.txt.html#%3D" class="d">=</a> <span class="s">{n}</span>	Sets the <a href="windows.txt.html#window" class="d">window</a> width to <span class="s">{n}</span>.
cursor		Returns <a href="insert.txt.html#a" class="d">a</a> [row, col] array <a href="luaref.txt.html#for" class="d">for</a> the cursor position.
		First line number <a href="motion.txt.html#is" class="d">is</a> 1 and first column number <a href="motion.txt.html#is" class="d">is</a> 0.
cursor <a href="change.txt.html#%3D" class="d">=</a> [{row}, <span class="s">{col}</span>]
		Sets the cursor position to <span class="s">{row}</span> and <span class="s">{col}</span>.

<span class="h">==============================================================================</span>
5. Global <a href="vimeval.txt.html#variables" class="d">variables</a>					<span id="ruby-globals" class="t">ruby-globals</span>

There are two global variables.

$curwin		The current <a href="windows.txt.html#window" class="d">window</a> object.
$curbuf		The current buffer object.

<span class="h">==============================================================================</span>
6. <a href="vimfn.txt.html#rubyeval%28%29" class="d">rubyeval()</a> Vim function				<span id="ruby-rubyeval" class="t">ruby-rubyeval</span>

To facilitate bi-directional interface, you can use <a href="vimfn.txt.html#rubyeval%28%29" class="l">rubyeval()</a> function to
evaluate <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> expressions and pass their values to Vim script.

The <a href="if_ruby.txt.html#Ruby" class="d">Ruby</a> value "true"<a href="motion.txt.html#%2C" class="d">,</a> "false" and "nil" are converted to v:true, <a href="vvars.txt.html#v%3Afalse" class="d">v:false</a> and
v:null, respectively.

<span class="h">==============================================================================</span>
 vim:tw=78:ts=8:noet:ft=help:norl:


</pre>
</div>
</main>
<p>Quick links:
<a href="index.html">help overview</a> &middot;
<a href="quickref.txt.html">quick reference</a> &middot;
<a href="usr_toc.txt.html">user manual toc</a> &middot;
<a href="index.html#reference_toc">reference manual toc</a>
</p>
<footer>This site is maintained by Carlo Teubner (<i>(my first name) at cteubner dot net</i>).</footer>
</body>
</html>