<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="color-scheme" content="light dark">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Neovim help pages, always up-to-date">
<title>Neovim: luaref.txt</title>
<link rel="shortcut icon" href="s/h3E0J2MHNKfIuCqP/favicon-neovim.ico">
<!-- favicon taken from https://neovim.io/favicon.ico, which is licensed under CC-BY-3.0: https://creativecommons.org/licenses/by/3.0/ -->

<link rel="stylesheet" href="s/MsMIu46igYudff1x/tom-select.min.css">
<script defer src="s/RLcAbtLBYX-q5me0/tom-select.base.min.js"></script>

<link rel="stylesheet" href="s/QRMkrs52-wJfIQ-w/vimhelp.css">
<noscript><link rel="stylesheet" href="s/eRFCn9A-K4lmzV_A/noscript.css"></noscript>
<script defer src="s/KpwrKyx19dtnhPoe/vimhelp.js"></script>
</head>
<body>




<div class="bar">
  <div class="ql">Quick links:
<a href="index.html">help overview</a> &middot;
<a href="quickref.txt.html">quick reference</a> &middot;
<a href="usr_toc.txt.html">user manual toc</a> &middot;
<a href="index.html#reference_toc">reference manual toc</a>
</div>
  <div class="tag srch need-js">
    <select id="vh-select-tag"></select>
    <div class="placeholder">Go to keyword<span class="not-mobile">&nbsp;(shortcut: <kbd>k</kbd>)</span></div>
  </div>
  <form class="site srch" action="https://duckduckgo.com" method="get" target="_blank" rel="noopener noreferrer">
    <input type="hidden" name="sites" value="neo.vimhelp.org">
    <input type="search" name="q" id="vh-srch-input" placeholder="Site search">
    <div class="placeholder need-js">Site search<span class="not-mobile">&nbsp;(shortcut: <kbd>s</kbd>)</span></div>
  </form>
  <div id="theme-switcher" class="need-js">
  <button id="theme-current" title="Switch theme">Theme</button>
  <div id="theme-dropdown"><ul>
    <li><button id="theme-native" title="Switch to native theme">Native</button></li>
    <li><button id="theme-light" title="Switch to light theme">Light</button></li>
    <li><button id="theme-dark" title="Switch to dark theme">Dark</button></li>
  </ul></div>
</div>

</div>

<main>
<div id="vh-sidebar">
<ul><li><a href="luaref.txt.html#">↑Top↑</a></li>
<li><a href="luaref.txt.html#luaref-intro">INTRODUCTION</a></li>
<li><a href="luaref.txt.html#lua-language">THE LANGUAGE</a></li>
<li><a href="luaref.txt.html#lua-lexical">Lexical Conventions</a></li>
<li><a href="luaref.txt.html#lua-values">Values and Types</a></li>
<li><a href="luaref.txt.html#lua-variables">Variables</a></li>
<li><a href="luaref.txt.html#lua-statement">Statements</a></li>
<li><a href="luaref.txt.html#lua-expressions">Expressions</a></li>
<li><a href="luaref.txt.html#lua-visibility">Visibility Rules</a></li>
<li><a href="luaref.txt.html#lua-errors">Error Handling</a></li>
<li><a href="luaref.txt.html#metatable">Metatables</a></li>
<li><a href="luaref.txt.html#lua-environments">Environments</a></li>
<li><a href="luaref.txt.html#lua-gc">Garbage Collection</a></li>
<li><a href="luaref.txt.html#lua-coroutine">Coroutines</a></li>
<li><a href="luaref.txt.html#lua-API">THE APPLICATION PROGRAM INTERFACE</a></li>
<li><a href="luaref.txt.html#lua-stack">The Stack</a></li>
<li><a href="luaref.txt.html#lua-apiStackSize">Stack Size</a></li>
<li><a href="luaref.txt.html#lua-pseudoindex">Pseudo-Indices</a></li>
<li><a href="luaref.txt.html#lua-cclosure">C Closures</a></li>
<li><a href="luaref.txt.html#lua-registry">Registry</a></li>
<li><a href="luaref.txt.html#lua-apiError">Error Handling in C</a></li>
<li><a href="luaref.txt.html#lua-apiFunctions">Functions and Types</a></li>
<li><a href="luaref.txt.html#lua-apiDebug">The Debug Interface</a></li>
<li><a href="luaref.txt.html#lua-aux">THE AUXILIARY LIBRARY</a></li>
<li><a href="luaref.txt.html#lua-auxFunctions">Functions and Types</a></li>
<li><a href="luaref.txt.html#lua-lib">STANDARD LIBRARIES</a></li>
<li><a href="luaref.txt.html#lua-lib-core">Basic Functions</a></li>
<li><a href="luaref.txt.html#lua-lib-coroutine">Coroutine Manipulation</a></li>
<li><a href="luaref.txt.html#lua-modules">Modules</a></li>
<li><a href="luaref.txt.html#lua-lib-string">String Manipulation</a></li>
<li><a href="luaref.txt.html#lua-lib-table">Table Manipulation</a></li>
<li><a href="luaref.txt.html#lua-lib-math">Mathematical Functions</a></li>
<li><a href="luaref.txt.html#lua-lib-io">Input and Output Facilities</a></li>
<li><a href="luaref.txt.html#lua-lib-os">Operating System Facilities</a></li>
<li><a href="luaref.txt.html#lua-lib-debug">The Debug Library</a></li>
</ul>
</div>
<div id="vh-content">
<pre>
<span id="luaref.txt" class="t">luaref.txt</span>           Nvim
                                                                <span id="luaref" class="t">luaref</span>

                             LUA REFERENCE MANUAL


                                 Version 0.3.0
                                August 7th, 2022


                    Vimdoc version (c) 2006 by Luis Carvalho
                         &lt;lexcarvalho <a href="motion.txt.html#at" class="d">at</a> gmail dot com&gt;

                    Adapted from "Lua: 5.1 <a href="intro.txt.html#reference" class="d">reference</a> manual"
                 R. Ierusalimschy, L. H. de Figueiredo, W. Celes
                      Copyright (c) 2006 Lua.org, PUC-Rio.


                 See <a href="luaref.txt.html#lua-ref-doc" class="l">lua-ref-doc</a> <a href="luaref.txt.html#for" class="d">for</a> information on this manual.
                 See <a href="luaref.txt.html#lua-ref-copyright" class="l">lua-ref-copyright</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="uganda.txt.html#copyright" class="d">copyright</a> and licenses.


Type <a href="various.txt.html#gO" class="l">gO</a> to see the table of contents.

<span class="h">==============================================================================</span>
1  INTRODUCTION                                                 <span id="luaref-intro" class="t">luaref-intro</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> an extension programming language designed to <a href="support.txt.html#support" class="d">support</a> general
procedural programming with data description facilities.  It also offers good
<a href="support.txt.html#support" class="d">support</a> <a href="luaref.txt.html#for" class="d">for</a> object-oriented programming, functional programming, and
data-driven programming.  <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> intended to be used <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> powerful,
light-weight scripting language <a href="luaref.txt.html#for" class="d">for</a> any program that needs one.  <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a>
implemented <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> library, written in clean <a href="change.txt.html#C" class="d">C</a> (that is, in the common subset of
ANSI <a href="change.txt.html#C" class="d">C</a> and C++).

Being an extension language, <a href="lua.txt.html#Lua" class="d">Lua</a> has no notion of <a href="insert.txt.html#a" class="d">a</a> "main" program: <a href="motion.txt.html#it" class="d">it</a> only
works embedded in <a href="insert.txt.html#a" class="d">a</a> host client, called the embedding program or simply the
host. This host program can invoke <a href="vimeval.txt.html#functions" class="d">functions</a> to execute <a href="insert.txt.html#a" class="d">a</a> piece of <a href="lua.txt.html#Lua" class="d">Lua</a> code,
can write and read <a href="lua.txt.html#Lua" class="d">Lua</a> variables, and can <a href="intro.txt.html#register" class="d">register</a> <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#functions" class="d">functions</a> to be called by
<a href="lua.txt.html#Lua" class="d">Lua</a> code.  Through the use of <a href="change.txt.html#C" class="d">C</a> functions, <a href="lua.txt.html#Lua" class="d">Lua</a> can be augmented to cope with <a href="insert.txt.html#a" class="d">a</a>
wide range of different domains, thus creating customized programming
languages sharing <a href="insert.txt.html#a" class="d">a</a> syntactical framework.

<a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> free software, and <a href="motion.txt.html#is" class="d">is</a> provided <a href="motion.txt.html#as" class="d">as</a> usual with no guarantees, <a href="motion.txt.html#as" class="d">as</a> stated
in its license. The implementation described in this manual <a href="motion.txt.html#is" class="d">is</a> available <a href="motion.txt.html#at" class="d">at</a>
Lua's official web site, www.lua.org.

Like any other <a href="intro.txt.html#reference" class="d">reference</a> manual, this document <a href="motion.txt.html#is" class="d">is</a> dry in places. For <a href="insert.txt.html#a" class="d">a</a>
discussion of the decisions behind the design of Lua, see references <a href="motion.txt.html#at" class="d">at</a>
<a href="luaref.txt.html#lua-ref-bibliography" class="l">lua-ref-bibliography</a><a href="repeat.txt.html#." class="d">.</a> For <a href="insert.txt.html#a" class="d">a</a> detailed introduction to programming in Lua, see
Roberto's book, Programming in Lua.

<a href="lua.txt.html#Lua" class="d">Lua</a> means "moon" in Portuguese and <a href="motion.txt.html#is" class="d">is</a> pronounced LOO-ah.

<span class="h">==============================================================================</span>
2  THE LANGUAGE                                         <span id="lua-language" class="t">lua-language</span>

This <a href="motion.txt.html#section" class="d">section</a> describes the lexis, the syntax, and the semantics of Lua. In
other words, this <a href="motion.txt.html#section" class="d">section</a> describes which tokens are valid, how they can be
combined, and what their combinations mean.

The language constructs will be explained using the usual extended BNF
notation, in which <a href="motion.txt.html#%60%7B" class="d">`{</a> <a href="insert.txt.html#a" class="d">a</a> }` means <a href="motion.txt.html#0" class="d">0</a> or more <span class="e">a</span>'s, and <a href="motion.txt.html#%60%5B" class="d">`[</a> <a href="insert.txt.html#a" class="d">a</a> <a href="motion.txt.html#%5D%60" class="d">]`</a> means an optional <span class="e">a</span>.

<span class="h">==============================================================================</span>
2.1  Lexical Conventions                                <span id="lua-lexical" class="t">lua-lexical</span>

                                               <span id="lua-names" class="t">lua-names</span> <span id="lua-identifiers" class="t">lua-identifiers</span>
Names (also called identifiers) in <a href="lua.txt.html#Lua" class="d">Lua</a> can be any <a href="vimeval.txt.html#string" class="d">string</a> of letters, digits,
and underscores, not beginning with <a href="insert.txt.html#a" class="d">a</a> digit. This coincides with the
definition of identifiers in most languages. (The definition of letter depends
on the current locale: any character considered alphabetic by the current
<a href="mbyte.txt.html#locale" class="d">locale</a> can be used in an identifier.) Identifiers are used to name <a href="vimeval.txt.html#variables" class="d">variables</a>
and table fields.

The following keywords are reserved and cannot be used <a href="motion.txt.html#as" class="d">as</a> names:

<span class="e">       and       break     do        else      elseif</span>
<span class="e">       end       false     for       function  if</span>
<span class="e">       in        local     nil       not       or</span>
<span class="e">       repeat    return    then      true      until     while</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> case-sensitive language: <span class="e">and</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> reserved word, but <span class="e">And</span> and <span class="e">AND</span> are
two different, valid names. As <a href="insert.txt.html#a" class="d">a</a> convention, names <a href="starting.txt.html#starting" class="d">starting</a> with an underscore
followed by <a href="change.txt.html#uppercase" class="d">uppercase</a> letters (such <a href="motion.txt.html#as" class="d">as</a> <span class="e">_VERSION</span>) are reserved <a href="luaref.txt.html#for" class="d">for</a> internal
global <a href="vimeval.txt.html#variables" class="d">variables</a> used by Lua.

The following strings denote other tokens:

<span class="e">       +     -     *     /     %     ^     #</span>
<span class="e">       ==    ~=    &lt;=    &gt;=    &lt;     &gt;     =</span>
<span class="e">       (     )     {     }     [     ]</span>
<span class="e">       ;     :     ,     .     ..    ...</span>

                                                                <span id="lua-literal" class="t">lua-literal</span>
Literal strings can be delimited by matching single or double quotes, and can
contain the following C-like <a href="intro.txt.html#escape" class="d">escape</a> sequences:

    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\a</span>  bell
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\b</span>  <a href="intro.txt.html#backspace" class="d">backspace</a>
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\f</span>  form feed
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\n</span>  newline
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\r</span>  carriage return
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\t</span>  horizontal <a href="intro.txt.html#tab" class="d">tab</a>
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\v</span>  vertical <a href="intro.txt.html#tab" class="d">tab</a>
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\\</span>  <a href="intro.txt.html#backslash" class="d">backslash</a>
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\"</span>  quotation <a href="motion.txt.html#mark" class="d">mark</a> (double quote)
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">\'</span>  apostrophe (single quote)

Moreover, <a href="insert.txt.html#a" class="d">a</a> <a href="intro.txt.html#backslash" class="d">backslash</a> followed by <a href="insert.txt.html#a" class="d">a</a> real newline results in <a href="insert.txt.html#a" class="d">a</a> newline in the
string. <a href="insert.txt.html#A" class="d">A</a> character in <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> may also be specified by its numerical value
using the <a href="intro.txt.html#escape" class="d">escape</a> sequence <span class="e">\ddd</span>, where <span class="e">ddd</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> sequence of up to three
decimal digits. (Note that if <a href="insert.txt.html#a" class="d">a</a> numerical <a href="intro.txt.html#escape" class="d">escape</a> <a href="motion.txt.html#is" class="d">is</a> to be followed by <a href="insert.txt.html#a" class="d">a</a> digit,
<a href="motion.txt.html#it" class="d">it</a> must be expressed using exactly three digits.) Strings in <a href="lua.txt.html#Lua" class="d">Lua</a> may contain
any 8-bit value, including embedded zeros, which can be specified <a href="motion.txt.html#as" class="d">as</a> <span class="e">\0</span>.

To <a href="change.txt.html#put" class="d">put</a> <a href="insert.txt.html#a" class="d">a</a> double (single) quote, <a href="insert.txt.html#a" class="d">a</a> newline, <a href="insert.txt.html#a" class="d">a</a> backslash, or an embedded zero
inside <a href="insert.txt.html#a" class="d">a</a> literal <a href="vimeval.txt.html#string" class="d">string</a> enclosed by double (single) quotes you must use an
<a href="intro.txt.html#escape" class="d">escape</a> sequence. Any other character may be directly inserted into the
literal. (Some <a href="intro.txt.html#control" class="d">control</a> characters may cause problems <a href="luaref.txt.html#for" class="d">for</a> the file system, but
<a href="lua.txt.html#Lua" class="d">Lua</a> has no problem with them.)

Literal strings can also be defined using <a href="insert.txt.html#a" class="d">a</a> long format enclosed by long
brackets. We define an opening long bracket of level <a href="pattern.txt.html#n" class="d">n</a> <a href="motion.txt.html#as" class="d">as</a> an opening square
bracket followed by <a href="pattern.txt.html#n" class="d">n</a> equal <a href="sign.txt.html#signs" class="d">signs</a> followed by another opening square bracket.
So, an opening long bracket of level <a href="motion.txt.html#0" class="d">0</a> <a href="motion.txt.html#is" class="d">is</a> written <a href="motion.txt.html#as" class="d">as</a> <span class="e">[[</span>, an opening long
bracket of level 1 <a href="motion.txt.html#is" class="d">is</a> written <a href="motion.txt.html#as" class="d">as</a> <span class="e">[=[</span>, and so on.
<a href="insert.txt.html#A" class="d">A</a> closing long bracket <a href="motion.txt.html#is" class="d">is</a> defined similarly; <a href="luaref.txt.html#for" class="d">for</a> instance, <a href="insert.txt.html#a" class="d">a</a> closing long
bracket of level 4 <a href="motion.txt.html#is" class="d">is</a> written <a href="motion.txt.html#as" class="d">as</a> <span class="e">]====]</span>. <a href="insert.txt.html#A" class="d">A</a> long <a href="vimeval.txt.html#string" class="d">string</a> starts with an
opening long bracket of any level and ends <a href="motion.txt.html#at" class="d">at</a> the first closing long bracket
of the same level. Literals in this bracketed form may run <a href="luaref.txt.html#for" class="d">for</a> several lines,
<a href="diff.txt.html#do" class="d">do</a> not interpret any <a href="intro.txt.html#escape" class="d">escape</a> sequences, and ignore long brackets of any other
level. They may contain anything except <a href="insert.txt.html#a" class="d">a</a> closing bracket of the proper level.

For convenience, when the opening long bracket <a href="motion.txt.html#is" class="d">is</a> immediately followed by <a href="insert.txt.html#a" class="d">a</a>
newline, the newline <a href="motion.txt.html#is" class="d">is</a> not included in the string. As an example, in <a href="insert.txt.html#a" class="d">a</a> system
using ASCII (in which <span class="e">a</span> <a href="motion.txt.html#is" class="d">is</a> coded <a href="motion.txt.html#as" class="d">as</a> 97, newline <a href="motion.txt.html#is" class="d">is</a> coded <a href="motion.txt.html#as" class="d">as</a> 10, and <span class="e">1</span> <a href="motion.txt.html#is" class="d">is</a>
coded <a href="motion.txt.html#as" class="d">as</a> 49), the five literals below denote the same string:

<span class="e">       a = 'alo\n123"'</span>
<span class="e">       a = "alo\n123\""</span>
<span class="e">       a = '\97lo\10\04923"'</span>
<span class="e">       a = [[alo</span>
<span class="e">       123"]]</span>
<span class="e">       a = [==[</span>
<span class="e">       alo</span>
<span class="e">       123"]==]</span>

                                                            <span id="lua-numconstant" class="t">lua-numconstant</span>
<a href="insert.txt.html#A" class="d">A</a> numerical constant may be written with an optional decimal part and an
optional decimal exponent. <a href="lua.txt.html#Lua" class="d">Lua</a> also accepts integer hexadecimal constants, by
prefixing them with <span class="e">0x</span>. Examples of valid numerical constants are

<span class="e">     3     3.0     3.1416  314.16e-2   0.31416E1   0xff   0x56</span>

                                                                <span id="lua-comment" class="t">lua-comment</span>
<a href="insert.txt.html#A" class="d">A</a> comment starts with <a href="insert.txt.html#a" class="d">a</a> double hyphen (`--`) anywhere outside <a href="insert.txt.html#a" class="d">a</a> string. If the
text immediately after <span class="e">--</span> <a href="motion.txt.html#is" class="d">is</a> not an opening long bracket, the comment <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a>
short comment, which runs until the <a href="intro.txt.html#end" class="d">end</a> of the line. Otherwise, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> long
comment, which runs until the corresponding closing long bracket. Long
comments are frequently used to disable code temporarily.

<span class="h">==============================================================================</span>
2.2  Values and Types                           <span id="lua-values" class="t">lua-values</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> dynamically typed language. This means that <a href="vimeval.txt.html#variables" class="d">variables</a> <a href="diff.txt.html#do" class="d">do</a> not have
types; only values do. There are no type <a href="intro.txt.html#definitions" class="d">definitions</a> in the language. All
values carry their own type.

All values in <a href="lua.txt.html#Lua" class="d">Lua</a> are first-class values. This means that all values can be
stored in variables, passed <a href="motion.txt.html#as" class="d">as</a> arguments to other functions, and returned <a href="motion.txt.html#as" class="d">as</a>
results.

                                                <span id="lua-types" class="t">lua-types</span> <span id="lua-nil" class="t">lua-nil</span>
                                                <span id="lua-true" class="t">lua-true</span> <span id="lua-false" class="t">lua-false</span>
                                                <span id="lua-number" class="t">lua-number</span> <span id="lua-string" class="t">lua-string</span>
There are eight basic types in Lua: <span class="e">nil</span>, <span class="e">boolean</span>, <span class="e">number</span>, <span class="e">string</span>,
<span class="e">function</span>, <span class="e">userdata</span>, <span class="e">thread</span>, and <span class="e">table</span>. Nil <a href="motion.txt.html#is" class="d">is</a> the type of the value
<span class="e">nil</span>, whose main property <a href="motion.txt.html#is" class="d">is</a> to be different from any other value; <a href="motion.txt.html#it" class="d">it</a> usually
represents the absence of <a href="insert.txt.html#a" class="d">a</a> useful value. <a href="vimeval.txt.html#Boolean" class="d">Boolean</a> <a href="motion.txt.html#is" class="d">is</a> the type of the values
<span class="e">false</span> and <span class="e">true</span>. Both <span class="e">nil</span> and <span class="e">false</span> make <a href="insert.txt.html#a" class="d">a</a> condition false; any other
value makes <a href="motion.txt.html#it" class="d">it</a> true. <a href="vimeval.txt.html#Number" class="d">Number</a> represents real (double-precision floating-point)
numbers. (It <a href="motion.txt.html#is" class="d">is</a> easy to build <a href="lua.txt.html#Lua" class="d">Lua</a> interpreters that use other internal
representations <a href="luaref.txt.html#for" class="d">for</a> numbers, such <a href="motion.txt.html#as" class="d">as</a> single-precision float or long integers;
see file <span class="e">luaconf.h</span>.) <a href="vimeval.txt.html#String" class="d">String</a> represents arrays of characters. <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> 8-bit
clean: strings may contain any 8-bit character, including embedded zeros
(`\0`) (see <a href="luaref.txt.html#lua-literal" class="l">lua-literal</a>).

<a href="lua.txt.html#Lua" class="d">Lua</a> can call (and manipulate) <a href="vimeval.txt.html#functions" class="d">functions</a> written in <a href="lua.txt.html#Lua" class="d">Lua</a> and <a href="vimeval.txt.html#functions" class="d">functions</a> written
in <a href="change.txt.html#C" class="d">C</a> (see <a href="luaref.txt.html#lua-function" class="l">lua-function</a>).

                                                            <span id="lua-userdatatype" class="t">lua-userdatatype</span>
The type <a href="luaref.txt.html#userdata" class="d">userdata</a> <a href="motion.txt.html#is" class="d">is</a> provided to allow arbitrary <a href="change.txt.html#C" class="d">C</a> data to be stored in <a href="lua.txt.html#Lua" class="d">Lua</a>
variables. This type corresponds to <a href="insert.txt.html#a" class="d">a</a> block of raw memory and has no
pre-defined operations in Lua, except assignment and identity test. However,
by using metatables, the programmer can define operations <a href="luaref.txt.html#for" class="d">for</a> <a href="luaref.txt.html#userdata" class="d">userdata</a> values
(see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>). Userdata values cannot be created or modified in Lua,
only through the <a href="change.txt.html#C" class="d">C</a> API. This guarantees the integrity of data owned by the
host program.

                                                                 <span id="lua-thread" class="t">lua-thread</span>
The type <span class="e">thread</span> represents independent threads of execution and <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> used to
implement coroutines (see <a href="luaref.txt.html#lua-coroutine" class="l">lua-coroutine</a>). Do not confuse <a href="lua.txt.html#Lua" class="d">Lua</a> threads with
operating-system threads. <a href="lua.txt.html#Lua" class="d">Lua</a> supports coroutines on all systems, even those
that <a href="diff.txt.html#do" class="d">do</a> not <a href="support.txt.html#support" class="d">support</a> threads.

                                                                  <span id="lua-table" class="t">lua-table</span>
The type <span class="e">table</span> implements associative arrays, that is, arrays that can be
indexed not only with numbers, but with any value (except <span class="e">nil</span>). Tables can
be heterogeneous; that is, they can contain values of all types (except
<span class="e">nil</span>). Tables are the sole data structuring mechanism in Lua; they may be
used to represent ordinary arrays, symbol tables, sets, records, graphs,
trees, etc. To represent records, <a href="lua.txt.html#Lua" class="d">Lua</a> uses the field name <a href="motion.txt.html#as" class="d">as</a> an index. The
language supports this representation by providing <span class="e">a.name</span> <a href="motion.txt.html#as" class="d">as</a> syntactic sugar
<a href="luaref.txt.html#for" class="d">for</a> <span class="e">a["name"]</span>. There are several convenient ways to create tables in <a href="lua.txt.html#Lua" class="d">Lua</a>
(see <a href="luaref.txt.html#lua-tableconstructor" class="l">lua-tableconstructor</a>).

Like indices, the value of <a href="insert.txt.html#a" class="d">a</a> table field can be of any type (except <span class="e">nil</span>). In
particular, because <a href="vimeval.txt.html#functions" class="d">functions</a> are first-class values, table fields may contain
functions. Thus tables may also carry methods (see <a href="luaref.txt.html#lua-function-define" class="l">lua-function-define</a>).

Tables, functions, threads and (full) <a href="luaref.txt.html#userdata" class="d">userdata</a> values are objects: <a href="vimeval.txt.html#variables" class="d">variables</a>
<a href="diff.txt.html#do" class="d">do</a> not actually contain these values, only references to them. Assignment,
parameter passing, and function returns always manipulate references to such
values; these operations <a href="diff.txt.html#do" class="d">do</a> not imply any kind of copy.

The library function <span class="e">type</span> returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> describing the type of <a href="insert.txt.html#a" class="d">a</a> given
value (see <a href="luaref.txt.html#lua-type%28%29" class="l">lua-type()</a>).

<span class="h">------------------------------------------------------------------------------</span>
2.2.1  Coercion                                            <span id="lua-coercion" class="t">lua-coercion</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> provides automatic conversion between <a href="vimeval.txt.html#string" class="d">string</a> and number values <a href="motion.txt.html#at" class="d">at</a> run
time. Any arithmetic operation applied to <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> tries to convert that
<a href="vimeval.txt.html#string" class="d">string</a> to <a href="insert.txt.html#a" class="d">a</a> number, following the usual conversion rules. Conversely, whenever
<a href="insert.txt.html#a" class="d">a</a> number <a href="motion.txt.html#is" class="d">is</a> used where <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> <a href="motion.txt.html#is" class="d">is</a> expected, the number <a href="motion.txt.html#is" class="d">is</a> converted to <a href="insert.txt.html#a" class="d">a</a>
string, in <a href="insert.txt.html#a" class="d">a</a> reasonable format. For complete <a href="intro.txt.html#control" class="d">control</a> of how numbers are
converted to strings, use the <span class="e">format</span> function from the <a href="vimeval.txt.html#string" class="d">string</a> library (see
<a href="luaref.txt.html#string.format%28%29" class="l">string.format()</a>).

<span class="h">==============================================================================</span>
2.3  Variables                                            <span id="lua-variables" class="t">lua-variables</span>

Variables are places that store values. There are three kinds of <a href="vimeval.txt.html#variables" class="d">variables</a> in
Lua: global variables, local variables, and table fields.

<a href="insert.txt.html#A" class="d">A</a> single name can denote <a href="insert.txt.html#a" class="d">a</a> global variable or <a href="insert.txt.html#a" class="d">a</a> local variable (or <a href="insert.txt.html#a" class="d">a</a>
function's formal parameter, which <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> particular form of local variable):

<span class="e">       var ::= Name</span>

Name denotes identifiers, <a href="motion.txt.html#as" class="d">as</a> defined in <a href="luaref.txt.html#lua-lexical" class="l">lua-lexical</a><a href="repeat.txt.html#." class="d">.</a>

Any variable <a href="motion.txt.html#is" class="d">is</a> assumed to be global unless explicitly declared <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> local
(see <a href="luaref.txt.html#lua-local" class="l">lua-local</a>). Local <a href="vimeval.txt.html#variables" class="d">variables</a> are lexically scoped: local
<a href="vimeval.txt.html#variables" class="d">variables</a> can be freely accessed by <a href="vimeval.txt.html#functions" class="d">functions</a> defined inside their scope (see
<a href="luaref.txt.html#lua-visibility" class="l">lua-visibility</a>).

Before the first assignment to <a href="insert.txt.html#a" class="d">a</a> variable, its value <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>.

Square brackets are used to <a href="index.txt.html#index" class="d">index</a> <a href="insert.txt.html#a" class="d">a</a> table:

<span class="e">       var ::= prefixexp [ exp ]</span>

The first <a href="vimeval.txt.html#expression" class="d">expression</a> (`prefixexp`) should result in <a href="insert.txt.html#a" class="d">a</a> table value; the second
<a href="vimeval.txt.html#expression" class="d">expression</a> (`exp`) identifies <a href="insert.txt.html#a" class="d">a</a> specific entry inside that table. The
<a href="vimeval.txt.html#expression" class="d">expression</a> denoting the table to be indexed has <a href="insert.txt.html#a" class="d">a</a> restricted syntax; see
<a href="luaref.txt.html#lua-expressions" class="l">lua-expressions</a> <a href="luaref.txt.html#for" class="d">for</a> details.

The <a href="syntax.txt.html#syntax" class="d">syntax</a> <span class="e">var.NAME</span> <a href="motion.txt.html#is" class="d">is</a> just syntactic sugar <a href="luaref.txt.html#for" class="d">for</a> <span class="e">var["NAME"]</span> <a href="cmdline.txt.html#%3A" class="d">:</a>

<span class="e">       var ::= prefixexp . Name</span>

All global <a href="vimeval.txt.html#variables" class="d">variables</a> live <a href="motion.txt.html#as" class="d">as</a> fields in ordinary <a href="lua.txt.html#Lua" class="d">Lua</a> tables, called environment
tables or simply environments (see <a href="luaref.txt.html#lua-environments" class="l">lua-environments</a>). Each function
has its own <a href="intro.txt.html#reference" class="d">reference</a> to an environment, so that all global <a href="vimeval.txt.html#variables" class="d">variables</a> in this
function will refer to this environment table. When <a href="insert.txt.html#a" class="d">a</a> function <a href="motion.txt.html#is" class="d">is</a> created, <a href="motion.txt.html#it" class="d">it</a>
inherits the environment from the function that created it. To get the
environment table of <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function, you call <span class="e">getfenv</span> (see
<a href="luaref.txt.html#lua_getfenv%28%29" class="l">lua_getfenv()</a>). To replace it, you call <span class="e">setfenv</span> (see <a href="luaref.txt.html#setfenv%28%29" class="l">setfenv()</a>).
(You can only manipulate the environment of <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#functions" class="d">functions</a> through the debug
library; see <a href="luaref.txt.html#lua-lib-debug" class="l">lua-lib-debug</a>.)

An access to <a href="insert.txt.html#a" class="d">a</a> global variable <span class="e">x</span> <a href="motion.txt.html#is" class="d">is</a> equivalent to <span class="e">_env.x</span>, which in turn <a href="motion.txt.html#is" class="d">is</a>
equivalent to

<span class="e">       gettable_event(_env, "x")</span>

where <span class="e">_env</span> <a href="motion.txt.html#is" class="d">is</a> the environment of the running function. (The <span class="e">_env</span> variable <a href="motion.txt.html#is" class="d">is</a>
not defined in Lua. We use <a href="motion.txt.html#it" class="d">it</a> here only <a href="luaref.txt.html#for" class="d">for</a> explanatory purposes.)

The meaning of accesses to global <a href="vimeval.txt.html#variables" class="d">variables</a> and table fields can be changed
via metatables. An access to an indexed variable <span class="e">t[i]</span> <a href="motion.txt.html#is" class="d">is</a> equivalent to <a href="insert.txt.html#a" class="d">a</a>
call <span class="e">gettable_event(t,i)</span>. (See <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> complete description of
the <span class="e">gettable_event</span> function. This function <a href="motion.txt.html#is" class="d">is</a> not defined or callable in
Lua. We use <a href="motion.txt.html#it" class="d">it</a> here only <a href="luaref.txt.html#for" class="d">for</a> explanatory purposes.)

<span class="h">==============================================================================</span>
2.4  Statements                                 <span id="lua-statement" class="t">lua-statement</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> supports an almost conventional set of statements, similar to those in
Pascal or C. This set includes assignment, <a href="intro.txt.html#control" class="d">control</a> structures, function
calls, and variable declarations.

<span class="h">------------------------------------------------------------------------------</span>
2.4.1  Chunks                                   <span id="lua-chunk" class="t">lua-chunk</span>

The unit of execution of <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> called <a href="insert.txt.html#a" class="d">a</a> chunk. <a href="insert.txt.html#A" class="d">A</a> chunk <a href="motion.txt.html#is" class="d">is</a> simply <a href="insert.txt.html#a" class="d">a</a> sequence
of statements, which are executed sequentially. Each statement can be
optionally followed by <a href="insert.txt.html#a" class="d">a</a> semicolon:

<span class="e">       chunk ::= {stat [ ; ]}</span>

There are no empty statements and thus <span class="e">;;</span> <a href="motion.txt.html#is" class="d">is</a> not legal.

<a href="lua.txt.html#Lua" class="d">Lua</a> handles <a href="insert.txt.html#a" class="d">a</a> chunk <a href="motion.txt.html#as" class="d">as</a> the body of an anonymous function with <a href="insert.txt.html#a" class="d">a</a> variable
number of arguments (see <a href="luaref.txt.html#lua-function-define" class="l">lua-function-define</a>). As such, chunks can define
local variables, receive arguments, and return values.

<a href="insert.txt.html#A" class="d">A</a> chunk may be stored in <a href="insert.txt.html#a" class="d">a</a> file or in <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> inside the host program. When <a href="insert.txt.html#a" class="d">a</a>
chunk <a href="motion.txt.html#is" class="d">is</a> executed, first <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> pre-compiled into instructions <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> virtual
machine, and then the compiled code <a href="motion.txt.html#is" class="d">is</a> executed by an interpreter <a href="luaref.txt.html#for" class="d">for</a> the
virtual machine.

Chunks may also be pre-compiled into binary form; see program <span class="e">luac</span> <a href="luaref.txt.html#for" class="d">for</a>
details. Programs in source and compiled forms are interchangeable; <a href="lua.txt.html#Lua" class="d">Lua</a>
automatically detects the file type and acts accordingly.

<span class="h">------------------------------------------------------------------------------</span>
2.4.2  Blocks                                   <span id="lua-block" class="t">lua-block</span>

<a href="insert.txt.html#A" class="d">A</a> block <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#list" class="d">list</a> of statements; syntactically, <a href="insert.txt.html#a" class="d">a</a> block <a href="motion.txt.html#is" class="d">is</a> the same <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a>
chunk:

<span class="e">       block ::= chunk</span>

                                                <span id="lua-do" class="t">lua-do</span> <span id="lua-end" class="t">lua-end</span>
<a href="insert.txt.html#A" class="d">A</a> block may be explicitly delimited to produce <a href="insert.txt.html#a" class="d">a</a> single statement:

<span class="e">       stat ::= do block end</span>

Explicit blocks are useful to <a href="intro.txt.html#control" class="d">control</a> the scope of variable declarations.
Explicit blocks are also sometimes used to add <a href="insert.txt.html#a" class="d">a</a> <span class="e">return</span> or <span class="e">break</span> statement
in the middle of another block (see <a href="luaref.txt.html#lua-control" class="l">lua-control</a>).

<span class="h">------------------------------------------------------------------------------</span>
2.4.3  Assignment                               <span id="lua-assign" class="t">lua-assign</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> allows multiple assignment. Therefore, the <a href="syntax.txt.html#syntax" class="d">syntax</a> <a href="luaref.txt.html#for" class="d">for</a> assignment defines <a href="insert.txt.html#a" class="d">a</a>
<a href="vimeval.txt.html#list" class="d">list</a> of <a href="vimeval.txt.html#variables" class="d">variables</a> on the left side and <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#list" class="d">list</a> of expressions on the right
side. The elements in both lists are separated by commas:

<span class="e">       stat ::= varlist1 = explist1</span>
<span class="e">       varlist1 ::= var { , var }</span>
<span class="e">       explist1 ::= exp { , exp }</span>

Expressions are discussed in <a href="luaref.txt.html#lua-expressions" class="l">lua-expressions</a><a href="repeat.txt.html#." class="d">.</a>

Before the assignment, the <a href="vimeval.txt.html#list" class="d">list</a> of values <a href="motion.txt.html#is" class="d">is</a> adjusted to the length of the
<a href="vimeval.txt.html#list" class="d">list</a> of variables. If there are more values than needed, the excess values are
thrown away. If there are fewer values than needed, the <a href="vimeval.txt.html#list" class="d">list</a> <a href="motion.txt.html#is" class="d">is</a> extended with
<a href="motion.txt.html#as" class="d">as</a> many <span class="e">nil</span>s <a href="motion.txt.html#as" class="d">as</a> needed. If the <a href="vimeval.txt.html#list" class="d">list</a> of expressions ends with <a href="insert.txt.html#a" class="d">a</a> function
call, then all values returned by this call enter in the <a href="vimeval.txt.html#list" class="d">list</a> of values,
before the adjustment (except when the call <a href="motion.txt.html#is" class="d">is</a> enclosed in parentheses; see
<a href="luaref.txt.html#lua-expressions" class="l">lua-expressions</a>).

The assignment statement first evaluates all its expressions and only then are
the assignments performed. Thus the code

<span class="e">       i = 3</span>
<span class="e">       i, a[i] = i+1, 20</span>

sets <span class="e">a[3]</span> to 20, without affecting <span class="e">a[4]</span> because the <span class="e">i</span> in <span class="e">a[i]</span> <a href="motion.txt.html#is" class="d">is</a> evaluated (to
3) before <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> assigned 4. Similarly, the line

<span class="e">       x, y = y, x</span>

exchanges the values of <span class="e">x</span> and <span class="e">y</span>.

The meaning of assignments to global <a href="vimeval.txt.html#variables" class="d">variables</a> and table fields can be changed
via metatables. An assignment to an indexed variable `t[i] <a href="change.txt.html#%3D" class="d">=</a> val` <a href="motion.txt.html#is" class="d">is</a>
equivalent to <span class="e">settable_event(t,i,val)</span>. (See <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> complete
description of the <span class="e">settable_event</span> function. This function <a href="motion.txt.html#is" class="d">is</a> not defined or
callable in Lua. We use <a href="motion.txt.html#it" class="d">it</a> here only <a href="luaref.txt.html#for" class="d">for</a> explanatory purposes.)

An assignment to <a href="insert.txt.html#a" class="d">a</a> global variable `x <a href="change.txt.html#%3D" class="d">=</a> val` <a href="motion.txt.html#is" class="d">is</a> equivalent to the
assignment `_env.x <a href="change.txt.html#%3D" class="d">=</a> val`, which in turn <a href="motion.txt.html#is" class="d">is</a> equivalent to

<span class="e">       settable_event(_env, "x", val)</span>

where <span class="e">_env</span> <a href="motion.txt.html#is" class="d">is</a> the environment of the running function. (The <span class="e">_env</span> variable <a href="motion.txt.html#is" class="d">is</a>
not defined in Lua. We use <a href="motion.txt.html#it" class="d">it</a> here only <a href="luaref.txt.html#for" class="d">for</a> explanatory purposes.)

<span class="h">------------------------------------------------------------------------------</span>
2.4.4  Control Structures                               <span id="lua-control" class="t">lua-control</span>

                                   <span id="lua-if" class="t">lua-if</span> <span id="lua-then" class="t">lua-then</span> <span id="lua-else" class="t">lua-else</span> <span id="lua-elseif" class="t">lua-elseif</span>
                                   <span id="lua-while" class="t">lua-while</span> <span id="lua-repeat" class="t">lua-repeat</span> <span id="lua-until" class="t">lua-until</span>
The <a href="intro.txt.html#control" class="d">control</a> structures <span class="e">if</span>, <span class="e">while</span>, and <span class="e">repeat</span> have the usual meaning and
familiar syntax:

<span class="e">       stat ::=  while  exp do block end</span>
<span class="e">       stat ::=  repeat  block until exp</span>
<span class="e">       stat ::=  if  exp then block { elseif exp then block }</span>
<span class="e">                 [ else block ] end</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> also has <a href="insert.txt.html#a" class="d">a</a> <span class="e">for</span> statement, in two flavors (see <a href="luaref.txt.html#lua-for" class="l">lua-for</a>).

The condition <a href="vimeval.txt.html#expression" class="d">expression</a> of <a href="insert.txt.html#a" class="d">a</a> <a href="intro.txt.html#control" class="d">control</a> structure may return any value.
Both <span class="e">false</span> and <span class="e">nil</span> are considered false. All values different
from <span class="e">nil</span> and <span class="e">false</span> are considered true (in particular, the number <a href="motion.txt.html#0" class="d">0</a> and the
empty <a href="vimeval.txt.html#string" class="d">string</a> are also true).

In the <span class="e">repeat-until</span> loop, the inner block does not <a href="intro.txt.html#end" class="d">end</a> <a href="motion.txt.html#at" class="d">at</a> the <span class="e">until</span> keyword,
but only after the condition. So, the condition can refer to local <a href="vimeval.txt.html#variables" class="d">variables</a>
declared inside the loop block.

                                                                 <span id="lua-return" class="t">lua-return</span>
The <span class="e">return</span> statement <a href="motion.txt.html#is" class="d">is</a> used to return values from <a href="insert.txt.html#a" class="d">a</a> function or <a href="insert.txt.html#a" class="d">a</a> chunk
(which <a href="motion.txt.html#is" class="d">is</a> just <a href="insert.txt.html#a" class="d">a</a> function). Functions and chunks may return more than one
value, so the <a href="syntax.txt.html#syntax" class="d">syntax</a> <a href="luaref.txt.html#for" class="d">for</a> the <span class="e">return</span> statement <a href="motion.txt.html#is" class="d">is</a>

       `stat ::=`  <span class="e">return</span>  <span class="e">[explist1]</span>

                                                                  <span id="lua-break" class="t">lua-break</span>
The <span class="e">break</span> statement <a href="motion.txt.html#is" class="d">is</a> used to terminate the execution of <a href="insert.txt.html#a" class="d">a</a> <span class="e">while</span>, <span class="e">repeat</span>,
or <span class="e">for</span> loop, skipping to the next statement after the loop:

       `stat ::=`  <span class="e">break</span>

<a href="insert.txt.html#A" class="d">A</a> <span class="e">break</span> ends the innermost enclosing loop.

The <span class="e">return</span> and <span class="e">break</span> statements can only be written <a href="motion.txt.html#as" class="d">as</a> the <span class="e">last</span>
statement of <a href="insert.txt.html#a" class="d">a</a> block. If <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> really necessary to <span class="e">return</span> or <span class="e">break</span> in the
middle of <a href="insert.txt.html#a" class="d">a</a> block, then an explicit inner block can be used, <a href="motion.txt.html#as" class="d">as</a> in the idioms
`do return end` and `do break end`, because now <span class="e">return</span> and <span class="e">break</span> are
the last statements in their (inner) blocks.

<span class="h">------------------------------------------------------------------------------</span>
2.4.5  For Statement                             <span id="for" class="t">for</span> <span id="lua-for" class="t">lua-for</span>

The <span class="e">for</span> statement has two forms: one numeric and one generic.

The numeric <span class="e">for</span> loop repeats <a href="insert.txt.html#a" class="d">a</a> block of code while <a href="insert.txt.html#a" class="d">a</a> <a href="intro.txt.html#control" class="d">control</a> variable runs
through an arithmetic progression. It has the following syntax:

<span class="e">       stat ::=  for  Name = exp , exp [ , exp ] do block end</span>

The <span class="e">block</span> <a href="motion.txt.html#is" class="d">is</a> repeated <a href="luaref.txt.html#for" class="d">for</a> <span class="e">name</span> <a href="starting.txt.html#starting" class="d">starting</a> <a href="motion.txt.html#at" class="d">at</a> the value of the first <span class="e">exp</span>, until
<a href="motion.txt.html#it" class="d">it</a> passes the second <span class="e">exp</span> by steps of the third <span class="e">exp</span>. More precisely,
<a href="insert.txt.html#a" class="d">a</a> <span class="e">for</span> statement like

       `for var <a href="change.txt.html#%3D" class="d">=</a>  e1, e2, e3  <a href="diff.txt.html#do" class="d">do</a>  block  end`

<a href="motion.txt.html#is" class="d">is</a> equivalent to the code: 
<span class="e"></span>
<span class="e">       do</span>
<span class="e">         local  var, limit, step  = tonumber(e1), tonumber(e2), tonumber(e3)</span>
<span class="e">         if not (  var  and  limit  and  step  ) then error() end</span>
<span class="e">         while (  step  &gt;0 and  var  &lt;=  limit  )</span>
<span class="e">                 or (  step  &lt;=0 and  var  &gt;=  limit  ) do</span>
<span class="e">            block</span>
<span class="e">            var  =  var  +  step</span>
<span class="e">         end</span>
<span class="e">       end</span>


<span class="n">Note</span> the following:

 <a href="motion.txt.html#-" class="d">-</a> All three <a href="intro.txt.html#control" class="d">control</a> expressions are evaluated only once, before the loop
   starts. They must all result in numbers.
 <a href="motion.txt.html#-" class="d">-</a> <span class="e">var</span>, <span class="e">limit</span> and <span class="e">step</span> are invisible variables. The names are here <a href="luaref.txt.html#for" class="d">for</a>
   explanatory purposes only.
 <a href="motion.txt.html#-" class="d">-</a> If the third <a href="vimeval.txt.html#expression" class="d">expression</a> (the step) <a href="motion.txt.html#is" class="d">is</a> absent, then <a href="insert.txt.html#a" class="d">a</a> step of 1 <a href="motion.txt.html#is" class="d">is</a> used.
 <a href="motion.txt.html#-" class="d">-</a> You can use <span class="e">break</span> to exit <a href="insert.txt.html#a" class="d">a</a> <span class="e">for</span> loop.
 <a href="motion.txt.html#-" class="d">-</a> The loop variable <span class="e">var</span> <a href="motion.txt.html#is" class="d">is</a> local to the loop; you cannot use its value
   after the <span class="e">for</span> ends or <a href="motion.txt.html#is" class="d">is</a> broken. If you need this value, assign <a href="motion.txt.html#it" class="d">it</a> to
   another variable before breaking or <a href="starting.txt.html#exiting" class="d">exiting</a> the loop.

                                                                      <span id="for-in" class="t">for-in</span>
The generic <span class="e">for</span> statement works over functions, called <a href="lua.txt.html#iterator" class="l">iterator</a>s. On each
iteration, the <a href="lua.txt.html#iterator" class="d">iterator</a> function <a href="motion.txt.html#is" class="d">is</a> called to produce <a href="insert.txt.html#a" class="d">a</a> new value, stopping
when this new value <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>. The generic <span class="e">for</span> loop has the following syntax:

<span class="e">       stat ::=  for  namelist in explist1 do block end</span>
<span class="e">       namelist ::= Name { , Name }</span>

<a href="insert.txt.html#A" class="d">A</a> <span class="e">for</span> statement like

       <span class="e">for</span>  `var1, ..., varn`  <span class="e">in</span>  <span class="e">explist</span>  <span class="e">do</span>  <span class="e">block</span>  <span class="e">end</span>

<a href="motion.txt.html#is" class="d">is</a> equivalent to the code: 
<span class="e"></span>
<span class="e">       do</span>
<span class="e">         local  f, s, var  =  explist</span>
<span class="e">         while true do</span>
<span class="e">             local  var1, ..., varn  =  f(s, var)</span>
<span class="e">             var  =  var1</span>
<span class="e">             if  var  == nil then break end</span>
<span class="e">             block</span>
<span class="e">         end</span>
<span class="e">       end</span>

<span class="n">Note</span> the following:

 <a href="motion.txt.html#-" class="d">-</a> <span class="e">explist</span> <a href="motion.txt.html#is" class="d">is</a> evaluated only once. Its results are an <a href="lua.txt.html#iterator" class="d">iterator</a> function,
   <a href="insert.txt.html#a" class="d">a</a> <span class="e">state</span>, and an initial value <a href="luaref.txt.html#for" class="d">for</a> the first <a href="lua.txt.html#iterator" class="d">iterator</a> variable.
 <a href="motion.txt.html#-" class="d">-</a> <span class="e">f</span>, <span class="e">s</span>, and <span class="e">var</span> are invisible variables. The names are here <a href="luaref.txt.html#for" class="d">for</a>
   explanatory purposes only.
 <a href="motion.txt.html#-" class="d">-</a> You can use <span class="e">break</span> to exit <a href="insert.txt.html#a" class="d">a</a> <span class="e">for</span> loop.
 <a href="motion.txt.html#-" class="d">-</a> The loop <a href="vimeval.txt.html#variables" class="d">variables</a> `var1, ..., varn` are local to the loop; you cannot use
   their values after the <span class="e">for</span> ends. If you need these values, then assign
   them to other <a href="vimeval.txt.html#variables" class="d">variables</a> before breaking or <a href="starting.txt.html#exiting" class="d">exiting</a> the loop.

<span class="h">------------------------------------------------------------------------------</span>
2.4.6  Function Calls <a href="motion.txt.html#as" class="d">as</a> Statements           <span id="lua-funcstatement" class="t">lua-funcstatement</span>

To allow possible side-effects, function calls can be executed <a href="motion.txt.html#as" class="d">as</a> statements:

<span class="e">       stat ::= functioncall</span>

In this case, all returned values are thrown away. Function calls are
explained in <a href="luaref.txt.html#lua-function" class="l">lua-function</a><a href="repeat.txt.html#." class="d">.</a>

<span class="h">------------------------------------------------------------------------------</span>
2.4.7  Local Declarations                     <span id="lua-local" class="t">lua-local</span>

Local <a href="vimeval.txt.html#variables" class="d">variables</a> may be declared anywhere inside <a href="insert.txt.html#a" class="d">a</a> block. The declaration may
include an initial assignment:

<span class="e">       stat ::=  local  namelist [ = explist1 ]</span>
<span class="e">       namelist ::= Name { , Name }</span>

If present, an initial assignment has the same semantics of <a href="insert.txt.html#a" class="d">a</a> multiple
assignment (see <a href="luaref.txt.html#lua-assign" class="l">lua-assign</a>). Otherwise, all <a href="vimeval.txt.html#variables" class="d">variables</a> are initialized
with <span class="e">nil</span>.

<a href="insert.txt.html#A" class="d">A</a> chunk <a href="motion.txt.html#is" class="d">is</a> also <a href="insert.txt.html#a" class="d">a</a> block (see <a href="luaref.txt.html#lua-chunk" class="l">lua-chunk</a>), and so local <a href="vimeval.txt.html#variables" class="d">variables</a> can be
declared in <a href="insert.txt.html#a" class="d">a</a> chunk outside any explicit block. The scope of such local
<a href="vimeval.txt.html#variables" class="d">variables</a> extends until the <a href="intro.txt.html#end" class="d">end</a> of the chunk.

The visibility rules <a href="luaref.txt.html#for" class="d">for</a> local <a href="vimeval.txt.html#variables" class="d">variables</a> are explained in <a href="luaref.txt.html#lua-visibility" class="l">lua-visibility</a><a href="repeat.txt.html#." class="d">.</a>

<span class="h">==============================================================================</span>
2.5  Expressions                                        <span id="lua-expressions" class="t">lua-expressions</span>

The basic expressions in <a href="lua.txt.html#Lua" class="d">Lua</a> are the following:

<span class="e">       exp ::= prefixexp</span>
<span class="e">       exp ::=  nil  |  false  |  true</span>
<span class="e">       exp ::= Number</span>
<span class="e">       exp ::= String</span>
<span class="e">       exp ::= function</span>
<span class="e">       exp ::= tableconstructor</span>
<span class="e">       exp ::= ...</span>
<span class="e">       exp ::= exp binop exp</span>
<span class="e">       exp ::= unop exp</span>
<span class="e">       prefixexp ::= var | functioncall | ( exp )</span>

Numbers and literal strings are explained in <a href="luaref.txt.html#lua-lexical" class="l">lua-lexical</a><a href="motion.txt.html#%3B" class="d">;</a> <a href="vimeval.txt.html#variables" class="d">variables</a> are
explained in <a href="luaref.txt.html#lua-variables" class="l">lua-variables</a><a href="motion.txt.html#%3B" class="d">;</a> function <a href="intro.txt.html#definitions" class="d">definitions</a> are explained in
<a href="luaref.txt.html#lua-function-define" class="l">lua-function-define</a><a href="motion.txt.html#%3B" class="d">;</a> function calls are explained in <a href="luaref.txt.html#lua-function" class="l">lua-function</a><a href="motion.txt.html#%3B" class="d">;</a>
table constructors are explained in <a href="luaref.txt.html#lua-tableconstructor" class="l">lua-tableconstructor</a><a href="repeat.txt.html#." class="d">.</a> Vararg expressions,
denoted by three dots (`...`), can only be used inside vararg functions;
they are explained in <a href="luaref.txt.html#lua-function-define" class="l">lua-function-define</a><a href="repeat.txt.html#." class="d">.</a>

Binary operators comprise arithmetic operators (see <a href="luaref.txt.html#lua-arithmetic" class="l">lua-arithmetic</a>),
relational operators (see <a href="luaref.txt.html#lua-relational" class="l">lua-relational</a>), logical operators (see
<a href="luaref.txt.html#lua-logicalop" class="l">lua-logicalop</a>), and the concatenation <a href="motion.txt.html#operator" class="d">operator</a> (see <a href="luaref.txt.html#lua-concat" class="l">lua-concat</a>).
Unary operators comprise the unary minus (see <a href="luaref.txt.html#lua-arithmetic" class="l">lua-arithmetic</a>), the unary
<span class="e">not</span> (see <a href="luaref.txt.html#lua-logicalop" class="l">lua-logicalop</a>), and the unary length <a href="motion.txt.html#operator" class="d">operator</a> (see <a href="luaref.txt.html#lua-length" class="l">lua-length</a>).

Both function calls and vararg expressions may result in multiple values. If
the <a href="vimeval.txt.html#expression" class="d">expression</a> <a href="motion.txt.html#is" class="d">is</a> used <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> statement (see <a href="luaref.txt.html#lua-funcstatement" class="l">lua-funcstatement</a><a href="motion.txt.html#%29" class="d">)</a>
(only possible <a href="luaref.txt.html#for" class="d">for</a> function calls), then its return <a href="vimeval.txt.html#list" class="d">list</a> <a href="motion.txt.html#is" class="d">is</a> adjusted to zero
elements, thus discarding all returned values. If the <a href="vimeval.txt.html#expression" class="d">expression</a> <a href="motion.txt.html#is" class="d">is</a> used <a href="motion.txt.html#as" class="d">as</a>
the last (or the only) element of <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#list" class="d">list</a> of expressions, then no adjustment <a href="motion.txt.html#is" class="d">is</a>
made (unless the call <a href="motion.txt.html#is" class="d">is</a> enclosed in parentheses). In all other contexts, <a href="lua.txt.html#Lua" class="d">Lua</a>
adjusts the result <a href="vimeval.txt.html#list" class="d">list</a> to one element, discarding all values except the first
one.

Here are some examples:

<span class="e">       f()                -- adjusted to 0 results</span>
<span class="e">       g(f(), x)          -- f() is adjusted to 1 result</span>
<span class="e">       g(x, f())          -- g gets x plus all results from f()</span>
<span class="e">       a,b,c = f(), x     -- f() is adjusted to 1 result (c gets nil)</span>
<span class="e">       a,b = ...          -- a gets the first vararg parameter, b gets</span>
<span class="e">                          -- the second (both a and b may get nil if there</span>
<span class="e">                          -- is no corresponding vararg parameter)</span>
<span class="e"></span>
<span class="e">       a,b,c = x, f()     -- f() is adjusted to 2 results</span>
<span class="e">       a,b,c = f()        -- f() is adjusted to 3 results</span>
<span class="e">       return f()         -- returns all results from f()</span>
<span class="e">       return ...         -- returns all received vararg parameters</span>
<span class="e">       return x,y,f()     -- returns x, y, and all results from f()</span>
<span class="e">       {f()}              -- creates a list with all results from f()</span>
<span class="e">       {...}              -- creates a list with all vararg parameters</span>
<span class="e">       {f(), nil}         -- f() is adjusted to 1 result</span>

An <a href="vimeval.txt.html#expression" class="d">expression</a> enclosed in parentheses always results in only one value. Thus,
<span class="e">(f(x,y,z))</span> <a href="motion.txt.html#is" class="d">is</a> always <a href="insert.txt.html#a" class="d">a</a> single value, even if <span class="e">f</span> returns several values.
(The value of <span class="e">(f(x,y,z))</span> <a href="motion.txt.html#is" class="d">is</a> the first value returned by <span class="e">f</span> or <span class="e">nil</span> if <span class="e">f</span> does not
return any values.)

<span class="h">------------------------------------------------------------------------------</span>
2.5.1  Arithmetic Operators                                 <span id="lua-arithmetic" class="t">lua-arithmetic</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> supports the usual arithmetic operators: the binary <span class="e">+</span> (addition),
<span class="e">-</span> (subtraction), <span class="e">*</span> (multiplication), <span class="e">/</span> (division), <span class="e">%</span> (modulo)
and <span class="e">^</span> (exponentiation); and unary <span class="e">-</span> (negation). If the operands are numbers,
or strings that can be converted to numbers (see <a href="luaref.txt.html#lua-coercion" class="l">lua-coercion</a>), then all
operations have the usual meaning. Exponentiation works <a href="luaref.txt.html#for" class="d">for</a> any exponent. For
instance, <span class="e">x^(-0.5)</span> computes the <a href="syntax.txt.html#inverse" class="d">inverse</a> of the square root of <span class="e">x</span>. Modulo <a href="motion.txt.html#is" class="d">is</a>
defined <a href="motion.txt.html#as" class="d">as</a>

<span class="e">       a % b == a - math.floor(a/b)*b</span>

That is, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> the remainder of <a href="insert.txt.html#a" class="d">a</a> division that rounds the quotient towards
minus infinity.

<span class="h">------------------------------------------------------------------------------</span>
2.5.2  Relational Operators                                   <span id="lua-relational" class="t">lua-relational</span>

The relational operators in <a href="lua.txt.html#Lua" class="d">Lua</a> are

<span class="e">                    ==    ~=    &lt;     &gt;     &lt;=    &gt;=</span>

These operators always result in <span class="e">false</span> or <span class="e">true</span>.

Equality (`==`) first compares the type of its operands. If the types are
different, then the result <a href="motion.txt.html#is" class="d">is</a> <span class="e">false</span>. Otherwise, the values of the operands
are compared. Numbers and strings are compared in the usual way. Objects
(tables, userdata, threads, and functions) are compared by reference: two
<a href="index.txt.html#objects" class="d">objects</a> are considered equal only if they are the same object. Every time you
create <a href="insert.txt.html#a" class="d">a</a> new object (a table, userdata, or function), this new object <a href="motion.txt.html#is" class="d">is</a>
different from any previously existing object.

You can change the way that <a href="lua.txt.html#Lua" class="d">Lua</a> compares tables and <a href="luaref.txt.html#userdata" class="d">userdata</a> using the "eq"
metamethod (see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

The conversion rules of coercion <a href="luaref.txt.html#lua-coercion" class="l">lua-coercion</a> <a href="diff.txt.html#do" class="d">do</a> not apply to
equality comparisons. Thus, <span class="e">"0"==0</span> evaluates to <span class="e">false</span>, and <span class="e">t[0]</span> and
<span class="e">t["0"]</span> denote different entries in <a href="insert.txt.html#a" class="d">a</a> table.

The <a href="motion.txt.html#operator" class="d">operator</a> <span class="e">~=</span> <a href="motion.txt.html#is" class="d">is</a> exactly the negation of equality (`==`).

The order operators work <a href="motion.txt.html#as" class="d">as</a> follows. If both arguments are numbers, then they
are compared <a href="motion.txt.html#as" class="d">as</a> such. Otherwise, if both arguments are strings, then their
values are compared according to the current locale. Otherwise, <a href="lua.txt.html#Lua" class="d">Lua</a> tries to
call the "lt" or the "le" metamethod (see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

<span class="h">------------------------------------------------------------------------------</span>
2.5.3  Logical Operators                                      <span id="lua-logicalop" class="t">lua-logicalop</span>

The logical operators in <a href="lua.txt.html#Lua" class="d">Lua</a> are

<span class="e">       and    or    not</span>

Like the <a href="intro.txt.html#control" class="d">control</a> structures (see <a href="luaref.txt.html#lua-control" class="l">lua-control</a>), all logical operators
consider both <span class="e">false</span> and <span class="e">nil</span> <a href="motion.txt.html#as" class="d">as</a> false and anything else <a href="motion.txt.html#as" class="d">as</a> true.

                                                  <span id="lua-not" class="t">lua-not</span> <span id="lua-and" class="t">lua-and</span> <span id="lua-or" class="t">lua-or</span>
The negation <a href="motion.txt.html#operator" class="d">operator</a> <span class="e">not</span> always returns <span class="e">false</span> or <span class="e">true</span>. The conjunction
<a href="motion.txt.html#operator" class="d">operator</a> <span class="e">and</span> returns its first argument if this value <a href="motion.txt.html#is" class="d">is</a> <span class="e">false</span> or <span class="e">nil</span>;
otherwise, <span class="e">and</span> returns its second argument. The disjunction
<a href="motion.txt.html#operator" class="d">operator</a> <span class="e">or</span> returns its first argument if this value <a href="motion.txt.html#is" class="d">is</a> different
from <span class="e">nil</span> and <span class="e">false</span>; otherwise, <span class="e">or</span> returns its second argument.
Both <span class="e">and</span> and <span class="e">or</span> use short-cut evaluation, that is, the second operand <a href="motion.txt.html#is" class="d">is</a>
evaluated only if necessary. Here are some examples:

<span class="e">       10 or 20            --&gt; 10</span>
<span class="e">       10 or error()       --&gt; 10</span>
<span class="e">       nil or "a"          --&gt; "a"</span>
<span class="e">       nil and 10          --&gt; nil</span>
<span class="e">       false and error()   --&gt; false</span>
<span class="e">       false and nil       --&gt; false</span>
<span class="e">       false or nil        --&gt; nil</span>
<span class="e">       10 and 20           --&gt; 20</span>

(In this manual, <span class="e">--&gt;</span> indicates the result of the preceding expression.)

<span class="h">------------------------------------------------------------------------------</span>
2.5.4  Concatenation                                         <span id="lua-concat" class="t">lua-concat</span>

The <a href="vimeval.txt.html#string" class="d">string</a> concatenation <a href="motion.txt.html#operator" class="d">operator</a> in <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> denoted by two dots (`..`).
If both operands are strings or numbers, then they are converted to strings
according to the rules mentioned in <a href="luaref.txt.html#lua-coercion" class="l">lua-coercion</a><a href="repeat.txt.html#." class="d">.</a> Otherwise, the
"concat" metamethod <a href="motion.txt.html#is" class="d">is</a> called (see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

<span class="h">------------------------------------------------------------------------------</span>
2.5.5  The Length Operator                                   <span id="lua-%23" class="t">lua-#</span> <span id="lua-length" class="t">lua-length</span>

The length <a href="motion.txt.html#operator" class="d">operator</a> <a href="motion.txt.html#is" class="d">is</a> denoted by the unary <a href="motion.txt.html#operator" class="d">operator</a> <span class="e">#</span>. The length of <a href="insert.txt.html#a" class="d">a</a>
<a href="vimeval.txt.html#string" class="d">string</a> <a href="motion.txt.html#is" class="d">is</a> its number of bytes (that is, the usual meaning of <a href="vimeval.txt.html#string" class="d">string</a> length
when each character <a href="motion.txt.html#is" class="d">is</a> one byte).

The length of <a href="insert.txt.html#a" class="d">a</a> table <span class="e">t</span> <a href="motion.txt.html#is" class="d">is</a> defined to be any integer <a href="index.txt.html#index" class="d">index</a> <span class="e">n</span> such that <span class="e">t[n]</span> <a href="motion.txt.html#is" class="d">is</a>
not <span class="e">nil</span> and <span class="e">t[n+1]</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>; moreover, if <span class="e">t[1]</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, <span class="e">n</span> may be zero. For <a href="insert.txt.html#a" class="d">a</a>
regular array, with non-nil values from 1 to <a href="insert.txt.html#a" class="d">a</a> given <span class="e">n</span>, its length <a href="motion.txt.html#is" class="d">is</a> exactly
that <span class="e">n</span>, the <a href="index.txt.html#index" class="d">index</a> of its last value. If the array has "holes" (that
is, <span class="e">nil</span> values between other non-nil values), then <span class="e">#t</span> may be any of the
indices that directly precedes <a href="insert.txt.html#a" class="d">a</a> <span class="e">nil</span> value (that is, <a href="motion.txt.html#it" class="d">it</a> may consider any
such <span class="e">nil</span> value <a href="motion.txt.html#as" class="d">as</a> the <a href="intro.txt.html#end" class="d">end</a> of the array).

<span class="h">------------------------------------------------------------------------------</span>
2.5.6  Precedence                                              <span id="lua-precedence" class="t">lua-precedence</span>

Operator precedence in <a href="lua.txt.html#Lua" class="d">Lua</a> follows the table below, from lower to higher
priority:

<span class="e">       or</span>
<span class="e">       and</span>
<span class="e">       &lt;     &gt;     &lt;=    &gt;=    ~=    ==</span>
<span class="e">       ..</span>
<span class="e">       +     -</span>
<span class="e">       *     /</span>
<span class="e">       not   #     - (unary)</span>
<span class="e">       ^</span>

As usual, you can use parentheses to change the precedences in an expression.
The concatenation (`..`) and exponentiation (`^`) operators are right
associative. All other binary operators are left associative.

<span class="h">------------------------------------------------------------------------------</span>
2.5.7  Table Constructors                                <span id="lua-tableconstructor" class="t">lua-tableconstructor</span>

Table constructors are expressions that create tables. Every time <a href="insert.txt.html#a" class="d">a</a>
constructor <a href="motion.txt.html#is" class="d">is</a> evaluated, <a href="insert.txt.html#a" class="d">a</a> new table <a href="motion.txt.html#is" class="d">is</a> created. Constructors can be used to
create empty tables, or to create <a href="insert.txt.html#a" class="d">a</a> table and initialize some of its fields.
The general <a href="syntax.txt.html#syntax" class="d">syntax</a> <a href="luaref.txt.html#for" class="d">for</a> constructors <a href="motion.txt.html#is" class="d">is</a>

<span class="e">       tableconstructor ::= { [ fieldlist ] }</span>
<span class="e">       fieldlist ::= field { fieldsep field } [ fieldsep ]</span>
<span class="e">       field ::= [ exp ]  = exp | Name = exp | exp</span>
<span class="e">       fieldsep ::=  , |  ;</span>

Each field of the form `[exp1] <a href="change.txt.html#%3D" class="d">=</a> exp2` adds to the new table an entry with
key <span class="e">exp1</span> and value <span class="e">exp2</span>. <a href="insert.txt.html#A" class="d">A</a> field of the form `name <a href="change.txt.html#%3D" class="d">=</a> exp` <a href="motion.txt.html#is" class="d">is</a> equivalent to
<a href="motion.txt.html#%60%5B" class="d">`[</a>"name"<a href="index.txt.html#%5D" class="d">]</a> <a href="change.txt.html#%3D" class="d">=</a> exp`. Finally, fields of the form <span class="e">exp</span> are equivalent to
`[i] <a href="change.txt.html#%3D" class="d">=</a> exp`, where <span class="e">i</span> are consecutive numerical integers, <a href="starting.txt.html#starting" class="d">starting</a> with 1.
Fields in the other formats <a href="diff.txt.html#do" class="d">do</a> not affect this counting. For example,

<span class="e">       a = { [f(1)] = g; "x", "y"; x = 1, f(x), [30] = 23; 45 }</span>

<a href="motion.txt.html#is" class="d">is</a> equivalent to

<span class="e">       do</span>
<span class="e">         local t = {}</span>
<span class="e">         t[f(1)] = g</span>
<span class="e">         t[1] = "x"         -- 1st exp</span>
<span class="e">         t[2] = "y"         -- 2nd exp</span>
<span class="e">         t.x = 1            -- temp["x"] = 1</span>
<span class="e">         t[3] = f(x)        -- 3rd exp</span>
<span class="e">         t[30] = 23</span>
<span class="e">         t[4] = 45          -- 4th exp</span>
<span class="e">         a = t</span>
<span class="e">       end</span>

If the last field in the <a href="vimeval.txt.html#list" class="d">list</a> has the form <span class="e">exp</span> and the <a href="vimeval.txt.html#expression" class="d">expression</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a>
function call, then all values returned by the call enter the <a href="vimeval.txt.html#list" class="d">list</a>
consecutively (see <a href="luaref.txt.html#lua-function" class="l">lua-function</a>). To avoid this, enclose the function
call in parentheses (see <a href="luaref.txt.html#lua-expressions" class="l">lua-expressions</a>).

The field <a href="vimeval.txt.html#list" class="d">list</a> may have an optional trailing separator, <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> convenience <a href="luaref.txt.html#for" class="d">for</a>
machine-generated code.

<span class="h">------------------------------------------------------------------------------</span>
2.5.8  Function Calls                     <span id="lua-function" class="t">lua-function</span>

<a href="insert.txt.html#A" class="d">A</a> function call in <a href="lua.txt.html#Lua" class="d">Lua</a> has the following syntax:

<span class="e">       functioncall ::= prefixexp args</span>

In <a href="insert.txt.html#a" class="d">a</a> function call, first <span class="e">prefixexp</span> and <span class="e">args</span> are evaluated. If the value
of <span class="e">prefixexp</span> has type <span class="e">function</span>, then this function <a href="motion.txt.html#is" class="d">is</a> called with the given
arguments. Otherwise, the <span class="e">prefixexp</span> "call" metamethod <a href="motion.txt.html#is" class="d">is</a> called, having <a href="motion.txt.html#as" class="d">as</a>
first parameter the value of <span class="e">prefixexp</span>, followed by the original call
arguments (see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

The form

<span class="e">       functioncall ::= prefixexp : Name args</span>

can be used to call "methods"<a href="repeat.txt.html#." class="d">.</a> <a href="insert.txt.html#A" class="d">A</a> call <span class="e">v:name(</span> <span class="e">args</span> <span class="e">)</span> <a href="motion.txt.html#is" class="d">is</a> syntactic sugar
<a href="luaref.txt.html#for" class="d">for</a> <span class="e">v.name(v,</span> <span class="e">args</span> <span class="e">)</span>, except that <span class="e">v</span> <a href="motion.txt.html#is" class="d">is</a> evaluated only once.

Arguments have the following syntax:

<span class="e">       args ::=  ( [ explist1 ] )</span>
<span class="e">       args ::= tableconstructor</span>
<span class="e">       args ::= String</span>

All argument expressions are evaluated before the call.  <a href="insert.txt.html#A" class="d">A</a> call of the
form <span class="e">f{</span> <span class="e">fields</span> <span class="e">}</span> <a href="motion.txt.html#is" class="d">is</a> syntactic sugar <a href="luaref.txt.html#for" class="d">for</a> <span class="e">f({</span> <span class="e">fields</span> <span class="e">})</span>, that is, the
argument <a href="vimeval.txt.html#list" class="d">list</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> single new table. <a href="insert.txt.html#A" class="d">A</a> call of the form <span class="e">f'</span> <span class="e">string</span> <span class="e">'</span>
(or <span class="e">f"</span> <span class="e">string</span> <span class="e">"</span> or <span class="e">f[[</span> <span class="e">string</span> <span class="e">]]</span>) <a href="motion.txt.html#is" class="d">is</a> syntactic sugar <a href="luaref.txt.html#for" class="d">for</a>
<span class="e">f('</span> <span class="e">string</span> <span class="e">')</span>, that is, the argument <a href="vimeval.txt.html#list" class="d">list</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> single literal string.

As an exception to the free-format <a href="syntax.txt.html#syntax" class="d">syntax</a> of Lua, you cannot <a href="change.txt.html#put" class="d">put</a> <a href="insert.txt.html#a" class="d">a</a> line break
before the <span class="e">(</span> in <a href="insert.txt.html#a" class="d">a</a> function call. This restriction avoids some ambiguities
in the language. If you write

<span class="e">       a = f</span>
<span class="e">       (g).x(a)</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> would see that <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> single statement, <a href="motion.txt.html#%60a" class="d">`a</a> <a href="change.txt.html#%3D" class="d">=</a> f(g).x(a)`. So, if you want two
statements, you must add <a href="insert.txt.html#a" class="d">a</a> semi-colon between them. If you actually want to
call <span class="e">f</span>, you must remove the line break before <span class="e">(g)</span>.

                                                               <span id="lua-tailcall" class="t">lua-tailcall</span>
<a href="insert.txt.html#A" class="d">A</a> call of the form <span class="e">return</span> <span class="e">functioncall</span> <a href="motion.txt.html#is" class="d">is</a> called <a href="insert.txt.html#a" class="d">a</a> tail call. <a href="lua.txt.html#Lua" class="d">Lua</a>
implements proper tail calls (or proper tail recursion): in <a href="insert.txt.html#a" class="d">a</a> tail call, the
called function reuses the stack entry of the calling function. Therefore,
there <a href="motion.txt.html#is" class="d">is</a> no limit on the number of nested tail calls that <a href="insert.txt.html#a" class="d">a</a> program can
execute. However, <a href="insert.txt.html#a" class="d">a</a> tail call erases any debug information about the calling
function. <span class="n">Note</span> that <a href="insert.txt.html#a" class="d">a</a> tail call only happens with <a href="insert.txt.html#a" class="d">a</a> particular syntax, where
the <span class="e">return</span> has one single function call <a href="motion.txt.html#as" class="d">as</a> argument; this <a href="syntax.txt.html#syntax" class="d">syntax</a> makes the
calling function return exactly the returns of the called function. So, none
of the following examples are tail calls:

<span class="e">       return (f(x))        -- results adjusted to 1</span>
<span class="e">       return 2 * f(x)</span>
<span class="e">       return x, f(x)       -- additional results</span>
<span class="e">       f(x); return         -- results discarded</span>
<span class="e">       return x or f(x)     -- results adjusted to 1</span>


<span class="h">------------------------------------------------------------------------------</span>
2.5.9  Function Definitions                     <span id="lua-function-define" class="t">lua-function-define</span>

The <a href="syntax.txt.html#syntax" class="d">syntax</a> <a href="luaref.txt.html#for" class="d">for</a> function definition <a href="motion.txt.html#is" class="d">is</a>

<span class="e">       function ::= function funcbody</span>
<span class="e">       funcbody ::= ( [ parlist1 ] ) block end</span>

The following syntactic sugar simplifies function definitions:

<span class="e">       stat ::= function funcname funcbody</span>
<span class="e">       stat ::= local function Name funcbody</span>
<span class="e">       funcname ::= Name { . Name } [ : Name ]</span>

The statement

       `function <a href="motion.txt.html#f" class="d">f</a> ()`  <span class="e">body</span>  <span class="e">end</span>

translates to

       `f <a href="change.txt.html#%3D" class="d">=</a> function ()`  <span class="e">body</span>  <span class="e">end</span>

The statement

       `function t.a.b.c.f ()`  <span class="e">body</span>  <span class="e">end</span>

translates to

       `t.a.b.c.f <a href="change.txt.html#%3D" class="d">=</a> function ()`  <span class="e">body</span>  <span class="e">end</span>

The statement

       `local function <a href="motion.txt.html#f" class="d">f</a> ()`  <span class="e">body</span>  <span class="e">end</span>

translates to

       `local f; <a href="motion.txt.html#f" class="d">f</a> <a href="change.txt.html#%3D" class="d">=</a> function <a href="motion.txt.html#f" class="d">f</a> ()`  <span class="e">body</span>  <span class="e">end</span>

not to

       `local <a href="motion.txt.html#f" class="d">f</a> <a href="change.txt.html#%3D" class="d">=</a> function <a href="motion.txt.html#f" class="d">f</a> ()`  <span class="e">body</span>  <span class="e">end</span>

(This only makes <a href="insert.txt.html#a" class="d">a</a> difference when the body of the function contains
references to <span class="e">f</span>.)

                                                                <span id="lua-closure" class="t">lua-closure</span>
<a href="insert.txt.html#A" class="d">A</a> function definition <a href="motion.txt.html#is" class="d">is</a> an executable expression, whose value has type
<span class="e">function</span>. When <a href="lua.txt.html#Lua" class="d">Lua</a> pre-compiles <a href="insert.txt.html#a" class="d">a</a> chunk, all its function bodies are
pre-compiled too. Then, whenever <a href="lua.txt.html#Lua" class="d">Lua</a> executes the function definition, the
function <a href="motion.txt.html#is" class="d">is</a> instantiated (or closed). This function instance (or closure) <a href="motion.txt.html#is" class="d">is</a>
the final value of the expression. Different instances of the same function
may refer to different external local <a href="vimeval.txt.html#variables" class="d">variables</a> and may have different
environment tables.

Parameters act <a href="motion.txt.html#as" class="d">as</a> local <a href="vimeval.txt.html#variables" class="d">variables</a> that are initialized with the argument
values:

<span class="e">       parlist1 ::= namelist [ , ... ] | ...</span>

                                                                 <span id="lua-vararg" class="t">lua-vararg</span>
When <a href="insert.txt.html#a" class="d">a</a> function <a href="motion.txt.html#is" class="d">is</a> called, the <a href="vimeval.txt.html#list" class="d">list</a> of arguments <a href="motion.txt.html#is" class="d">is</a> adjusted to the length of
the <a href="vimeval.txt.html#list" class="d">list</a> of parameters, unless the function <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> variadic or vararg function,
which <a href="motion.txt.html#is" class="d">is</a> indicated by three dots (`...`) <a href="motion.txt.html#at" class="d">at</a> the <a href="intro.txt.html#end" class="d">end</a> of its parameter list. <a href="insert.txt.html#A" class="d">A</a>
vararg function does not adjust its argument list; instead, <a href="motion.txt.html#it" class="d">it</a> collects all
extra arguments and supplies them to the function through <a href="insert.txt.html#a" class="d">a</a> vararg expression,
which <a href="motion.txt.html#is" class="d">is</a> also written <a href="motion.txt.html#as" class="d">as</a> three dots. The value of this <a href="vimeval.txt.html#expression" class="d">expression</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#list" class="d">list</a> of
all actual extra arguments, similar to <a href="insert.txt.html#a" class="d">a</a> function with multiple results. If <a href="insert.txt.html#a" class="d">a</a>
vararg <a href="vimeval.txt.html#expression" class="d">expression</a> <a href="motion.txt.html#is" class="d">is</a> used inside another <a href="vimeval.txt.html#expression" class="d">expression</a> or in the middle of <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#list" class="d">list</a>
of expressions, then its return <a href="vimeval.txt.html#list" class="d">list</a> <a href="motion.txt.html#is" class="d">is</a> adjusted to one element. If the
<a href="vimeval.txt.html#expression" class="d">expression</a> <a href="motion.txt.html#is" class="d">is</a> used <a href="motion.txt.html#as" class="d">as</a> the last element of <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#list" class="d">list</a> of expressions, then no
adjustment <a href="motion.txt.html#is" class="d">is</a> made (unless the call <a href="motion.txt.html#is" class="d">is</a> enclosed in parentheses).

As an example, consider the following definitions:

<span class="e">       function f(a, b) end</span>
<span class="e">       function g(a, b, ...) end</span>
<span class="e">       function r() return 1,2,3 end</span>

Then, we have the following <a href="map.txt.html#mapping" class="d">mapping</a> from arguments to parameters and to the
vararg expression:

<span class="e">       CALL            PARAMETERS</span>
<span class="e"></span>
<span class="e">       f(3)             a=3, b=nil</span>
<span class="e">       f(3, 4)          a=3, b=4</span>
<span class="e">       f(3, 4, 5)       a=3, b=4</span>
<span class="e">       f(r(), 10)       a=1, b=10</span>
<span class="e">       f(r())           a=1, b=2</span>
<span class="e"></span>
<span class="e">       g(3)             a=3, b=nil, ... --&gt;  (nothing)</span>
<span class="e">       g(3, 4)          a=3, b=4,   ... --&gt;  (nothing)</span>
<span class="e">       g(3, 4, 5, 8)    a=3, b=4,   ... --&gt;  5  8</span>
<span class="e">       g(5, r())        a=5, b=1,   ... --&gt;  2  3</span>

Results are returned using the <span class="e">return</span> statement (see <a href="luaref.txt.html#lua-control" class="l">lua-control</a>).
If <a href="intro.txt.html#control" class="d">control</a> reaches the <a href="intro.txt.html#end" class="d">end</a> of <a href="insert.txt.html#a" class="d">a</a> function without encountering
<a href="insert.txt.html#a" class="d">a</a> <span class="e">return</span> statement, then the function returns with no results.

                                                            <span id="lua-colonsyntax" class="t">lua-colonsyntax</span>
The colon <a href="syntax.txt.html#syntax" class="d">syntax</a> <a href="motion.txt.html#is" class="d">is</a> used <a href="luaref.txt.html#for" class="d">for</a> defining methods, that is, <a href="vimeval.txt.html#functions" class="d">functions</a> that have an
implicit extra parameter <span class="e">self</span>. Thus, the statement

       `function t.a.b.c:f (`  <span class="e">params</span>  <span class="e">)</span>  <span class="e">body</span>  <span class="e">end</span>

<a href="motion.txt.html#is" class="d">is</a> syntactic sugar <a href="luaref.txt.html#for" class="d">for</a>

       `t.a.b.c:f <a href="change.txt.html#%3D" class="d">=</a> function (`  <span class="e">self</span>,  <span class="e">params</span>  <span class="e">)</span>  <span class="e">body</span>  <span class="e">end</span>

<span class="h">==============================================================================</span>
2.6  Visibility Rules                                    <span id="lua-visibility" class="t">lua-visibility</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> lexically scoped language. The scope of <a href="vimeval.txt.html#variables" class="d">variables</a> begins <a href="motion.txt.html#at" class="d">at</a> the first
statement after their declaration and lasts until the <a href="intro.txt.html#end" class="d">end</a> of the innermost
block that includes the declaration. Consider the following example:

<span class="e">       x = 10                -- global variable</span>
<span class="e">       do                    -- new block</span>
<span class="e">         local x = x         -- new `x`, with value 10</span>
<span class="e">         print(x)            --&gt; 10</span>
<span class="e">         x = x+1</span>
<span class="e">         do                  -- another block</span>
<span class="e">           local x = x+1     -- another `x`</span>
<span class="e">           print(x)          --&gt; 12</span>
<span class="e">         end</span>
<span class="e">         print(x)            --&gt; 11</span>
<span class="e">       end</span>
<span class="e">       print(x)              --&gt; 10  (the global one)</span>

Notice that, in <a href="insert.txt.html#a" class="d">a</a> declaration like `local <a href="change.txt.html#x" class="d">x</a> <a href="change.txt.html#%3D" class="d">=</a> x`, the new <span class="e">x</span> being declared <a href="motion.txt.html#is" class="d">is</a>
not in scope yet, and so the second <span class="e">x</span> refers to the outside variable.

                                                                <span id="lua-upvalue" class="t">lua-upvalue</span>
Because of the lexical scoping rules, local <a href="vimeval.txt.html#variables" class="d">variables</a> can be freely accessed
by <a href="vimeval.txt.html#functions" class="d">functions</a> defined inside their scope. <a href="insert.txt.html#A" class="d">A</a> local variable used by an inner
function <a href="motion.txt.html#is" class="d">is</a> called an upvalue, or external local variable, inside the inner
function.

Notice that each execution of <a href="insert.txt.html#a" class="d">a</a> local statement defines new local variables.
Consider the following example:

<span class="e">       a = {}</span>
<span class="e">       local x = 20</span>
<span class="e">       for i=1,10 do</span>
<span class="e">         local y = 0</span>
<span class="e">         a[i] = function () y=y+1; return x+y end</span>
<span class="e">       end</span>

The loop creates ten closures (that is, ten instances of the anonymous
function). Each of these closures uses <a href="insert.txt.html#a" class="d">a</a> different <span class="e">y</span> variable, while all of
them share the same <span class="e">x</span>.

<span class="h">==============================================================================</span>
2.7  Error Handling                                           <span id="lua-errors" class="t">lua-errors</span>

Because <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> an embedded extension language, all <a href="lua.txt.html#Lua" class="d">Lua</a> actions start from
<a href="change.txt.html#C" class="d">C</a> code in the host program calling <a href="insert.txt.html#a" class="d">a</a> function from the <a href="lua.txt.html#Lua" class="d">Lua</a> library (see
<a href="luaref.txt.html#lua_pcall%28%29" class="l">lua_pcall()</a>). Whenever an error occurs during <a href="lua.txt.html#Lua" class="d">Lua</a> compilation or
execution, <a href="intro.txt.html#control" class="d">control</a> returns to C, which can take appropriate measures (such <a href="motion.txt.html#as" class="d">as</a>
print an error message).

<a href="lua.txt.html#Lua" class="d">Lua</a> code can explicitly generate an error by calling the <span class="e">error</span> function (see
<a href="luaref.txt.html#error%28%29" class="l">error()</a>). If you need to catch <a href="message.txt.html#errors" class="d">errors</a> in Lua, you can use the <span class="e">pcall</span>
function (see <a href="luaref.txt.html#pcall%28%29" class="l">pcall()</a>).

<span class="h">==============================================================================</span>
2.8  Metatables                         <span id="metatable" class="t">metatable</span> <span id="lua-metatable" class="t">lua-metatable</span>

Every value in <a href="lua.txt.html#Lua" class="d">Lua</a> may have <a href="insert.txt.html#a" class="d">a</a> metatable. This <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="motion.txt.html#is" class="d">is</a> an ordinary <a href="lua.txt.html#Lua" class="d">Lua</a>
table that defines the behavior of the original table and <a href="luaref.txt.html#userdata" class="d">userdata</a> under
certain special operations. You can change several aspects of the behavior of
an object by setting specific fields in its metatable. For instance, when <a href="insert.txt.html#a" class="d">a</a>
non-numeric value <a href="motion.txt.html#is" class="d">is</a> the operand of an addition, <a href="lua.txt.html#Lua" class="d">Lua</a> checks <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> function in
the field <span class="e">"__add"</span> in its metatable. If <a href="motion.txt.html#it" class="d">it</a> finds one, <a href="lua.txt.html#Lua" class="d">Lua</a> calls that function
to perform the addition.

We call the keys in <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="autocmd.txt.html#events" class="d">events</a> and the values metamethods. In the
previous example, the event <a href="motion.txt.html#is" class="d">is</a> "add" and the metamethod <a href="motion.txt.html#is" class="d">is</a> the function that
performs the addition.

You can query the <a href="luaref.txt.html#metatable" class="d">metatable</a> of any value through the <span class="e">getmetatable</span> function
(see <a href="luaref.txt.html#getmetatable%28%29" class="l">getmetatable()</a>).

You can replace the <a href="luaref.txt.html#metatable" class="d">metatable</a> of tables through the <span class="e">setmetatable</span> function (see
<a href="luaref.txt.html#setmetatable%28%29" class="l">setmetatable()</a>). You cannot change the <a href="luaref.txt.html#metatable" class="d">metatable</a> of other types from <a href="lua.txt.html#Lua" class="d">Lua</a>
(except using the debug library); you must use the <a href="change.txt.html#C" class="d">C</a> <a href="api.txt.html#API" class="d">API</a> <a href="luaref.txt.html#for" class="d">for</a> that.

Tables and <a href="luaref.txt.html#userdata" class="d">userdata</a> have individual metatables (although multiple tables and
<a href="luaref.txt.html#userdata" class="d">userdata</a> can share <a href="insert.txt.html#a" class="d">a</a> same table <a href="motion.txt.html#as" class="d">as</a> their metatable); values of all other types
share one single <a href="luaref.txt.html#metatable" class="d">metatable</a> per type. So, there <a href="motion.txt.html#is" class="d">is</a> one single <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="luaref.txt.html#for" class="d">for</a> all
numbers, and <a href="luaref.txt.html#for" class="d">for</a> all strings, etc.

<a href="insert.txt.html#A" class="d">A</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> may <a href="intro.txt.html#control" class="d">control</a> how an object behaves in arithmetic operations, order
comparisons, concatenation, length operation, and indexing. <a href="insert.txt.html#A" class="d">A</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> can
also define <a href="insert.txt.html#a" class="d">a</a> function to be called when <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#userdata" class="d">userdata</a> <a href="motion.txt.html#is" class="d">is</a> garbage collected. For
each of those operations <a href="lua.txt.html#Lua" class="d">Lua</a> associates <a href="insert.txt.html#a" class="d">a</a> specific key called an event. When
<a href="lua.txt.html#Lua" class="d">Lua</a> performs one of those operations over <a href="insert.txt.html#a" class="d">a</a> value, <a href="motion.txt.html#it" class="d">it</a> checks whether this
value has <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> with the corresponding event. If so, the value
associated with that key (the metamethod) controls how <a href="lua.txt.html#Lua" class="d">Lua</a> will perform the
operation.

Metatables <a href="intro.txt.html#control" class="d">control</a> the operations listed next. Each operation <a href="motion.txt.html#is" class="d">is</a> identified by
its corresponding name. The key <a href="luaref.txt.html#for" class="d">for</a> each operation <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> with its name
prefixed by two underscores, <span class="e">__</span>; <a href="luaref.txt.html#for" class="d">for</a> instance, the key <a href="luaref.txt.html#for" class="d">for</a> operation "add"
<a href="motion.txt.html#is" class="d">is</a> the <a href="vimeval.txt.html#string" class="d">string</a> "__add"<a href="repeat.txt.html#." class="d">.</a> The semantics of these operations <a href="motion.txt.html#is" class="d">is</a> better explained
by <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function describing how the interpreter executes that operation.

The code shown here in <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> only illustrative; the real behavior <a href="motion.txt.html#is" class="d">is</a> hard
coded in the interpreter and <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> much more efficient than this simulation.
All <a href="vimeval.txt.html#functions" class="d">functions</a> used in these descriptions (`rawget`, <span class="e">tonumber</span>, etc.) are
described in <a href="luaref.txt.html#lua-lib-core" class="l">lua-lib-core</a><a href="repeat.txt.html#." class="d">.</a> In particular, to retrieve the metamethod of <a href="insert.txt.html#a" class="d">a</a>
given object, we use the <a href="vimeval.txt.html#expression" class="d">expression</a>

<span class="e">       metatable(obj)[event]</span>

This should be read <a href="motion.txt.html#as" class="d">as</a>

<span class="e">       rawget(metatable(obj) or {}, event)</span>

That is, the access to <a href="insert.txt.html#a" class="d">a</a> metamethod does not invoke other metamethods, and the
access to <a href="index.txt.html#objects" class="d">objects</a> with no metatables does not fail (it simply results
in <span class="e">nil</span>).

"add"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__add%28%29" class="t">__add()</span>
<span class="h">------</span>
the <span class="e">+</span> operation.

The function <span class="e">getbinhandler</span> below defines how <a href="lua.txt.html#Lua" class="d">Lua</a> chooses <a href="insert.txt.html#a" class="d">a</a> handler <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a>
binary operation. First, <a href="lua.txt.html#Lua" class="d">Lua</a> tries the first operand. If its type does not
define <a href="insert.txt.html#a" class="d">a</a> handler <a href="luaref.txt.html#for" class="d">for</a> the operation, then <a href="lua.txt.html#Lua" class="d">Lua</a> tries the second operand.

<span class="e">       function getbinhandler (op1, op2, event)</span>
<span class="e">         return metatable(op1)[event] or metatable(op2)[event]</span>
<span class="e">       end</span>

By using this function, the behavior of the `op1 <a href="motion.txt.html#%2B" class="d">+</a> op2` <a href="motion.txt.html#is" class="d">is</a>

<span class="e">       function add_event (op1, op2)</span>
<span class="e">         local o1, o2 = tonumber(op1), tonumber(op2)</span>
<span class="e">         if o1 and o2 then  -- both operands are numeric?</span>
<span class="e">           return o1 + o2   -- `+` here is the primitive `add`</span>
<span class="e">         else  -- at least one of the operands is not numeric</span>
<span class="e">           local h = getbinhandler(op1, op2, "__add")</span>
<span class="e">           if h then</span>
<span class="e">             -- call the handler with both operands</span>
<span class="e">             return h(op1, op2)</span>
<span class="e">           else  -- no handler available: default behavior</span>
<span class="e">             error(...)</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">       end</span>

"sub"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__sub%28%29" class="t">__sub()</span>
<span class="h">------</span>
the <span class="e">-</span> operation. Behavior similar to the "add" operation.

"mul"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__mul%28%29" class="t">__mul()</span>
<span class="h">------</span>
the <span class="e">*</span> operation. Behavior similar to the "add" operation.

"div"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__div%28%29" class="t">__div()</span>
<span class="h">------</span>
the <span class="e">/</span> operation. Behavior similar to the "add" operation.

"mod"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__mod%28%29" class="t">__mod()</span>
<span class="h">------</span>
the <span class="e">%</span> operation. Behavior similar to the "add" operation, with the
operation `o1 <a href="motion.txt.html#-" class="d">-</a> floor(o1/o2)*o2` <a href="motion.txt.html#as" class="d">as</a> the primitive operation.

"pow"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__pow%28%29" class="t">__pow()</span>
<span class="h">------</span>
the <span class="e">^</span> (exponentiation) operation. Behavior similar to the "add" operation,
with the function <span class="e">pow</span> (from the <a href="change.txt.html#C" class="d">C</a> math library) <a href="motion.txt.html#as" class="d">as</a> the primitive operation.

"unm"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__unm%28%29" class="t">__unm()</span>
<span class="h">------</span>
the unary <span class="e">-</span> operation.

<span class="e">       function unm_event (op)</span>
<span class="e">         local o = tonumber(op)</span>
<span class="e">         if o then  -- operand is numeric?</span>
<span class="e">           return -o  -- `-` here is the primitive `unm`</span>
<span class="e">         else  -- the operand is not numeric.</span>
<span class="e">           -- Try to get a handler from the operand</span>
<span class="e">           local h = metatable(op).__unm</span>
<span class="e">           if h then</span>
<span class="e">             -- call the handler with the operand</span>
<span class="e">             return h(op)</span>
<span class="e">           else  -- no handler available: default behavior</span>
<span class="e">             error(...)</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">       end</span>

"concat"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                           <span id="__concat%28%29" class="t">__concat()</span>
<span class="h">---------</span>
the <span class="e">..</span> (concatenation) operation.

<span class="e">       function concat_event (op1, op2)</span>
<span class="e">         if (type(op1) == "string" or type(op1) == "number") and</span>
<span class="e">            (type(op2) == "string" or type(op2) == "number") then</span>
<span class="e">           return op1 .. op2  -- primitive string concatenation</span>
<span class="e">         else</span>
<span class="e">           local h = getbinhandler(op1, op2, "__concat")</span>
<span class="e">           if h then</span>
<span class="e">             return h(op1, op2)</span>
<span class="e">           else</span>
<span class="e">             error(...)</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">       end</span>

"len"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                 <span id="__len%28%29" class="t">__len()</span>
<span class="h">------</span>
the <span class="e">#</span> operation.

<span class="e">       function len_event (op)</span>
<span class="e">         if type(op) == "string" then</span>
<span class="e">           return strlen(op)         -- primitive string length</span>
<span class="e">         elseif type(op) == "table" then</span>
<span class="e">           return #op                -- primitive table length</span>
<span class="e">         else</span>
<span class="e">           local h = metatable(op).__len</span>
<span class="e">           if h then</span>
<span class="e">             -- call the handler with the operand</span>
<span class="e">             return h(op)</span>
<span class="e">           else  -- no handler available: default behavior</span>
<span class="e">             error(...)</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">       end</span>

"eq"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                   <span id="__eq%28%29" class="t">__eq()</span>
-----
the <span class="e">==</span> operation.

The function <span class="e">getcomphandler</span> defines how <a href="lua.txt.html#Lua" class="d">Lua</a> chooses <a href="insert.txt.html#a" class="d">a</a> metamethod <a href="luaref.txt.html#for" class="d">for</a>
comparison operators. <a href="insert.txt.html#A" class="d">A</a> metamethod only <a href="motion.txt.html#is" class="d">is</a> selected when both <a href="index.txt.html#objects" class="d">objects</a> being
compared have the same type and the same metamethod <a href="luaref.txt.html#for" class="d">for</a> the selected
operation.

<span class="e">       function getcomphandler (op1, op2, event)</span>
<span class="e">         if type(op1) ~= type(op2) then return nil end</span>
<span class="e">         local mm1 = metatable(op1)[event]</span>
<span class="e">         local mm2 = metatable(op2)[event]</span>
<span class="e">         if mm1 == mm2 then return mm1 else return nil end</span>
<span class="e">       end</span>

The "eq" event <a href="motion.txt.html#is" class="d">is</a> defined <a href="motion.txt.html#as" class="d">as</a> follows:

<span class="e">       function eq_event (op1, op2)</span>
<span class="e">         if type(op1) ~= type(op2) then  -- different types?</span>
<span class="e">           return false   -- different objects</span>
<span class="e">         end</span>
<span class="e">         if op1 == op2 then   -- primitive equal?</span>
<span class="e">           return true   -- objects are equal</span>
<span class="e">         end</span>
<span class="e">         -- try metamethod</span>
<span class="e">         local h = getcomphandler(op1, op2, "__eq")</span>
<span class="e">         if h then</span>
<span class="e">           return h(op1, op2)</span>
<span class="e">         else</span>
<span class="e">           return false</span>
<span class="e">         end</span>
<span class="e">       end</span>

<a href="motion.txt.html#%60a" class="d">`a</a> ~= b` <a href="motion.txt.html#is" class="d">is</a> equivalent to `not (a <a href="change.txt.html#%3D%3D" class="d">==</a> b)`.

"lt"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                   <span id="__lt%28%29" class="t">__lt()</span>
-----
the <span class="e">&lt;</span> operation.

<span class="e">       function lt_event (op1, op2)</span>
<span class="e">         if type(op1) == "number" and type(op2) == "number" then</span>
<span class="e">           return op1 &lt; op2   -- numeric comparison</span>
<span class="e">         elseif type(op1) == "string" and type(op2) == "string" then</span>
<span class="e">           return op1 &lt; op2   -- lexicographic comparison</span>
<span class="e">         else</span>
<span class="e">           local h = getcomphandler(op1, op2, "__lt")</span>
<span class="e">           if h then</span>
<span class="e">             return h(op1, op2)</span>
<span class="e">           else</span>
<span class="e">             error(...);</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">       end</span>

<a href="motion.txt.html#%60a" class="d">`a</a> <a href="change.txt.html#%3E" class="d">&gt;</a> b` <a href="motion.txt.html#is" class="d">is</a> equivalent to `b <a href="change.txt.html#%3C" class="d">&lt;</a> a`.

"le"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                                   <span id="__le%28%29" class="t">__le()</span>
-----
the <span class="e">&lt;=</span> operation.

<span class="e">       function le_event (op1, op2)</span>
<span class="e">         if type(op1) == "number" and type(op2) == "number" then</span>
<span class="e">           return op1 &lt;= op2   -- numeric comparison</span>
<span class="e">         elseif type(op1) == "string" and type(op2) == "string" then</span>
<span class="e">           return op1 &lt;= op2   -- lexicographic comparison</span>
<span class="e">         else</span>
<span class="e">           local h = getcomphandler(op1, op2, "__le")</span>
<span class="e">           if h then</span>
<span class="e">             return h(op1, op2)</span>
<span class="e">           else</span>
<span class="e">             h = getcomphandler(op1, op2, "__lt")</span>
<span class="e">             if h then</span>
<span class="e">               return not h(op2, op1)</span>
<span class="e">             else</span>
<span class="e">               error(...);</span>
<span class="e">             end</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">       end</span>

<a href="motion.txt.html#%60a" class="d">`a</a> &gt;= b` <a href="motion.txt.html#is" class="d">is</a> equivalent to `b &lt;= a`. <span class="n">Note</span> that, in the absence of <a href="insert.txt.html#a" class="d">a</a> "le"
metamethod, <a href="lua.txt.html#Lua" class="d">Lua</a> tries the "lt"<a href="motion.txt.html#%2C" class="d">,</a> assuming that <a href="motion.txt.html#%60a" class="d">`a</a> &lt;= b` <a href="motion.txt.html#is" class="d">is</a> equivalent
to `not (b <a href="change.txt.html#%3C" class="d">&lt;</a> a)`.

"<a href="index.txt.html#index" class="d">index</a>"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                             <span id="__index%28%29" class="t">__index()</span>
<span class="h">--------</span>
The indexing access <span class="e">table[key]</span>.

<span class="e">       function gettable_event (table, key)</span>
<span class="e">         local h</span>
<span class="e">         if type(table) == "table" then</span>
<span class="e">           local v = rawget(table, key)</span>
<span class="e">           if v ~= nil then return v end</span>
<span class="e">           h = metatable(table).__index</span>
<span class="e">           if h == nil then return nil end</span>
<span class="e">         else</span>
<span class="e">           h = metatable(table).__index</span>
<span class="e">           if h == nil then</span>
<span class="e">             error(...);</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">         if type(h) == "function" then</span>
<span class="e">           return h(table, key)      -- call the handler</span>
<span class="e">         else return h[key]          -- or repeat operation on it</span>
<span class="e">       end</span>

"newindex"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                       <span id="__newindex%28%29" class="t">__newindex()</span>
<span class="h">-----------</span>
The indexing assignment `table[key] <a href="change.txt.html#%3D" class="d">=</a> value`.

<span class="e">       function settable_event (table, key, value)</span>
<span class="e">         local h</span>
<span class="e">         if type(table) == "table" then</span>
<span class="e">           local v = rawget(table, key)</span>
<span class="e">           if v ~= nil then rawset(table, key, value); return end</span>
<span class="e">           h = metatable(table).__newindex</span>
<span class="e">           if h == nil then rawset(table, key, value); return end</span>
<span class="e">         else</span>
<span class="e">           h = metatable(table).__newindex</span>
<span class="e">           if h == nil then</span>
<span class="e">             error(...);</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">         if type(h) == "function" then</span>
<span class="e">           return h(table, key,value)    -- call the handler</span>
<span class="e">         else h[key] = value             -- or repeat operation on it</span>
<span class="e">       end</span>

"call"<a href="cmdline.txt.html#%3A" class="d">:</a>                                                               <span id="__call%28%29" class="t">__call()</span>
<span class="h">-------</span>
called when <a href="lua.txt.html#Lua" class="d">Lua</a> calls <a href="insert.txt.html#a" class="d">a</a> value.

<span class="e">       function function_event (func, ...)</span>
<span class="e">         if type(func) == "function" then</span>
<span class="e">           return func(...)   -- primitive call</span>
<span class="e">         else</span>
<span class="e">           local h = metatable(func).__call</span>
<span class="e">           if h then</span>
<span class="e">             return h(func, ...)</span>
<span class="e">           else</span>
<span class="e">             error(...)</span>
<span class="e">           end</span>
<span class="e">         end</span>
<span class="e">       end</span>


<span class="h">==============================================================================</span>
2.9  Environments                               <span id="lua-environments" class="t">lua-environments</span>

Besides metatables, <a href="index.txt.html#objects" class="d">objects</a> of types thread, function, and <a href="luaref.txt.html#userdata" class="d">userdata</a> have
another table associated with them, called their environment. Like metatables,
environments are regular tables and multiple <a href="index.txt.html#objects" class="d">objects</a> can share the same
environment.

Environments associated with <a href="luaref.txt.html#userdata" class="d">userdata</a> have no meaning <a href="luaref.txt.html#for" class="d">for</a> Lua. It <a href="motion.txt.html#is" class="d">is</a> only <a href="insert.txt.html#a" class="d">a</a>
convenience feature <a href="luaref.txt.html#for" class="d">for</a> programmers to associate <a href="insert.txt.html#a" class="d">a</a> table to <a href="insert.txt.html#a" class="d">a</a> userdata.

Environments associated with threads are called global environments. They are
used <a href="motion.txt.html#as" class="d">as</a> the default environment <a href="luaref.txt.html#for" class="d">for</a> their threads and non-nested <a href="vimeval.txt.html#functions" class="d">functions</a>
created by the thread (through <a href="luaref.txt.html#loadfile%28%29" class="l">loadfile()</a><a href="motion.txt.html#%2C" class="d">,</a> <a href="luaref.txt.html#loadstring%28%29" class="l">loadstring()</a> or <a href="luaref.txt.html#load%28%29" class="l">load()</a><a href="motion.txt.html#%29" class="d">)</a> and
can be directly accessed by <a href="change.txt.html#C" class="d">C</a> code (see <a href="luaref.txt.html#lua-pseudoindex" class="l">lua-pseudoindex</a>).

Environments associated with <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#functions" class="d">functions</a> can be directly accessed by <a href="change.txt.html#C" class="d">C</a> code
(see <a href="luaref.txt.html#lua-pseudoindex" class="l">lua-pseudoindex</a>). They are used <a href="motion.txt.html#as" class="d">as</a> the default environment <a href="luaref.txt.html#for" class="d">for</a>
other <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#functions" class="d">functions</a> created by the function.

Environments associated with <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="vimeval.txt.html#functions" class="d">functions</a> are used to resolve all accesses to
global <a href="vimeval.txt.html#variables" class="d">variables</a> within the function (see <a href="luaref.txt.html#lua-variables" class="l">lua-variables</a>). They are
used <a href="motion.txt.html#as" class="d">as</a> the default environment <a href="luaref.txt.html#for" class="d">for</a> other <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="vimeval.txt.html#functions" class="d">functions</a> created by the
function.

You can change the environment of <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function or the running thread by
calling <span class="e">setfenv</span>. You can get the environment of <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function or the
running thread by calling <span class="e">getfenv</span> (see <a href="luaref.txt.html#lua_getfenv%28%29" class="l">lua_getfenv()</a>). To manipulate the
environment of other <a href="index.txt.html#objects" class="d">objects</a> (userdata, <a href="change.txt.html#C" class="d">C</a> functions, other threads) you must
use the <a href="change.txt.html#C" class="d">C</a> API.

<span class="h">==============================================================================</span>
2.10  Garbage Collection                                         <span id="lua-gc" class="t">lua-gc</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> performs automatic memory management. This means that you <a href="diff.txt.html#do" class="d">do</a> not have to
worry neither about allocating memory <a href="luaref.txt.html#for" class="d">for</a> new <a href="index.txt.html#objects" class="d">objects</a> nor about freeing <a href="motion.txt.html#it" class="d">it</a>
when the <a href="index.txt.html#objects" class="d">objects</a> are no longer needed. <a href="lua.txt.html#Lua" class="d">Lua</a> manages memory automatically by
running <a href="insert.txt.html#a" class="d">a</a> garbage collector from time to time to collect all dead <a href="index.txt.html#objects" class="d">objects</a>
(that is, these <a href="index.txt.html#objects" class="d">objects</a> that are no longer accessible from Lua). All <a href="index.txt.html#objects" class="d">objects</a>
in <a href="lua.txt.html#Lua" class="d">Lua</a> are subject to automatic management: tables, userdata, functions,
threads, and strings.

<a href="lua.txt.html#Lua" class="d">Lua</a> implements an incremental mark-and-sweep collector. It uses two numbers to
<a href="intro.txt.html#control" class="d">control</a> its garbage-collection cycles: the garbage-collector pause and the
garbage-collector step multiplier.

The garbage-collector pause controls how long the collector waits before
<a href="starting.txt.html#starting" class="d">starting</a> <a href="insert.txt.html#a" class="d">a</a> new cycle. Larger values make the collector <a href="various.txt.html#less" class="d">less</a> aggressive. Values
smaller than 1 mean the collector will not wait to start <a href="insert.txt.html#a" class="d">a</a> new cycle. <a href="insert.txt.html#A" class="d">A</a> value
of 2 means that the collector waits <a href="luaref.txt.html#for" class="d">for</a> the total memory in use to double
before <a href="starting.txt.html#starting" class="d">starting</a> <a href="insert.txt.html#a" class="d">a</a> new cycle.

The step multiplier controls the relative speed of the collector relative to
memory allocation. Larger values make the collector more aggressive but also
increase the size of each incremental step. Values smaller than 1 make the
collector too slow and may result in the collector never finishing <a href="insert.txt.html#a" class="d">a</a> cycle.
The default, 2, means that the collector runs <a href="motion.txt.html#at" class="d">at</a> "twice" the speed of memory
allocation.

You can change these numbers by calling <span class="e">lua_gc</span> (see <a href="luaref.txt.html#lua_gc%28%29" class="l">lua_gc()</a><a href="motion.txt.html#%29" class="d">)</a> in <a href="change.txt.html#C" class="d">C</a> or
<span class="e">collectgarbage</span> (see <a href="luaref.txt.html#collectgarbage%28%29" class="l">collectgarbage()</a><a href="motion.txt.html#%29" class="d">)</a> in Lua. Both get percentage points
<a href="motion.txt.html#as" class="d">as</a> arguments (so an argument of 100 means <a href="insert.txt.html#a" class="d">a</a> real value of 1). With these
<a href="vimeval.txt.html#functions" class="d">functions</a> you can also <a href="intro.txt.html#control" class="d">control</a> the collector directly (e.g., stop and restart
it).

<span class="h">------------------------------------------------------------------------------</span>
2.10.1  Garbage-Collection Metamethods                       <span id="lua-gc-meta" class="t">lua-gc-meta</span>

Using the <a href="change.txt.html#C" class="d">C</a> API, you can set garbage-collector metamethods <a href="luaref.txt.html#for" class="d">for</a> <a href="luaref.txt.html#userdata" class="d">userdata</a> (see
<a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>). These metamethods are also called finalizers.
Finalizers allow you to coordinate Lua's garbage collection with external
resource management (such <a href="motion.txt.html#as" class="d">as</a> closing files, network or database connections,
or freeing your own memory).

                                                                          <span id="__gc" class="t">__gc</span>
Garbage <a href="luaref.txt.html#userdata" class="d">userdata</a> with <a href="insert.txt.html#a" class="d">a</a> field <span class="e">__gc</span> in their metatables are not collected
immediately by the garbage collector. Instead, <a href="lua.txt.html#Lua" class="d">Lua</a> puts them in <a href="insert.txt.html#a" class="d">a</a> list. After
the collection, <a href="lua.txt.html#Lua" class="d">Lua</a> does the equivalent of the following function <a href="luaref.txt.html#for" class="d">for</a> each
<a href="luaref.txt.html#userdata" class="d">userdata</a> in that list:

<span class="e">       function gc_event (udata)</span>
<span class="e">         local h = metatable(udata).__gc</span>
<span class="e">         if h then</span>
<span class="e">           h(udata)</span>
<span class="e">         end</span>
<span class="e">       end</span>

At the <a href="intro.txt.html#end" class="d">end</a> of each garbage-collection cycle, the finalizers <a href="luaref.txt.html#for" class="d">for</a> <a href="luaref.txt.html#userdata" class="d">userdata</a> are
called in reverse order of their creation, among these collected in that
cycle. That is, the first finalizer to be called <a href="motion.txt.html#is" class="d">is</a> the one associated with
the <a href="luaref.txt.html#userdata" class="d">userdata</a> created last in the program.

<span class="h">------------------------------------------------------------------------------</span>
2.10.2 <a href="motion.txt.html#-" class="d">-</a> Weak Tables                            <span id="lua-weaktable" class="t">lua-weaktable</span>

<a href="insert.txt.html#A" class="d">A</a> weak table <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> table whose elements are weak references. <a href="insert.txt.html#A" class="d">A</a> weak <a href="intro.txt.html#reference" class="d">reference</a>
<a href="motion.txt.html#is" class="d">is</a> ignored by the garbage collector. In other words, if the only references to
an object are weak references, then the garbage collector will collect this
object.

                                                                        <span id="__mode" class="t">__mode</span>
<a href="insert.txt.html#A" class="d">A</a> weak table can have weak keys, weak values, or both. <a href="insert.txt.html#A" class="d">A</a> table with weak keys
allows the collection of its keys, but prevents the collection of its values.
<a href="insert.txt.html#A" class="d">A</a> table with both weak keys and weak values allows the collection of both keys
and values. In any case, if either the key or the value <a href="motion.txt.html#is" class="d">is</a> collected, the
whole pair <a href="motion.txt.html#is" class="d">is</a> removed from the table. The weakness of <a href="insert.txt.html#a" class="d">a</a> table <a href="motion.txt.html#is" class="d">is</a> controlled by
the value of the <span class="e">__mode</span> field of its metatable. If the <span class="e">__mode</span> field <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a>
<a href="vimeval.txt.html#string" class="d">string</a> containing the character <span class="e">k</span>, the keys in the table are weak.
If <span class="e">__mode</span> contains <span class="e">v</span>, the values in the table are weak.

After you use <a href="insert.txt.html#a" class="d">a</a> table <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> metatable, you should not change the value of its
field <span class="e">__mode</span>. Otherwise, the weak behavior of the tables controlled by this
<a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="motion.txt.html#is" class="d">is</a> undefined.

<span class="h">==============================================================================</span>
2.11  Coroutines                                <span id="lua-coroutine" class="t">lua-coroutine</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> supports coroutines, also called collaborative multithreading. <a href="insert.txt.html#A" class="d">A</a> coroutine
in <a href="lua.txt.html#Lua" class="d">Lua</a> represents an independent thread of execution. Unlike threads in
multithread systems, however, <a href="insert.txt.html#a" class="d">a</a> coroutine only suspends its execution by
explicitly calling <a href="insert.txt.html#a" class="d">a</a> yield function.

You create <a href="insert.txt.html#a" class="d">a</a> coroutine with <a href="insert.txt.html#a" class="d">a</a> call to <span class="e">coroutine.create</span> (see
<a href="luaref.txt.html#coroutine.create%28%29" class="l">coroutine.create()</a>). Its sole argument <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> function that <a href="motion.txt.html#is" class="d">is</a> the main
function of the coroutine. The <span class="e">create</span> function only creates <a href="insert.txt.html#a" class="d">a</a> new coroutine
and returns <a href="insert.txt.html#a" class="d">a</a> handle to <a href="motion.txt.html#it" class="d">it</a> (an object of type <span class="e">thread</span>); <a href="motion.txt.html#it" class="d">it</a> does not start the
coroutine execution.

When you first call <span class="e">coroutine.resume</span> (see <a href="luaref.txt.html#coroutine.resume%28%29" class="l">coroutine.resume()</a>),
passing <a href="motion.txt.html#as" class="d">as</a> its first argument the thread returned by <span class="e">coroutine.create</span>, the
coroutine starts its execution, <a href="motion.txt.html#at" class="d">at</a> the first line of its main function. Extra
arguments passed to <span class="e">coroutine.resume</span> are passed on to the coroutine main
function. After the coroutine starts running, <a href="motion.txt.html#it" class="d">it</a> runs until <a href="motion.txt.html#it" class="d">it</a> terminates or
<span class="e">yields</span>.

<a href="insert.txt.html#A" class="d">A</a> coroutine can terminate its execution in two ways: normally, when its main
function returns (explicitly or implicitly, after the last instruction); and
abnormally, if there <a href="motion.txt.html#is" class="d">is</a> an unprotected error. In the first case,
<span class="e">coroutine.resume</span> returns <span class="e">true</span>, plus any values returned by the coroutine
main function. In <a href="change.txt.html#case" class="d">case</a> of errors, <span class="e">coroutine.resume</span> returns <span class="e">false</span> plus an
error message.

<a href="insert.txt.html#A" class="d">A</a> coroutine yields by calling <span class="e">coroutine.yield</span> (see
<a href="luaref.txt.html#coroutine.yield%28%29" class="l">coroutine.yield()</a>). When <a href="insert.txt.html#a" class="d">a</a> coroutine yields, the corresponding
<span class="e">coroutine.resume</span> returns immediately, even if the yield happens inside
nested function calls (that is, not in the main function, but in <a href="insert.txt.html#a" class="d">a</a> function
directly or indirectly called by the main function). In the <a href="change.txt.html#case" class="d">case</a> of <a href="insert.txt.html#a" class="d">a</a> yield,
<span class="e">coroutine.resume</span> also returns <span class="e">true</span>, plus any values passed to
<span class="e">coroutine.yield</span>. The next time you resume the same coroutine, <a href="motion.txt.html#it" class="d">it</a> continues
its execution from the point where <a href="motion.txt.html#it" class="d">it</a> yielded, with the call to
<span class="e">coroutine.yield</span> returning any extra arguments passed to <span class="e">coroutine.resume</span>.

Like <span class="e">coroutine.create</span>, the <span class="e">coroutine.wrap</span> function (see
<a href="luaref.txt.html#coroutine.wrap%28%29" class="l">coroutine.wrap()</a><a href="motion.txt.html#%29" class="d">)</a> also creates <a href="insert.txt.html#a" class="d">a</a> coroutine, but instead of returning
the coroutine itself, <a href="motion.txt.html#it" class="d">it</a> returns <a href="insert.txt.html#a" class="d">a</a> function that, when called, resumes the
coroutine. Any arguments passed to this function <a href="motion.txt.html#go" class="d">go</a> <a href="motion.txt.html#as" class="d">as</a> extra arguments to
<span class="e">coroutine.resume</span>. <span class="e">coroutine.wrap</span> returns all the values returned by
<span class="e">coroutine.resume</span>, except the first one (the <a href="options.txt.html#boolean" class="d">boolean</a> error code). Unlike
<span class="e">coroutine.resume</span>, <span class="e">coroutine.wrap</span> does not catch errors; any error <a href="motion.txt.html#is" class="d">is</a>
propagated to the caller.

As an example, consider the next code:

<span class="e">       function foo1 (a)</span>
<span class="e">         print("foo", a)</span>
<span class="e">         return coroutine.yield(2*a)</span>
<span class="e">       end</span>
<span class="e"></span>
<span class="e">       co = coroutine.create(function (a,b)</span>
<span class="e">             print("co-body", a, b)</span>
<span class="e">             local r = foo1(a+1)</span>
<span class="e">             print("co-body", r)</span>
<span class="e">             local r, s = coroutine.yield(a+b, a-b)</span>
<span class="e">             print("co-body", r, s)</span>
<span class="e">             return b, "end"</span>
<span class="e">       end)</span>
<span class="e"></span>
<span class="e">       print("main", coroutine.resume(co, 1, 10))</span>
<span class="e">       print("main", coroutine.resume(co, "r"))</span>
<span class="e">       print("main", coroutine.resume(co, "x", "y"))</span>
<span class="e">       print("main", coroutine.resume(co, "x", "y"))</span>

When you run it, <a href="motion.txt.html#it" class="d">it</a> produces the following output:

<span class="e">       co-body 1       10</span>
<span class="e">       foo     2</span>
<span class="e">       main    true    4</span>
<span class="e">       co-body r</span>
<span class="e">       main    true    11      -9</span>
<span class="e">       co-body x       y</span>
<span class="e">       main    true    10      end</span>
<span class="e">       main    false   cannot resume dead coroutine</span>


<span class="h">==============================================================================</span>
3  THE APPLICATION PROGRAM INTERFACE                                <span id="lua-API" class="t">lua-API</span>

This <a href="motion.txt.html#section" class="d">section</a> describes the <a href="change.txt.html#C" class="d">C</a> <a href="api.txt.html#API" class="d">API</a> <a href="luaref.txt.html#for" class="d">for</a> Lua, that is, the set of <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#functions" class="d">functions</a>
available to the host program to communicate with Lua. All <a href="api.txt.html#API" class="d">API</a> <a href="vimeval.txt.html#functions" class="d">functions</a> and
related types and constants are declared in the header file <span class="e">lua.h</span>.

Even when we use the term "function"<a href="motion.txt.html#%2C" class="d">,</a> any facility in the <a href="api.txt.html#API" class="d">API</a> may be provided
<a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <span class="e">macro</span> instead. All such macros use each of its arguments exactly once
(except <a href="luaref.txt.html#for" class="d">for</a> the first argument, which <a href="motion.txt.html#is" class="d">is</a> always <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> state), and so <a href="diff.txt.html#do" class="d">do</a> not
generate hidden side-effects.

As in most <a href="change.txt.html#C" class="d">C</a> libraries, the <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="api.txt.html#API" class="d">API</a> <a href="vimeval.txt.html#functions" class="d">functions</a> <a href="diff.txt.html#do" class="d">do</a> not check their arguments <a href="luaref.txt.html#for" class="d">for</a>
validity or consistency. However, you can change this behavior by compiling
<a href="lua.txt.html#Lua" class="d">Lua</a> with <a href="insert.txt.html#a" class="d">a</a> proper definition <a href="luaref.txt.html#for" class="d">for</a> the <a href="repeat.txt.html#macro" class="d">macro</a> <span class="e">luai_apicheck</span>,in file
<span class="e">luaconf.h</span>.

<span class="h">==============================================================================</span>
3.1  The Stack                                    <span id="lua-stack" class="t">lua-stack</span> <span id="lua-apiStack" class="t">lua-apiStack</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> uses <a href="insert.txt.html#a" class="d">a</a> virtual stack to pass values to and from C. Each element in this
stack represents <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> value (`nil`, number, string, etc.).

Whenever <a href="lua.txt.html#Lua" class="d">Lua</a> calls C, the called function gets <a href="insert.txt.html#a" class="d">a</a> new stack, which <a href="motion.txt.html#is" class="d">is</a>
independent of previous stacks and of stacks of <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#functions" class="d">functions</a> that are still
active. This stack initially contains any arguments to the <a href="change.txt.html#C" class="d">C</a> function and <a href="motion.txt.html#it" class="d">it</a>
<a href="motion.txt.html#is" class="d">is</a> where the <a href="change.txt.html#C" class="d">C</a> function pushes its results to be returned to the caller (see
<a href="luaref.txt.html#lua_CFunction" class="l">lua_CFunction</a>).

                                                             <span id="lua-stackindex" class="t">lua-stackindex</span>
For convenience, most query operations in the <a href="api.txt.html#API" class="d">API</a> <a href="diff.txt.html#do" class="d">do</a> not follow <a href="insert.txt.html#a" class="d">a</a> strict stack
discipline. Instead, they can refer to any element in the stack by using an
index: <a href="insert.txt.html#a" class="d">a</a> positive <a href="index.txt.html#index" class="d">index</a> represents an absolute stack position (starting <a href="motion.txt.html#at" class="d">at</a> 1);
<a href="insert.txt.html#a" class="d">a</a> negative <a href="index.txt.html#index" class="d">index</a> represents an offset from the top of the stack. More
specifically, if the stack has <span class="e">n</span> elements, then <a href="index.txt.html#index" class="d">index</a> 1 represents the first
element (that is, the element that was pushed onto the stack first) and <a href="index.txt.html#index" class="d">index</a>
<span class="e">n</span> represents the last element; <a href="index.txt.html#index" class="d">index</a> <span class="e">-1</span> also represents the last element
(that is, the element <a href="motion.txt.html#at" class="d">at</a> the top) and <a href="index.txt.html#index" class="d">index</a> <span class="e">-n</span> represents the first element.
We say that an <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> valid if <a href="motion.txt.html#it" class="d">it</a> lies between 1 and the stack top (that is,
if `1 &lt;= abs(index) &lt;= top`).

<span class="h">==============================================================================</span>
3.2  Stack Size                                            <span id="lua-apiStackSize" class="t">lua-apiStackSize</span>

When you interact with <a href="lua.txt.html#Lua" class="d">Lua</a> API, you are responsible <a href="luaref.txt.html#for" class="d">for</a> ensuring consistency.
In particular, you are responsible <a href="luaref.txt.html#for" class="d">for</a> controlling stack overflow. You can
use the function <span class="e">lua_checkstack</span> to grow the stack size (see
<a href="luaref.txt.html#lua_checkstack%28%29" class="l">lua_checkstack()</a>).

Whenever <a href="lua.txt.html#Lua" class="d">Lua</a> calls C, <a href="motion.txt.html#it" class="d">it</a> ensures that <a href="motion.txt.html#at" class="d">at</a> least <span class="e">LUA_MINSTACK</span> stack positions
are available. <span class="e">LUA_MINSTACK</span> <a href="motion.txt.html#is" class="d">is</a> defined <a href="motion.txt.html#as" class="d">as</a> 20, so that usually you <a href="diff.txt.html#do" class="d">do</a> not
have to worry about stack <a href="intro.txt.html#space" class="d">space</a> unless your code has loops pushing elements
onto the stack.

Most query <a href="vimeval.txt.html#functions" class="d">functions</a> accept <a href="motion.txt.html#as" class="d">as</a> indices any value inside the available stack
space, that is, indices up to the maximum stack size you have set through
<span class="e">lua_checkstack</span>. Such indices are called acceptable indices. More formally,
we define an acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#as" class="d">as</a> follows:

<span class="e">    (index &lt; 0 &amp;&amp; abs(index) &lt;= top) || (index &gt; 0 &amp;&amp; index &lt;= stackspace)</span>

<span class="n">Note</span> that <a href="motion.txt.html#0" class="d">0</a> <a href="motion.txt.html#is" class="d">is</a> never an acceptable index.

<span class="h">==============================================================================</span>
3.3  Pseudo-Indices                                     <span id="lua-pseudoindex" class="t">lua-pseudoindex</span>

Unless otherwise noted, any function that accepts valid indices can also be
called with pseudo-indices, which represent some <a href="lua.txt.html#Lua" class="d">Lua</a> values that are
accessible to the <a href="change.txt.html#C" class="d">C</a> code but which are not in the stack. Pseudo-indices are
used to access the thread environment, the function environment, the registry,
and the upvalues of <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function (see <a href="luaref.txt.html#lua-cclosure" class="l">lua-cclosure</a>).

The thread environment (where global <a href="vimeval.txt.html#variables" class="d">variables</a> live) <a href="motion.txt.html#is" class="d">is</a> always <a href="motion.txt.html#at" class="d">at</a> pseudo-index
<span class="e">LUA_GLOBALSINDEX</span>. The environment of the running <a href="change.txt.html#C" class="d">C</a> function <a href="motion.txt.html#is" class="d">is</a> always <a href="motion.txt.html#at" class="d">at</a>
pseudo-index <span class="e">LUA_ENVIRONINDEX</span>.

To access and change the value of global variables, you can use regular table
operations over an environment table. For instance, to access the value of <a href="insert.txt.html#a" class="d">a</a>
global variable, <a href="diff.txt.html#do" class="d">do</a>
&gt;c
       lua_getfield(L, LUA_GLOBALSINDEX, varname);
<a href="change.txt.html#%3C" class="d">&lt;</a>

<span class="h">==============================================================================</span>
3.4  <a href="change.txt.html#C" class="d">C</a> Closures                                         <span id="lua-cclosure" class="t">lua-cclosure</span>

When <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function <a href="motion.txt.html#is" class="d">is</a> created, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> possible to associate some values with it,
thus creating <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> closure; these values are called upvalues and are accessible
to the function whenever <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> called (see <a href="luaref.txt.html#lua_pushcclosure%28%29" class="l">lua_pushcclosure()</a>).

Whenever <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function <a href="motion.txt.html#is" class="d">is</a> called, its upvalues are located <a href="motion.txt.html#at" class="d">at</a> specific
pseudo-indices. These pseudo-indices are produced by the <a href="repeat.txt.html#macro" class="d">macro</a>
<span class="e">lua_upvalueindex</span>. The first value associated with <a href="insert.txt.html#a" class="d">a</a> function <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#at" class="d">at</a> position
<span class="e">lua_upvalueindex(1)</span>, and so on. Any access to <span class="e">lua_upvalueindex(</span> <span class="e">n</span> <span class="e">)</span>,
where <span class="e">n</span> <a href="motion.txt.html#is" class="d">is</a> greater than the number of upvalues of the current function,
produces an acceptable (but invalid) index.

<span class="h">==============================================================================</span>
3.5  Registry                                           <span id="lua-registry" class="t">lua-registry</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> provides <a href="insert.txt.html#a" class="d">a</a> registry, <a href="insert.txt.html#a" class="d">a</a> pre-defined table that can be used by any <a href="change.txt.html#C" class="d">C</a> code to
store whatever <a href="lua.txt.html#Lua" class="d">Lua</a> value <a href="motion.txt.html#it" class="d">it</a> needs to store. This table <a href="motion.txt.html#is" class="d">is</a> always located <a href="motion.txt.html#at" class="d">at</a>
pseudo-index <span class="e">LUA_REGISTRYINDEX</span>. Any <a href="change.txt.html#C" class="d">C</a> library can store data into this
table, but <a href="motion.txt.html#it" class="d">it</a> should take care to choose keys different from those used by
other libraries, to avoid collisions. Typically, you should use <a href="motion.txt.html#as" class="d">as</a> key <a href="insert.txt.html#a" class="d">a</a>
<a href="vimeval.txt.html#string" class="d">string</a> containing your library name or <a href="insert.txt.html#a" class="d">a</a> light <a href="luaref.txt.html#userdata" class="d">userdata</a> with the address of <a href="insert.txt.html#a" class="d">a</a>
<a href="change.txt.html#C" class="d">C</a> object in your code.

The integer keys in the registry are used by the <a href="intro.txt.html#reference" class="d">reference</a> mechanism,
implemented by the auxiliary library, and therefore should not be used <a href="luaref.txt.html#for" class="d">for</a>
other purposes.

<span class="h">==============================================================================</span>
3.6  Error Handling in <a href="change.txt.html#C" class="d">C</a>                                <span id="lua-apiError" class="t">lua-apiError</span>

Internally, <a href="lua.txt.html#Lua" class="d">Lua</a> uses the <a href="change.txt.html#C" class="d">C</a> <span class="e">longjmp</span> facility to handle errors. (You can also
choose to use exceptions if you use C++; see file <span class="e">luaconf.h</span>.) When <a href="lua.txt.html#Lua" class="d">Lua</a> faces
any error (such <a href="motion.txt.html#as" class="d">as</a> memory allocation errors, type errors, <a href="syntax.txt.html#syntax" class="d">syntax</a> errors, and
runtime errors) <a href="motion.txt.html#it" class="d">it</a> raises an error; that is, <a href="motion.txt.html#it" class="d">it</a> does <a href="insert.txt.html#a" class="d">a</a> long jump. <a href="insert.txt.html#A" class="d">A</a> protected
environment uses <span class="e">setjmp</span> to set <a href="insert.txt.html#a" class="d">a</a> recover point; any error jumps to the most
recent active recover point.

Almost any function in the <a href="api.txt.html#API" class="d">API</a> may raise an error, <a href="luaref.txt.html#for" class="d">for</a> instance due to <a href="insert.txt.html#a" class="d">a</a>
memory allocation error. The following <a href="vimeval.txt.html#functions" class="d">functions</a> run in protected mode (that
is, they create <a href="insert.txt.html#a" class="d">a</a> protected environment to run), so they never raise an error:
<span class="e">lua_newstate</span>, <span class="e">lua_close</span>, <span class="e">lua_load</span>, <span class="e">lua_pcall</span>, and <span class="e">lua_cpcall</span> (see
<a href="luaref.txt.html#lua_newstate%28%29" class="l">lua_newstate()</a><a href="motion.txt.html#%2C" class="d">,</a> <a href="luaref.txt.html#lua_close%28%29" class="l">lua_close()</a><a href="motion.txt.html#%2C" class="d">,</a> <a href="luaref.txt.html#lua_load%28%29" class="l">lua_load()</a><a href="motion.txt.html#%2C" class="d">,</a>
<a href="luaref.txt.html#lua_pcall%28%29" class="l">lua_pcall()</a><a href="motion.txt.html#%2C" class="d">,</a> and <a href="luaref.txt.html#lua_cpcall%28%29" class="l">lua_cpcall()</a>).

Inside <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function you can raise an error by calling <span class="e">lua_error</span>  (see
<a href="luaref.txt.html#lua_error%28%29" class="l">lua_error()</a>).

<span class="h">==============================================================================</span>
3.7  Functions and Types                                   <span id="lua-apiFunctions" class="t">lua-apiFunctions</span>

Here we <a href="vimeval.txt.html#list" class="d">list</a> all <a href="vimeval.txt.html#functions" class="d">functions</a> and types from the <a href="change.txt.html#C" class="d">C</a> <a href="api.txt.html#API" class="d">API</a> in alphabetical order.

<a href="luaref.txt.html#lua_Alloc" class="d">lua_Alloc</a>                                                            <span id="lua_Alloc" class="t">lua_Alloc</span>
&gt;c
    typedef void * <a href="motion.txt.html#%28" class="d">(</a>*lua_Alloc) (void *ud,
                                 void *ptr,
                                 size_t osize,
                                 size_t nsize);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        The type of the memory-allocation function used by <a href="lua.txt.html#Lua" class="d">Lua</a> states. The
        allocator function must provide <a href="insert.txt.html#a" class="d">a</a> functionality similar to <span class="e">realloc</span>,
        but not exactly the same. Its arguments are <span class="e">ud</span>, an opaque pointer
        passed to <span class="e">lua_newstate</span> (see <a href="luaref.txt.html#lua_newstate%28%29" class="l">lua_newstate()</a>); <span class="e">ptr</span>, <a href="insert.txt.html#a" class="d">a</a> pointer
        to the block being allocated/reallocated/freed; <span class="e">osize</span>, the original
        size of the block; <span class="e">nsize</span>, the new size of the block. <span class="e">ptr</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">NULL</span>
        if and only if <span class="e">osize</span> <a href="motion.txt.html#is" class="d">is</a> zero. When <span class="e">nsize</span> <a href="motion.txt.html#is" class="d">is</a> zero, the allocator
        must return <span class="e">NULL</span>; if <span class="e">osize</span> <a href="motion.txt.html#is" class="d">is</a> not zero, <a href="motion.txt.html#it" class="d">it</a> should free the block
        pointed to by <span class="e">ptr</span>. When <span class="e">nsize</span> <a href="motion.txt.html#is" class="d">is</a> not zero, the allocator returns
        <span class="e">NULL</span> if and only if <a href="motion.txt.html#it" class="d">it</a> cannot fill the request. When <span class="e">nsize</span> <a href="motion.txt.html#is" class="d">is</a> not
        zero and <span class="e">osize</span> <a href="motion.txt.html#is" class="d">is</a> zero, the allocator should behave like <span class="e">malloc</span>.
        When <span class="e">nsize</span> and <span class="e">osize</span> are not zero, the allocator behaves like
        <span class="e">realloc</span>. <a href="lua.txt.html#Lua" class="d">Lua</a> assumes that the allocator never fails when `osize &gt;=
        nsize`.

        Here <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> simple implementation <a href="luaref.txt.html#for" class="d">for</a> the allocator function. It <a href="motion.txt.html#is" class="d">is</a> used
        in the auxiliary library by <span class="e">luaL_newstate</span> (see
        <a href="luaref.txt.html#luaL_newstate%28%29" class="l">luaL_newstate()</a>).
&gt;c
            static void *l_alloc (void *ud, void *ptr, size_t osize,
                                                       size_t nsize) <a href="motion.txt.html#%7B" class="d">{</a>
              (void)ud;  (void)osize;  <a href="pattern.txt.html#%2F" class="d">/</a>* not used *<a href="pattern.txt.html#%2F" class="d">/</a>
              if (nsize <a href="change.txt.html#%3D%3D" class="d">==</a> 0) <a href="motion.txt.html#%7B" class="d">{</a>
                free(ptr);
                return NULL;
              <a href="motion.txt.html#%7D" class="d">}</a>
              else
                return realloc(ptr, nsize);
            <a href="motion.txt.html#%7D" class="d">}</a>
<a href="change.txt.html#%3C" class="d">&lt;</a>
        This code assumes that <span class="e">free(NULL)</span> has no effect and that
        `realloc(NULL, size)` <a href="motion.txt.html#is" class="d">is</a> equivalent to <span class="e">malloc(size)</span>. ANSI <a href="change.txt.html#C" class="d">C</a> ensures both
        behaviors.

lua_atpanic                                                      <span id="lua_atpanic%28%29" class="t">lua_atpanic()</span>
&gt;c
    <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> lua_atpanic (lua_State *L, <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> panicf);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Sets <a href="insert.txt.html#a" class="d">a</a> new panic function and returns the old one.

        If an error happens outside any protected environment, <a href="lua.txt.html#Lua" class="d">Lua</a> calls <a href="insert.txt.html#a" class="d">a</a>
        <span class="e">panic</span> <span class="e">function</span> and then calls <span class="e">exit(EXIT_FAILURE)</span>, thus <a href="starting.txt.html#exiting" class="d">exiting</a>
        the host application. Your panic function may avoid this exit by never
        returning (e.g., doing <a href="insert.txt.html#a" class="d">a</a> long jump).

        The panic function can access the error message <a href="motion.txt.html#at" class="d">at</a> the top of the
        stack.

lua_call                                                            <span id="lua_call%28%29" class="t">lua_call()</span>
&gt;c
    void lua_call (lua_State *L, int nargs, int nresults);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Calls <a href="insert.txt.html#a" class="d">a</a> function.

        To call <a href="insert.txt.html#a" class="d">a</a> function you must use the following protocol: first, the
        function to be called <a href="motion.txt.html#is" class="d">is</a> pushed onto the stack; then, the arguments to
        the function are pushed in direct order; that is, the first argument
        <a href="motion.txt.html#is" class="d">is</a> pushed first. Finally you call <span class="e">lua_call</span>; <span class="e">nargs</span> <a href="motion.txt.html#is" class="d">is</a> the number of
        arguments that you pushed onto the stack. All arguments and the
        function value are popped from the stack when the function <a href="motion.txt.html#is" class="d">is</a> called.
        The function results are pushed onto the stack when the function
        returns. The number of results <a href="motion.txt.html#is" class="d">is</a> adjusted to <span class="e">nresults</span>, unless
        <span class="e">nresults</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">LUA_MULTRET</span>. In this case, <span class="e">all</span> results from the
        function are pushed. <a href="lua.txt.html#Lua" class="d">Lua</a> takes care that the returned values fit into
        the stack space. The function results are pushed onto the stack in
        direct order (the first result <a href="motion.txt.html#is" class="d">is</a> pushed first), so that after the
        call the last result <a href="motion.txt.html#is" class="d">is</a> on the top of the stack.

        Any error inside the called function <a href="motion.txt.html#is" class="d">is</a> propagated upwards (with <a href="insert.txt.html#a" class="d">a</a>
        <span class="e">longjmp</span>).

        The following example shows how the host program may <a href="diff.txt.html#do" class="d">do</a> the equivalent
        to this <a href="lua.txt.html#Lua" class="d">Lua</a> code:

<span class="e">            a = f("how", t.x, 14)</span>

        Here <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> in C:
&gt;c
            lua_getfield(L, LUA_GLOBALSINDEX, "<a href="motion.txt.html#f" class="d">f</a>"); // function to be called
            lua_pushstring(L, "how");                        // 1st argument
            lua_getfield(L, LUA_GLOBALSINDEX, "<a href="motion.txt.html#t" class="d">t</a>");   // table to be indexed
            lua_getfield(L, -1, "<a href="change.txt.html#x" class="d">x</a>");        // push result of t.x (2nd arg)
            lua_remove(L, -2);                  // remove 't' from the stack
            lua_pushinteger(L, 14);                          // 3rd argument
            lua_call(L, 3, 1);     // call 'f' with 3 arguments and 1 result
            lua_setfield(L, LUA_GLOBALSINDEX, "<a href="insert.txt.html#a" class="d">a</a>");        // set global 'a'
<a href="change.txt.html#%3C" class="d">&lt;</a>
        <span class="n">Note</span> that the code above <a href="motion.txt.html#is" class="d">is</a> "balanced"<a href="cmdline.txt.html#%3A" class="d">:</a> <a href="motion.txt.html#at" class="d">at</a> its end, the stack <a href="motion.txt.html#is" class="d">is</a> back
        to its original configuration. This <a href="motion.txt.html#is" class="d">is</a> considered good programming
        practice.

<a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a>                                   <span id="lua-cfunction" class="t">lua-cfunction</span> <span id="lua_CFunction" class="t">lua_CFunction</span>
&gt;c
    typedef int <a href="motion.txt.html#%28" class="d">(</a>*lua_CFunction) (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Type <a href="luaref.txt.html#for" class="d">for</a> <a href="change.txt.html#C" class="d">C</a> functions.

        In order to communicate properly with Lua, <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function must use the
        following protocol, which defines the way parameters and results are
        passed: <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function receives its arguments from <a href="lua.txt.html#Lua" class="d">Lua</a> in its stack in
        direct order (the first argument <a href="motion.txt.html#is" class="d">is</a> pushed first). So, when the
        function starts, <span class="e">lua_gettop(L)</span> (see <a href="luaref.txt.html#lua_gettop%28%29" class="l">lua_gettop()</a><a href="motion.txt.html#%29" class="d">)</a> returns the
        number of arguments received by the function. The first argument (if
        any) <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> 1 and its last argument <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> <span class="e">lua_gettop(L)</span>.
        To return values to Lua, <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function just pushes them onto the stack,
        in direct order (the first result <a href="motion.txt.html#is" class="d">is</a> pushed first), and returns the
        number of results. Any other value in the stack below the results will
        be properly discarded by Lua. Like <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function, <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function called
        by <a href="lua.txt.html#Lua" class="d">Lua</a> can also return many results.

                                                       <span id="lua-cfunctionexample" class="t">lua-cfunctionexample</span>
        As an example, the following function receives <a href="insert.txt.html#a" class="d">a</a> variable number of
        numerical arguments and returns their average and sum:
&gt;c
            static int foo (lua_State *L) <a href="motion.txt.html#%7B" class="d">{</a>
              int <a href="pattern.txt.html#n" class="d">n</a> <a href="change.txt.html#%3D" class="d">=</a> lua_gettop(L);    <a href="pattern.txt.html#%2F" class="d">/</a>* number of arguments *<a href="pattern.txt.html#%2F" class="d">/</a>
              <a href="luaref.txt.html#lua_Number" class="d">lua_Number</a> sum <a href="change.txt.html#%3D" class="d">=</a> 0;
              int i;
              <a href="luaref.txt.html#for" class="d">for</a> (i <a href="change.txt.html#%3D" class="d">=</a> 1; <a href="insert.txt.html#i" class="d">i</a> &amp;lt;= n; i++) <a href="motion.txt.html#%7B" class="d">{</a>
                if (!lua_isnumber(L, i)) <a href="motion.txt.html#%7B" class="d">{</a>
                  lua_pushstring(L, "incorrect argument");
                  lua_error(L);
                <a href="motion.txt.html#%7D" class="d">}</a>
                sum += lua_tonumber(L, i);
              <a href="motion.txt.html#%7D" class="d">}</a>
              lua_pushnumber(L, sum/n); <a href="pattern.txt.html#%2F" class="d">/</a>* first result *<a href="pattern.txt.html#%2F" class="d">/</a>
              lua_pushnumber(L, sum);   <a href="pattern.txt.html#%2F" class="d">/</a>* second result *<a href="pattern.txt.html#%2F" class="d">/</a>
              return 2;                 <a href="pattern.txt.html#%2F" class="d">/</a>* number of results *<a href="pattern.txt.html#%2F" class="d">/</a>
            <a href="motion.txt.html#%7D" class="d">}</a>
<a href="change.txt.html#%3C" class="d">&lt;</a>

lua_checkstack                                                <span id="lua_checkstack%28%29" class="t">lua_checkstack()</span>
&gt;c
    int lua_checkstack (lua_State *L, int extra);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Ensures that there are <a href="motion.txt.html#at" class="d">at</a> least <span class="e">extra</span> free stack slots in the stack.
        It returns false if <a href="motion.txt.html#it" class="d">it</a> cannot grow the stack to that size. This
        function never shrinks the stack; if the stack <a href="motion.txt.html#is" class="d">is</a> already larger than
        the new size, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> left unchanged.

lua_close                                                          <span id="lua_close%28%29" class="t">lua_close()</span>
&gt;c
    void lua_close (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Destroys all <a href="index.txt.html#objects" class="d">objects</a> in the given <a href="lua.txt.html#Lua" class="d">Lua</a> state (calling the corresponding
        garbage-collection metamethods, if any) and frees all dynamic memory
        used by this state. On several platforms, you may not need to call
        this function, because all <a href="intro.txt.html#resources" class="d">resources</a> are naturally released when the
        host program ends. On the other hand, long-running programs, such <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a>
        daemon or <a href="insert.txt.html#a" class="d">a</a> web server, might need to release states <a href="motion.txt.html#as" class="d">as</a> soon <a href="motion.txt.html#as" class="d">as</a> they
        are not needed, to avoid growing too large.

lua_concat                                                        <span id="lua_concat%28%29" class="t">lua_concat()</span>
&gt;c
    void lua_concat (lua_State *L, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Concatenates the <span class="e">n</span> values <a href="motion.txt.html#at" class="d">at</a> the top of the stack, pops them, and
        leaves the result <a href="motion.txt.html#at" class="d">at</a> the top. If <span class="e">n</span> <a href="motion.txt.html#is" class="d">is</a> 1, the result <a href="motion.txt.html#is" class="d">is</a> the single
        <a href="vimeval.txt.html#string" class="d">string</a> on the stack (that is, the function does nothing); if <span class="e">n</span> <a href="motion.txt.html#is" class="d">is</a> 0,
        the result <a href="motion.txt.html#is" class="d">is</a> the empty string. Concatenation <a href="motion.txt.html#is" class="d">is</a> done following the
        usual semantics of <a href="lua.txt.html#Lua" class="d">Lua</a> (see <a href="luaref.txt.html#lua-concat" class="l">lua-concat</a>).

lua_cpcall                                                        <span id="lua_cpcall%28%29" class="t">lua_cpcall()</span>
&gt;c
    int lua_cpcall (lua_State *L, <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> func, void *ud);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Calls the <a href="change.txt.html#C" class="d">C</a> function <span class="e">func</span> in protected mode. <span class="e">func</span> starts with only
        one element in its stack, <a href="insert.txt.html#a" class="d">a</a> light <a href="luaref.txt.html#userdata" class="d">userdata</a> containing <span class="e">ud</span>. In <a href="change.txt.html#case" class="d">case</a> of
        errors, <span class="e">lua_cpcall</span> returns the same error codes <a href="motion.txt.html#as" class="d">as</a> <span class="e">lua_pcall</span> (see
        <a href="luaref.txt.html#lua_pcall%28%29" class="l">lua_pcall()</a>), plus the error object on the top of the stack;
        otherwise, <a href="motion.txt.html#it" class="d">it</a> returns zero, and does not change the stack. All values
        returned by <span class="e">func</span> are discarded.

lua_createtable                                              <span id="lua_createtable%28%29" class="t">lua_createtable()</span>
&gt;c
    void lua_createtable (lua_State *L, int narr, int nrec);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Creates <a href="insert.txt.html#a" class="d">a</a> new empty table and pushes <a href="motion.txt.html#it" class="d">it</a> onto the stack. The new table
        has <a href="intro.txt.html#space" class="d">space</a> pre-allocated <a href="luaref.txt.html#for" class="d">for</a> <span class="e">narr</span> array elements and <span class="e">nrec</span> non-array
        elements. This pre-allocation <a href="motion.txt.html#is" class="d">is</a> useful when you know exactly how many
        elements the table will have. Otherwise you can use the function
        <span class="e">lua_newtable</span>  (see <a href="luaref.txt.html#lua_newtable%28%29" class="l">lua_newtable()</a>).

lua_dump                                                            <span id="lua_dump%28%29" class="t">lua_dump()</span>
&gt;c
    int lua_dump (lua_State *L, <a href="luaref.txt.html#lua_Writer" class="d">lua_Writer</a> writer, void *data);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Dumps <a href="insert.txt.html#a" class="d">a</a> function <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> binary chunk. Receives <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function on the top
        of the stack and produces <a href="insert.txt.html#a" class="d">a</a> binary chunk that, if loaded again,
        results in <a href="insert.txt.html#a" class="d">a</a> function equivalent to the one dumped. As <a href="motion.txt.html#it" class="d">it</a> produces
        parts of the chunk, <span class="e">lua_dump</span> calls function <span class="e">writer</span> (see
        <a href="luaref.txt.html#lua_Writer" class="l">lua_Writer</a><a href="motion.txt.html#%29" class="d">)</a> with the given <span class="e">data</span> to write them.

        The value returned <a href="motion.txt.html#is" class="d">is</a> the error code returned by the last call to the
        writer; <a href="motion.txt.html#0" class="d">0</a> means no errors.

        This function does not pop the <a href="lua.txt.html#Lua" class="d">Lua</a> function from the stack.

lua_equal                                                          <span id="lua_equal%28%29" class="t">lua_equal()</span>
&gt;c
    int lua_equal (lua_State *L, int index1, int index2);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the two values in acceptable indices <span class="e">index1</span> and
        <span class="e">index2</span> are equal, following the semantics of the <a href="lua.txt.html#Lua" class="d">Lua</a> <span class="e">==</span> <a href="motion.txt.html#operator" class="d">operator</a>
        (that is, may call metamethods). Otherwise returns 0. Also returns <a href="motion.txt.html#0" class="d">0</a>
        if any of the indices <a href="motion.txt.html#is" class="d">is</a> non valid.

lua_error                                                          <span id="lua_error%28%29" class="t">lua_error()</span>
&gt;c
    int lua_error (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Generates <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> error. The error message (which can actually be <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a>
        value of any type) must be on the stack top. This function does <a href="insert.txt.html#a" class="d">a</a> long
        jump, and therefore never returns (see <a href="luaref.txt.html#luaL_error%28%29" class="l">luaL_error()</a>).

lua_gc                                                                <span id="lua_gc%28%29" class="t">lua_gc()</span>
&gt;c
    int lua_gc (lua_State *L, int what, int data);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Controls the garbage collector.

        This function performs several tasks, according to the value of the
        parameter <span class="e">what</span>:

        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCSTOP</span>      stops the garbage collector.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCRESTART</span>   restarts the garbage collector.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCCOLLECT</span>   performs <a href="insert.txt.html#a" class="d">a</a> full garbage-collection cycle.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCCOUNT</span>     returns the current amount of memory (in Kbytes) in
                          use by Lua.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCCOUNTB</span>    returns the remainder of dividing the current
                          amount of bytes of memory in use by <a href="lua.txt.html#Lua" class="d">Lua</a> by 1024.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCSTEP</span>      performs an incremental step of garbage collection.
                          The step "size" <a href="motion.txt.html#is" class="d">is</a> controlled by <span class="e">data</span> (larger
                          values mean more steps) in <a href="insert.txt.html#a" class="d">a</a> non-specified way. If
                          you want to <a href="intro.txt.html#control" class="d">control</a> the step size you must
                          experimentally tune the value of <span class="e">data</span>. The
                          function returns 1 if the step finished <a href="insert.txt.html#a" class="d">a</a>
                          garbage-collection cycle.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCSETPAUSE</span>  sets <span class="e">data</span> /100 <a href="motion.txt.html#as" class="d">as</a> the new value <a href="luaref.txt.html#for" class="d">for</a> the
                          <span class="e">pause</span> of the collector (see <a href="luaref.txt.html#lua-gc" class="l">lua-gc</a>).
                          The function returns the previous value of the
                          pause.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_GCSETSTEPMUL</span>sets <span class="e">data</span> /100 <a href="motion.txt.html#as" class="d">as</a> the new value <a href="luaref.txt.html#for" class="d">for</a> the
                          <span class="e">step</span> <span class="e">multiplier</span>  of the collector (see
                          <a href="luaref.txt.html#lua-gc" class="l">lua-gc</a>). The function returns the
                          previous value of the step multiplier.

lua_getallocf                                                  <span id="lua_getallocf%28%29" class="t">lua_getallocf()</span>
&gt;c
    <a href="luaref.txt.html#lua_Alloc" class="d">lua_Alloc</a> lua_getallocf (lua_State *L, void **ud);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the memory-allocation function of <a href="insert.txt.html#a" class="d">a</a> given state. If <span class="e">ud</span> <a href="motion.txt.html#is" class="d">is</a>
        not <span class="e">NULL</span>, <a href="lua.txt.html#Lua" class="d">Lua</a> stores in <span class="e">*ud</span> the opaque pointer passed to
        <span class="e">lua_newstate</span> (see <a href="luaref.txt.html#lua_newstate%28%29" class="l">lua_newstate()</a>).

lua_getfenv                                                      <span id="lua_getfenv%28%29" class="t">lua_getfenv()</span>
&gt;c
    void lua_getfenv (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the environment table of the value <a href="motion.txt.html#at" class="d">at</a> the given
        index.

lua_getfield                                                    <span id="lua_getfield%28%29" class="t">lua_getfield()</span>
&gt;c
    void lua_getfield (lua_State *L, int index, const char *k);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the value <span class="e">t[k]</span>, where <span class="e">t</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the
        given valid <a href="index.txt.html#index" class="d">index</a> <span class="e">index</span>. As in Lua, this function may trigger <a href="insert.txt.html#a" class="d">a</a>
        metamethod <a href="luaref.txt.html#for" class="d">for</a> the "<a href="index.txt.html#index" class="d">index</a>" event (see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

lua_getglobal                                                  <span id="lua_getglobal%28%29" class="t">lua_getglobal()</span>
&gt;c
    void lua_getglobal (lua_State *L, const char *name);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the value of the global <span class="e">name</span>. It <a href="motion.txt.html#is" class="d">is</a> defined <a href="motion.txt.html#as" class="d">as</a>
        <a href="insert.txt.html#a" class="d">a</a> macro:
&gt;c
            #define lua_getglobal(L,s)  lua_getfield(L, LUA_GLOBALSINDEX, s)
<a href="change.txt.html#%3C" class="d">&lt;</a>

lua_getmetatable                                            <span id="lua_getmetatable%28%29" class="t">lua_getmetatable()</span>
&gt;c
    int lua_getmetatable (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the <a href="luaref.txt.html#metatable" class="d">metatable</a> of the value <a href="motion.txt.html#at" class="d">at</a> the given
        acceptable index. If the <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> not valid, or if the value does not
        have <a href="insert.txt.html#a" class="d">a</a> metatable, the function returns <a href="motion.txt.html#0" class="d">0</a> and pushes nothing on the
        stack.

lua_gettable                                                    <span id="lua_gettable%28%29" class="t">lua_gettable()</span>
&gt;c
    void lua_gettable (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the value <span class="e">t[k]</span>, where <span class="e">t</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the
        given valid <a href="index.txt.html#index" class="d">index</a> <span class="e">index</span> and <span class="e">k</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the top of the
        stack.

        This function pops the key from the stack (putting the resulting value
        in its place). As in Lua, this function may trigger <a href="insert.txt.html#a" class="d">a</a> metamethod <a href="luaref.txt.html#for" class="d">for</a>
        the "<a href="index.txt.html#index" class="d">index</a>" event (see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

lua_gettop                                                        <span id="lua_gettop%28%29" class="t">lua_gettop()</span>
&gt;c
    int lua_gettop (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the <a href="index.txt.html#index" class="d">index</a> of the top element in the stack. Because indices
        start <a href="motion.txt.html#at" class="d">at</a> 1, this result <a href="motion.txt.html#is" class="d">is</a> equal to the number of elements in the
        stack (and so
        <a href="motion.txt.html#0" class="d">0</a> means an empty stack).

lua_insert                                                        <span id="lua_insert%28%29" class="t">lua_insert()</span>
&gt;c
    void lua_insert (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Moves the top element into the given valid index, shifting up the
        elements above this <a href="index.txt.html#index" class="d">index</a> to open space. Cannot be called with <a href="insert.txt.html#a" class="d">a</a>
        pseudo-index, because <a href="insert.txt.html#a" class="d">a</a> pseudo-index <a href="motion.txt.html#is" class="d">is</a> not an actual stack position.

<a href="luaref.txt.html#lua_Integer" class="d">lua_Integer</a>                                                        <span id="lua_Integer" class="t">lua_Integer</span>
&gt;c
    typedef ptrdiff_t lua_Integer;
<a href="change.txt.html#%3C" class="d">&lt;</a>
        The type used by the <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="api.txt.html#API" class="d">API</a> to represent integral values.

        By default <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <span class="e">ptrdiff_t</span>, which <a href="motion.txt.html#is" class="d">is</a> usually the largest integral
        type the machine handles "comfortably"<a href="repeat.txt.html#." class="d">.</a>

lua_isboolean                                                  <span id="lua_isboolean%28%29" class="t">lua_isboolean()</span>
&gt;c
    int lua_isboolean (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> has type boolean,
        and <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_iscfunction                                              <span id="lua_iscfunction%28%29" class="t">lua_iscfunction()</span>
&gt;c
    int lua_iscfunction (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function,
        and <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_isfunction                                                <span id="lua_isfunction%28%29" class="t">lua_isfunction()</span>
&gt;c
    int lua_isfunction (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> function
        (either <a href="change.txt.html#C" class="d">C</a> or Lua), and <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_islightuserdata                                      <span id="lua_islightuserdata%28%29" class="t">lua_islightuserdata()</span>
&gt;c
    int lua_islightuserdata (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> light
        userdata, and <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_isnil                                                          <span id="lua_isnil%28%29" class="t">lua_isnil()</span>
&gt;c
    int lua_isnil (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, and <a href="motion.txt.html#0" class="d">0</a>
        otherwise.

lua_isnumber                                                    <span id="lua_isnumber%28%29" class="t">lua_isnumber()</span>
&gt;c
    int lua_isnumber (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number or <a href="insert.txt.html#a" class="d">a</a>
        <a href="vimeval.txt.html#string" class="d">string</a> convertible to <a href="insert.txt.html#a" class="d">a</a> number, and <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_isstring                                                    <span id="lua_isstring%28%29" class="t">lua_isstring()</span>
&gt;c
    int lua_isstring (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> or <a href="insert.txt.html#a" class="d">a</a>
        number (which <a href="motion.txt.html#is" class="d">is</a> always convertible to <a href="insert.txt.html#a" class="d">a</a> string), and <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_istable                                                      <span id="lua_istable%28%29" class="t">lua_istable()</span>
&gt;c
    int lua_istable (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> table, and
        <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_isthread                                                    <span id="lua_isthread%28%29" class="t">lua_isthread()</span>
&gt;c
    int lua_isthread (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> thread, and
        <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_isuserdata                                                <span id="lua_isuserdata%28%29" class="t">lua_isuserdata()</span>
&gt;c
    int lua_isuserdata (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#userdata" class="d">userdata</a>
        (either full or light), and <a href="motion.txt.html#0" class="d">0</a> otherwise.

lua_lessthan                                                    <span id="lua_lessthan%28%29" class="t">lua_lessthan()</span>
&gt;c
    int lua_lessthan (lua_State *L, int index1, int index2);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the value <a href="motion.txt.html#at" class="d">at</a> acceptable <a href="index.txt.html#index" class="d">index</a> <span class="e">index1</span> <a href="motion.txt.html#is" class="d">is</a> smaller than
        the value <a href="motion.txt.html#at" class="d">at</a> acceptable <a href="index.txt.html#index" class="d">index</a> <span class="e">index2</span>, following the semantics of the
        <a href="lua.txt.html#Lua" class="d">Lua</a> <span class="e">&lt;</span> <a href="motion.txt.html#operator" class="d">operator</a> (that is, may call metamethods). Otherwise returns 0.
        Also returns <a href="motion.txt.html#0" class="d">0</a> if any of the indices <a href="motion.txt.html#is" class="d">is</a> non valid.

lua_load                                                            <span id="lua_load%28%29" class="t">lua_load()</span>
&gt;c
    int lua_load (lua_State *L,
                  <a href="luaref.txt.html#lua_Reader" class="d">lua_Reader</a> reader,
                  void *data,
                  const char *chunkname);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Loads <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> chunk. If there are no errors, <span class="e">lua_load</span> pushes the
        compiled chunk <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function on top of the stack. Otherwise, <a href="motion.txt.html#it" class="d">it</a>
        pushes an error message. The return values of <span class="e">lua_load</span> are:

         <a href="motion.txt.html#-" class="d">-</a> <span class="e">0</span>: no errors;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_ERRSYNTAX</span> <a href="cmdline.txt.html#%3A" class="d">:</a> <a href="syntax.txt.html#syntax" class="d">syntax</a> error during pre-compilation;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_ERRMEM</span> <a href="cmdline.txt.html#%3A" class="d">:</a> memory allocation error.

        This function only loads <a href="insert.txt.html#a" class="d">a</a> chunk; <a href="motion.txt.html#it" class="d">it</a> does not run it.

        <span class="e">lua_load</span> automatically detects whether the chunk <a href="motion.txt.html#is" class="d">is</a> text or binary,
        and loads <a href="motion.txt.html#it" class="d">it</a> accordingly (see program <span class="e">luac</span>).

        The <span class="e">lua_load</span> function uses <a href="insert.txt.html#a" class="d">a</a> user-supplied <span class="e">reader</span> function to read
        the chunk (see <a href="luaref.txt.html#lua_Reader" class="l">lua_Reader</a>). The <span class="e">data</span> argument <a href="motion.txt.html#is" class="d">is</a> an opaque
        value passed to the reader function.

        The <span class="e">chunkname</span> argument gives <a href="insert.txt.html#a" class="d">a</a> name to the chunk, which <a href="motion.txt.html#is" class="d">is</a> used <a href="luaref.txt.html#for" class="d">for</a>
        error <a href="message.txt.html#messages" class="d">messages</a> and in debug information (see <a href="luaref.txt.html#lua-apiDebug" class="l">lua-apiDebug</a>).

lua_newstate                                                    <span id="lua_newstate%28%29" class="t">lua_newstate()</span>
&gt;c
    <a href="luaref.txt.html#lua_State" class="d">lua_State</a> *lua_newstate (lua_Alloc f, void *ud);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Creates <a href="insert.txt.html#a" class="d">a</a> new, independent state. Returns <span class="e">NULL</span> if cannot create the
        state (due to lack of memory). The argument <span class="e">f</span> <a href="motion.txt.html#is" class="d">is</a> the allocator
        function; <a href="lua.txt.html#Lua" class="d">Lua</a> does all memory allocation <a href="luaref.txt.html#for" class="d">for</a> this state through this
        function. The second argument, <span class="e">ud</span>, <a href="motion.txt.html#is" class="d">is</a> an opaque pointer that <a href="lua.txt.html#Lua" class="d">Lua</a>
        simply passes to the allocator in every call.

lua_newtable                                                    <span id="lua_newtable%28%29" class="t">lua_newtable()</span>
&gt;c
    void lua_newtable (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Creates <a href="insert.txt.html#a" class="d">a</a> new empty table and pushes <a href="motion.txt.html#it" class="d">it</a> onto the stack. It <a href="motion.txt.html#is" class="d">is</a>
        equivalent to `lua_createtable(L, 0, 0)` (see
        <a href="luaref.txt.html#lua_createtable%28%29" class="l">lua_createtable()</a>).

lua_newthread                                                  <span id="lua_newthread%28%29" class="t">lua_newthread()</span>
&gt;c
    <a href="luaref.txt.html#lua_State" class="d">lua_State</a> *lua_newthread (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Creates <a href="insert.txt.html#a" class="d">a</a> new thread, pushes <a href="motion.txt.html#it" class="d">it</a> on the stack, and returns <a href="insert.txt.html#a" class="d">a</a> pointer to
        <a href="insert.txt.html#a" class="d">a</a> <span class="e">lua_State</span>  (see <a href="luaref.txt.html#lua_State" class="l">lua_State</a><a href="motion.txt.html#%29" class="d">)</a> that represents this new
        thread. The new state returned by this function shares with the
        original state all global <a href="index.txt.html#objects" class="d">objects</a> (such <a href="motion.txt.html#as" class="d">as</a> tables), but has an
        independent execution stack.

        There <a href="motion.txt.html#is" class="d">is</a> no explicit function to close or to destroy <a href="insert.txt.html#a" class="d">a</a> thread. Threads
        are subject to garbage collection, like any <a href="lua.txt.html#Lua" class="d">Lua</a> object.

lua_newuserdata                                              <span id="lua_newuserdata%28%29" class="t">lua_newuserdata()</span>
&gt;c
    void *lua_newuserdata (lua_State *L, size_t size);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        This function allocates <a href="insert.txt.html#a" class="d">a</a> new block of memory with the given size,
        pushes onto the stack <a href="insert.txt.html#a" class="d">a</a> new full <a href="luaref.txt.html#userdata" class="d">userdata</a> with the block address, and
        returns this address.
                                                                    <span id="userdata" class="t">userdata</span>
        Userdata represents <a href="change.txt.html#C" class="d">C</a> values in Lua. <a href="insert.txt.html#A" class="d">A</a> full <a href="luaref.txt.html#userdata" class="d">userdata</a> represents <a href="insert.txt.html#a" class="d">a</a>
        block of memory. It <a href="motion.txt.html#is" class="d">is</a> an object (like <a href="insert.txt.html#a" class="d">a</a> table): you must create it,
        <a href="motion.txt.html#it" class="d">it</a> can have its own metatable, and you can detect when <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> being
        collected. <a href="insert.txt.html#A" class="d">A</a> full <a href="luaref.txt.html#userdata" class="d">userdata</a> <a href="motion.txt.html#is" class="d">is</a> only equal to itself (under raw
        equality).

        When <a href="lua.txt.html#Lua" class="d">Lua</a> collects <a href="insert.txt.html#a" class="d">a</a> full <a href="luaref.txt.html#userdata" class="d">userdata</a> with <a href="insert.txt.html#a" class="d">a</a> <span class="e">gc</span> metamethod, <a href="lua.txt.html#Lua" class="d">Lua</a> calls
        the metamethod and marks the <a href="luaref.txt.html#userdata" class="d">userdata</a> <a href="motion.txt.html#as" class="d">as</a> finalized. When this <a href="luaref.txt.html#userdata" class="d">userdata</a>
        <a href="motion.txt.html#is" class="d">is</a> collected again then <a href="lua.txt.html#Lua" class="d">Lua</a> frees its corresponding memory.

lua_next                                                            <span id="lua_next%28%29" class="t">lua_next()</span>
&gt;c
    int lua_next (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pops <a href="insert.txt.html#a" class="d">a</a> key from the stack, and pushes <a href="insert.txt.html#a" class="d">a</a> key-value pair from the table
        <a href="motion.txt.html#at" class="d">at</a> the given <a href="index.txt.html#index" class="d">index</a> (the "next" pair after the given key). If there are
        no more elements in the table, then <span class="e">lua_next</span> returns <a href="motion.txt.html#0" class="d">0</a> (and pushes
        nothing).

                                                         <span id="lua-tabletraversal" class="t">lua-tabletraversal</span>
        <a href="insert.txt.html#A" class="d">A</a> typical traversal looks like this:
&gt;c
               <a href="pattern.txt.html#%2F" class="d">/</a>* table <a href="motion.txt.html#is" class="d">is</a> in the stack <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> 't' *<a href="pattern.txt.html#%2F" class="d">/</a>
               lua_pushnil(L);  <a href="pattern.txt.html#%2F" class="d">/</a>* first key *<a href="pattern.txt.html#%2F" class="d">/</a>
               while (lua_next(L, t) != 0) <a href="motion.txt.html#%7B" class="d">{</a>
                 <a href="pattern.txt.html#%2F" class="d">/</a>* uses <a href="vim_diff.txt.html#%27key%27" class="o">'key'</a> (at <a href="index.txt.html#index" class="d">index</a> -2) and <span class="o">'value'</span> (at <a href="index.txt.html#index" class="d">index</a> -1) *<a href="pattern.txt.html#%2F" class="d">/</a>
                 printf("%s <a href="motion.txt.html#-" class="d">-</a> %s\n"<a href="motion.txt.html#%2C" class="d">,</a>
                        lua_typename(L, lua_type(L, -2)),
                        lua_typename(L, lua_type(L, -1)));
                 <a href="pattern.txt.html#%2F" class="d">/</a>* removes <span class="o">'value'</span>; keeps <a href="vim_diff.txt.html#%27key%27" class="o">'key'</a> <a href="luaref.txt.html#for" class="d">for</a> next iteration *<a href="pattern.txt.html#%2F" class="d">/</a>
                 lua_pop(L, 1);
               <a href="motion.txt.html#%7D" class="d">}</a>
<a href="change.txt.html#%3C" class="d">&lt;</a>
        While traversing <a href="insert.txt.html#a" class="d">a</a> table, <a href="diff.txt.html#do" class="d">do</a> not call <span class="e">lua_tolstring</span> (see
        <a href="luaref.txt.html#lua_tolstring%28%29" class="l">lua_tolstring()</a><a href="motion.txt.html#%29" class="d">)</a> directly on <a href="insert.txt.html#a" class="d">a</a> key, unless you know that the
        key <a href="motion.txt.html#is" class="d">is</a> actually <a href="insert.txt.html#a" class="d">a</a> string. Recall that <span class="e">lua_tolstring</span> <span class="e">changes</span> the
        value <a href="motion.txt.html#at" class="d">at</a> the given index; this confuses the next call to <span class="e">lua_next</span>.

<a href="luaref.txt.html#lua_Number" class="d">lua_Number</a>                                                          <span id="lua_Number" class="t">lua_Number</span>
&gt;c
    typedef double lua_Number;
<a href="change.txt.html#%3C" class="d">&lt;</a>
        The type of numbers in Lua. By default, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> double, but that can be
        changed in <span class="e">luaconf.h</span>.

        Through the configuration file you can change <a href="lua.txt.html#Lua" class="d">Lua</a> to operate with
        another type <a href="luaref.txt.html#for" class="d">for</a> numbers (e.g., float or long).

lua_objlen                                                        <span id="lua_objlen%28%29" class="t">lua_objlen()</span>
&gt;c
    size_t lua_objlen (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the "length" of the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable index: <a href="luaref.txt.html#for" class="d">for</a>
        strings, this <a href="motion.txt.html#is" class="d">is</a> the <a href="vimeval.txt.html#string" class="d">string</a> length; <a href="luaref.txt.html#for" class="d">for</a> tables, this <a href="motion.txt.html#is" class="d">is</a> the result of
        the length <a href="motion.txt.html#operator" class="d">operator</a> (`#`); <a href="luaref.txt.html#for" class="d">for</a> userdata, this <a href="motion.txt.html#is" class="d">is</a> the size of the
        block of memory allocated <a href="luaref.txt.html#for" class="d">for</a> the userdata; <a href="luaref.txt.html#for" class="d">for</a> other values, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> 0.

lua_pcall                                                          <span id="lua_pcall%28%29" class="t">lua_pcall()</span>
&gt;c
    lua_pcall (lua_State *L, int nargs, int nresults, int errfunc);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Calls <a href="insert.txt.html#a" class="d">a</a> function in protected mode.

        Both <span class="e">nargs</span> and <span class="e">nresults</span> have the same meaning <a href="motion.txt.html#as" class="d">as</a> in <span class="e">lua_call</span>
        (see <a href="luaref.txt.html#lua_call%28%29" class="l">lua_call()</a>). If there are no <a href="message.txt.html#errors" class="d">errors</a> during the call,
        <span class="e">lua_pcall</span> behaves exactly like <span class="e">lua_call</span>. However, if there <a href="motion.txt.html#is" class="d">is</a> any
        error, <span class="e">lua_pcall</span> catches it, pushes <a href="insert.txt.html#a" class="d">a</a> single value on the stack (the
        error message), and returns an error code. Like <span class="e">lua_call</span>,
        <span class="e">lua_pcall</span> always removes the function and its arguments from the
        stack.

        If <span class="e">errfunc</span> <a href="motion.txt.html#is" class="d">is</a> 0, then the error message returned on the stack <a href="motion.txt.html#is" class="d">is</a>
        exactly the original error message. Otherwise, <span class="e">errfunc</span> <a href="motion.txt.html#is" class="d">is</a> the stack
        <a href="index.txt.html#index" class="d">index</a> of an <span class="e">error</span> `handler function`. (In the current
        implementation, this <a href="index.txt.html#index" class="d">index</a> cannot be <a href="insert.txt.html#a" class="d">a</a> pseudo-index.) In <a href="change.txt.html#case" class="d">case</a> of
        runtime errors, this function will be called with the error message
        and its return value will be the message returned on the stack by
        <span class="e">lua_pcall</span>.

        Typically, the error handler function <a href="motion.txt.html#is" class="d">is</a> used to add more debug
        information to the error message, such <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> stack traceback. Such
        information cannot be gathered after the return of <span class="e">lua_pcall</span>, since
        by then the stack has unwound.

        The <span class="e">lua_pcall</span> function returns <a href="motion.txt.html#0" class="d">0</a> in <a href="change.txt.html#case" class="d">case</a> of success or one of the
        following error codes (defined in <span class="e">lua.h</span>):

        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_ERRRUN</span>  <a href="insert.txt.html#a" class="d">a</a> runtime error.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_ERRMEM</span>  memory allocation error. For such errors, <a href="lua.txt.html#Lua" class="d">Lua</a> does
                      not call the error handler function.
        <a href="motion.txt.html#-" class="d">-</a> <span class="e">LUA_ERRERR</span>  error while running the error handler function.

lua_pop                                                              <span id="lua_pop%28%29" class="t">lua_pop()</span>
&gt;c
    void lua_pop (lua_State *L, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pops <span class="e">n</span> elements from the stack.

lua_pushboolean                                              <span id="lua_pushboolean%28%29" class="t">lua_pushboolean()</span>
&gt;c
    void lua_pushboolean (lua_State *L, int b);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> <a href="options.txt.html#boolean" class="d">boolean</a> value with value <span class="e">b</span> onto the stack.

lua_pushcclosure                                            <span id="lua_pushcclosure%28%29" class="t">lua_pushcclosure()</span>
&gt;c
    void lua_pushcclosure (lua_State *L, <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> fn, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> new <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#closure" class="d">closure</a> onto the stack.

        When <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function <a href="motion.txt.html#is" class="d">is</a> created, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> possible to associate some values
        with it, thus creating <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> <a href="vimeval.txt.html#closure" class="d">closure</a> (see <a href="luaref.txt.html#lua-cclosure" class="l">lua-cclosure</a>); these
        values are then accessible to the function whenever <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> called. To
        associate values with <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function, first these values should be
        pushed onto the stack (when there are multiple values, the first value
        <a href="motion.txt.html#is" class="d">is</a> pushed first). Then <span class="e">lua_pushcclosure</span> <a href="motion.txt.html#is" class="d">is</a> called to create and push
        the <a href="change.txt.html#C" class="d">C</a> function onto the stack, with the argument <span class="e">n</span> telling how many
        values should be associated with the function. <span class="e">lua_pushcclosure</span> also
        pops these values from the stack.

lua_pushcfunction                                          <span id="lua_pushcfunction%28%29" class="t">lua_pushcfunction()</span>
&gt;c
    void lua_pushcfunction (lua_State *L, <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> f);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function onto the stack. This function receives <a href="insert.txt.html#a" class="d">a</a> pointer
        to <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function and pushes onto the stack <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> value of type
        <span class="e">function</span> that, when called, invokes the corresponding <a href="change.txt.html#C" class="d">C</a> function.

        Any function to be registered in <a href="lua.txt.html#Lua" class="d">Lua</a> must follow the correct protocol
        to receive its parameters and return its results (see
        <a href="luaref.txt.html#lua_CFunction" class="l">lua_CFunction</a>).

        <span class="e">lua_pushcfunction</span> <a href="motion.txt.html#is" class="d">is</a> defined <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> macro:
&gt;c
            #define lua_pushcfunction(L,f)  lua_pushcclosure(L,f,0)
<a href="change.txt.html#%3C" class="d">&lt;</a>

lua_pushfstring                                              <span id="lua_pushfstring%28%29" class="t">lua_pushfstring()</span>
&gt;c
    const char *lua_pushfstring (lua_State *L, const char *fmt, ...);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack <a href="insert.txt.html#a" class="d">a</a> formatted <a href="vimeval.txt.html#string" class="d">string</a> and returns <a href="insert.txt.html#a" class="d">a</a> pointer to this
        string. It <a href="motion.txt.html#is" class="d">is</a> similar to the <a href="change.txt.html#C" class="d">C</a> function <span class="e">sprintf</span>, but has some
        important differences:

         <a href="motion.txt.html#-" class="d">-</a> You <a href="diff.txt.html#do" class="d">do</a> not have to allocate <a href="intro.txt.html#space" class="d">space</a> <a href="luaref.txt.html#for" class="d">for</a> the result: the result <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a>
           <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="vimeval.txt.html#string" class="d">string</a> and <a href="lua.txt.html#Lua" class="d">Lua</a> takes care of memory allocation (and
           deallocation, through garbage collection).
         <a href="motion.txt.html#-" class="d">-</a> The conversion specifiers are quite restricted. There are no flags,
           widths, or precisions. The conversion specifiers can only be <span class="e">%%</span>
           (inserts <a href="insert.txt.html#a" class="d">a</a> <span class="e">%</span> in the string), <span class="e">%s</span> (inserts <a href="insert.txt.html#a" class="d">a</a> zero-terminated
           string, with no size restrictions), <span class="e">%f</span> (inserts <a href="insert.txt.html#a" class="d">a</a>
           <span class="e">lua_Number</span>), <span class="e">%p</span> (inserts <a href="insert.txt.html#a" class="d">a</a> pointer <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> hexadecimal numeral),
           <span class="e">%d</span> (inserts an <span class="e">int</span>), and <span class="e">%c</span> (inserts an <span class="e">int</span> <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a>
           character).

lua_pushinteger                                              <span id="lua_pushinteger%28%29" class="t">lua_pushinteger()</span>
&gt;c
    void lua_pushinteger (lua_State *L, <a href="luaref.txt.html#lua_Integer" class="d">lua_Integer</a> n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> number with value <span class="e">n</span> onto the stack.

lua_pushlightuserdata                                  <span id="lua_pushlightuserdata%28%29" class="t">lua_pushlightuserdata()</span>
&gt;c
    void lua_pushlightuserdata (lua_State *L, void *p);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> light <a href="luaref.txt.html#userdata" class="d">userdata</a> onto the stack.
                                                          <span id="lua-lightuserdata" class="t">lua-lightuserdata</span>
        Userdata represents <a href="change.txt.html#C" class="d">C</a> values in Lua. <a href="insert.txt.html#A" class="d">A</a> light <a href="luaref.txt.html#userdata" class="d">userdata</a> represents <a href="insert.txt.html#a" class="d">a</a>
        pointer. It <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> value (like <a href="insert.txt.html#a" class="d">a</a> number): you <a href="diff.txt.html#do" class="d">do</a> not create it, <a href="motion.txt.html#it" class="d">it</a> has
        no individual metatable, and <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> not collected (as <a href="motion.txt.html#it" class="d">it</a> was never
        created). <a href="insert.txt.html#A" class="d">A</a> light <a href="luaref.txt.html#userdata" class="d">userdata</a> <a href="motion.txt.html#is" class="d">is</a> equal to "any" light <a href="luaref.txt.html#userdata" class="d">userdata</a> with the
        same <a href="change.txt.html#C" class="d">C</a> address.

lua_pushlstring                                              <span id="lua_pushlstring%28%29" class="t">lua_pushlstring()</span>
&gt;c
    void lua_pushlstring (lua_State *L, const char *s, size_t len);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes the <a href="vimeval.txt.html#string" class="d">string</a> pointed to by <span class="e">s</span> with size <span class="e">len</span> onto the stack.
        <a href="lua.txt.html#Lua" class="d">Lua</a> makes (or reuses) an internal copy of the given string, so the
        memory <a href="motion.txt.html#at" class="d">at</a> <span class="e">s</span> can be freed or reused immediately after the function
        returns. The <a href="vimeval.txt.html#string" class="d">string</a> can contain embedded zeros.

lua_pushnil                                                      <span id="lua_pushnil%28%29" class="t">lua_pushnil()</span>
&gt;c
    void lua_pushnil (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> nil value onto the stack.

lua_pushnumber                                                <span id="lua_pushnumber%28%29" class="t">lua_pushnumber()</span>
&gt;c
    void lua_pushnumber (lua_State *L, <a href="luaref.txt.html#lua_Number" class="d">lua_Number</a> n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> number with value <span class="e">n</span> onto the stack.

lua_pushstring                                                <span id="lua_pushstring%28%29" class="t">lua_pushstring()</span>
&gt;c
    void lua_pushstring (lua_State *L, const char *s);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes the zero-terminated <a href="vimeval.txt.html#string" class="d">string</a> pointed to by <span class="e">s</span> onto the stack.
        <a href="lua.txt.html#Lua" class="d">Lua</a> makes (or reuses) an internal copy of the given string, so the
        memory <a href="motion.txt.html#at" class="d">at</a> <span class="e">s</span> can be freed or reused immediately after the function
        returns. The <a href="vimeval.txt.html#string" class="d">string</a> cannot contain embedded zeros; <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> assumed to
        <a href="intro.txt.html#end" class="d">end</a> <a href="motion.txt.html#at" class="d">at</a> the first zero.

lua_pushthread                                                <span id="lua_pushthread%28%29" class="t">lua_pushthread()</span>
&gt;c
    int lua_pushthread (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes the thread represented by <span class="e">L</span> onto the stack. Returns 1 if this
        thread <a href="motion.txt.html#is" class="d">is</a> the main thread of its state.

lua_pushvalue                                                  <span id="lua_pushvalue%28%29" class="t">lua_pushvalue()</span>
&gt;c
    void lua_pushvalue (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes <a href="insert.txt.html#a" class="d">a</a> copy of the element <a href="motion.txt.html#at" class="d">at</a> the given valid <a href="index.txt.html#index" class="d">index</a> onto the stack.

lua_pushvfstring                                            <span id="lua_pushvfstring%28%29" class="t">lua_pushvfstring()</span>
&gt;c
    const char *lua_pushvfstring (lua_State *L,
                                  const char *fmt,
                                  va_list argp);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Equivalent to <span class="e">lua_pushfstring</span> (see <a href="luaref.txt.html#lua_pushfstring%28%29" class="l">lua_pushfstring()</a>), except
        that <a href="motion.txt.html#it" class="d">it</a> receives <a href="insert.txt.html#a" class="d">a</a> <span class="e">va_list</span> instead of <a href="insert.txt.html#a" class="d">a</a> variable number of
        arguments.

lua_rawequal                                                    <span id="lua_rawequal%28%29" class="t">lua_rawequal()</span>
&gt;c
    int lua_rawequal (lua_State *L, int index1, int index2);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns 1 if the two values in acceptable indices <span class="e">index1</span> and
        <span class="e">index2</span> are primitively equal (that is, without calling metamethods).
        Otherwise returns 0. Also returns <a href="motion.txt.html#0" class="d">0</a> if any of the indices are non
        valid.

lua_rawget                                                        <span id="lua_rawget%28%29" class="t">lua_rawget()</span>
&gt;c
    void lua_rawget (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Similar to <span class="e">lua_gettable</span> (see <a href="luaref.txt.html#lua_gettable%28%29" class="l">lua_gettable()</a>), but does <a href="insert.txt.html#a" class="d">a</a> raw
        access (i.e., without metamethods).

lua_rawgeti                                                      <span id="lua_rawgeti%28%29" class="t">lua_rawgeti()</span>
&gt;c
    void lua_rawgeti (lua_State *L, int index, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the value <span class="e">t[n]</span>, where <span class="e">t</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the
        given valid <a href="index.txt.html#index" class="d">index</a> <span class="e">index</span>. The access <a href="motion.txt.html#is" class="d">is</a> raw; that is, <a href="motion.txt.html#it" class="d">it</a> does not
        invoke metamethods.

lua_rawset                                                        <span id="lua_rawset%28%29" class="t">lua_rawset()</span>
&gt;c
    void lua_rawset (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Similar to <span class="e">lua_settable</span> (see <a href="luaref.txt.html#lua_settable%28%29" class="l">lua_settable()</a>), but does <a href="insert.txt.html#a" class="d">a</a> raw
        assignment (i.e., without metamethods).

lua_rawseti                                                      <span id="lua_rawseti%28%29" class="t">lua_rawseti()</span>
&gt;c
    void lua_rawseti (lua_State *L, int index, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Does the equivalent of `t[n] <a href="change.txt.html#%3D" class="d">=</a> v`, where <span class="e">t</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the given
        valid <a href="index.txt.html#index" class="d">index</a> <span class="e">index</span> and <span class="e">v</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the top of the stack.

        This function pops the value from the stack. The assignment <a href="motion.txt.html#is" class="d">is</a> raw;
        that is, <a href="motion.txt.html#it" class="d">it</a> does not invoke metamethods.

<a href="luaref.txt.html#lua_Reader" class="d">lua_Reader</a>                                                          <span id="lua_Reader" class="t">lua_Reader</span>
&gt;c
    typedef const char * <a href="motion.txt.html#%28" class="d">(</a>*lua_Reader) (lua_State *L,
                                        void *data,
                                        size_t *size);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        The reader function used by <span class="e">lua_load</span> (see <a href="luaref.txt.html#lua_load%28%29" class="l">lua_load()</a>). Every
        time <a href="motion.txt.html#it" class="d">it</a> needs another piece of the chunk, <span class="e">lua_load</span> calls the reader,
        passing along its <span class="e">data</span> parameter. The reader must return <a href="insert.txt.html#a" class="d">a</a> pointer
        to <a href="insert.txt.html#a" class="d">a</a> block of memory with <a href="insert.txt.html#a" class="d">a</a> new piece of the chunk and set <span class="e">size</span> to
        the block size. The block must exist until the reader function <a href="motion.txt.html#is" class="d">is</a>
        called again. To signal the <a href="intro.txt.html#end" class="d">end</a> of the chunk, the reader must return
        <span class="e">NULL</span>. The reader function may return pieces of any size greater than
        zero.

lua_register                                                    <span id="lua_register%28%29" class="t">lua_register()</span>
&gt;c
    void lua_register (lua_State *L,
                       const char *name,
                       <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> f);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Sets the <a href="change.txt.html#C" class="d">C</a> function <span class="e">f</span> <a href="motion.txt.html#as" class="d">as</a> the new value of global <span class="e">name</span>. It <a href="motion.txt.html#is" class="d">is</a>
        defined <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> macro:
&gt;c
            #define lua_register(L,n,f) \
                   (lua_pushcfunction(L, f), lua_setglobal(L, n))
<a href="change.txt.html#%3C" class="d">&lt;</a>

lua_remove                                                        <span id="lua_remove%28%29" class="t">lua_remove()</span>
&gt;c
    void lua_remove (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Removes the element <a href="motion.txt.html#at" class="d">at</a> the given valid index, shifting down the
        elements above this <a href="index.txt.html#index" class="d">index</a> to fill the gap. Cannot be called with <a href="insert.txt.html#a" class="d">a</a>
        pseudo-index, because <a href="insert.txt.html#a" class="d">a</a> pseudo-index <a href="motion.txt.html#is" class="d">is</a> not an actual stack position.

lua_replace                                                      <span id="lua_replace%28%29" class="t">lua_replace()</span>
&gt;c
    void lua_replace (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Moves the top element into the given position (and pops it), without
        shifting any element (therefore <a href="change.txt.html#replacing" class="d">replacing</a> the value <a href="motion.txt.html#at" class="d">at</a> the given
        position).

lua_resume                                                        <span id="lua_resume%28%29" class="t">lua_resume()</span>
&gt;c
    int lua_resume (lua_State *L, int narg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Starts and resumes <a href="insert.txt.html#a" class="d">a</a> coroutine in <a href="insert.txt.html#a" class="d">a</a> given thread.

        To start <a href="insert.txt.html#a" class="d">a</a> coroutine, you first create <a href="insert.txt.html#a" class="d">a</a> new thread (see
        <a href="luaref.txt.html#lua_newthread%28%29" class="l">lua_newthread()</a>); then you push onto its stack the main
        function plus any arguments; then you call <span class="e">lua_resume</span> (see
        <a href="luaref.txt.html#lua_resume%28%29" class="l">lua_resume()</a><a href="motion.txt.html#%29" class="d">)</a> with <span class="e">narg</span> being the number of arguments. This
        call returns when the coroutine suspends or finishes its execution.
        When <a href="motion.txt.html#it" class="d">it</a> returns, the stack contains all values passed to <span class="e">lua_yield</span>
        (see <a href="luaref.txt.html#lua_yield%28%29" class="l">lua_yield()</a>), or all values returned by the body function.
        <span class="e">lua_resume</span> returns <span class="e">LUA_YIELD</span> if the coroutine yields, <a href="motion.txt.html#0" class="d">0</a> if the
        coroutine finishes its execution without errors, or an error code in
        <a href="change.txt.html#case" class="d">case</a> of <a href="message.txt.html#errors" class="d">errors</a> (see <a href="luaref.txt.html#lua_pcall%28%29" class="l">lua_pcall()</a>). In <a href="change.txt.html#case" class="d">case</a> of errors, the stack
        <a href="motion.txt.html#is" class="d">is</a> not unwound, so you can use the debug <a href="api.txt.html#API" class="d">API</a> over it. The error
        message <a href="motion.txt.html#is" class="d">is</a> on the top of the stack. To restart <a href="insert.txt.html#a" class="d">a</a> coroutine, you <a href="change.txt.html#put" class="d">put</a> on
        its stack only the values to be passed <a href="motion.txt.html#as" class="d">as</a> results from <span class="e">lua_yield</span>,
        and then call <span class="e">lua_resume</span>.

lua_setallocf                                                  <span id="lua_setallocf%28%29" class="t">lua_setallocf()</span>
&gt;c
    void lua_setallocf (lua_State *L, <a href="luaref.txt.html#lua_Alloc" class="d">lua_Alloc</a> f, void *ud);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Changes the allocator function of <a href="insert.txt.html#a" class="d">a</a> given state to <span class="e">f</span> with user data
        <span class="e">ud</span>.

lua_setfenv                                                      <span id="lua_setfenv%28%29" class="t">lua_setfenv()</span>
&gt;c
    int lua_setfenv (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pops <a href="insert.txt.html#a" class="d">a</a> table from the stack and sets <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#as" class="d">as</a> the new environment <a href="luaref.txt.html#for" class="d">for</a> the
        value <a href="motion.txt.html#at" class="d">at</a> the given index. If the value <a href="motion.txt.html#at" class="d">at</a> the given <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> neither <a href="insert.txt.html#a" class="d">a</a>
        function nor <a href="insert.txt.html#a" class="d">a</a> thread nor <a href="insert.txt.html#a" class="d">a</a> userdata, <span class="e">lua_setfenv</span> returns 0.
        Otherwise <a href="motion.txt.html#it" class="d">it</a> returns 1.

lua_setfield                                                    <span id="lua_setfield%28%29" class="t">lua_setfield()</span>
&gt;c
    void lua_setfield (lua_State *L, int index, const char *k);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Does the equivalent to `t[k] <a href="change.txt.html#%3D" class="d">=</a> v`, where <span class="e">t</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the given
        valid <a href="index.txt.html#index" class="d">index</a> <span class="e">index</span> and <span class="e">v</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the top of the stack.

        This function pops the value from the stack. As in Lua, this function
        may trigger <a href="insert.txt.html#a" class="d">a</a> metamethod <a href="luaref.txt.html#for" class="d">for</a> the "newindex" event (see
        <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

lua_setglobal                                                  <span id="lua_setglobal%28%29" class="t">lua_setglobal()</span>
&gt;c
    void lua_setglobal (lua_State *L, const char *name);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pops <a href="insert.txt.html#a" class="d">a</a> value from the stack and sets <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#as" class="d">as</a> the new value of global
        <span class="e">name</span>. It <a href="motion.txt.html#is" class="d">is</a> defined <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> macro:
&gt;c
            #define lua_setglobal(L,s)   lua_setfield(L, LUA_GLOBALSINDEX, s)
<a href="change.txt.html#%3C" class="d">&lt;</a>

lua_setmetatable                                            <span id="lua_setmetatable%28%29" class="t">lua_setmetatable()</span>
&gt;c
    int lua_setmetatable (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pops <a href="insert.txt.html#a" class="d">a</a> table from the stack and sets <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#as" class="d">as</a> the new <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="luaref.txt.html#for" class="d">for</a> the
        value <a href="motion.txt.html#at" class="d">at</a> the given acceptable index.

lua_settable                                                    <span id="lua_settable%28%29" class="t">lua_settable()</span>
&gt;c
    void lua_settable (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Does the equivalent to `t[k] <a href="change.txt.html#%3D" class="d">=</a> v`, where <span class="e">t</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the given
        valid <a href="index.txt.html#index" class="d">index</a> <span class="e">index</span>, <span class="e">v</span> <a href="motion.txt.html#is" class="d">is</a> the value <a href="motion.txt.html#at" class="d">at</a> the top of the stack, and <span class="e">k</span>
        <a href="motion.txt.html#is" class="d">is</a> the value just below the top.

        This function pops both the key and the value from the stack. As in
        Lua, this function may trigger <a href="insert.txt.html#a" class="d">a</a> metamethod <a href="luaref.txt.html#for" class="d">for</a> the "newindex" event
        (see <a href="luaref.txt.html#lua-metatable" class="l">lua-metatable</a>).

lua_settop                                                        <span id="lua_settop%28%29" class="t">lua_settop()</span>
&gt;c
    void lua_settop (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Accepts any acceptable index, or 0, and sets the stack top to this
        index. If the new top <a href="motion.txt.html#is" class="d">is</a> larger than the old one, then the new
        elements are filled with <span class="e">nil</span>. If <span class="e">index</span> <a href="motion.txt.html#is" class="d">is</a> 0, then all stack
        elements are removed.

<a href="luaref.txt.html#lua_State" class="d">lua_State</a>                                                            <span id="lua_State" class="t">lua_State</span>
&gt;c
    typedef struct <a href="luaref.txt.html#lua_State" class="d">lua_State</a> lua_State;
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Opaque structure that keeps the whole state of <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> interpreter. The
        <a href="lua.txt.html#Lua" class="d">Lua</a> library <a href="motion.txt.html#is" class="d">is</a> fully reentrant: <a href="motion.txt.html#it" class="d">it</a> has no global variables. All
        information about <a href="insert.txt.html#a" class="d">a</a> state <a href="motion.txt.html#is" class="d">is</a> kept in this structure.

        <a href="insert.txt.html#A" class="d">A</a> pointer to this state must be passed <a href="motion.txt.html#as" class="d">as</a> the first argument to every
        function in the library, except to <span class="e">lua_newstate</span> (see
        <a href="luaref.txt.html#lua_newstate%28%29" class="l">lua_newstate()</a>), which creates <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> state from scratch.

lua_status                                                        <span id="lua_status%28%29" class="t">lua_status()</span>
&gt;c
    int lua_status (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the status of the thread <span class="e">L</span>.

        The status can be <a href="motion.txt.html#0" class="d">0</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> normal thread, an error code if the thread
        finished its execution with an error, or <span class="e">LUA_YIELD</span> if the thread <a href="motion.txt.html#is" class="d">is</a>
        suspended.

lua_toboolean                                                  <span id="lua_toboolean%28%29" class="t">lua_toboolean()</span>
&gt;c
    int lua_toboolean (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Converts the <a href="lua.txt.html#Lua" class="d">Lua</a> value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> to <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> <a href="options.txt.html#boolean" class="d">boolean</a>
        value (0 or 1). Like all tests in Lua, <span class="e">lua_toboolean</span> returns 1 <a href="luaref.txt.html#for" class="d">for</a>
        any <a href="lua.txt.html#Lua" class="d">Lua</a> value different from <span class="e">false</span> and <span class="e">nil</span>; otherwise <a href="motion.txt.html#it" class="d">it</a> returns
        0. It also returns <a href="motion.txt.html#0" class="d">0</a> when called with <a href="insert.txt.html#a" class="d">a</a> non-valid index. (If you want
           to accept only actual <a href="options.txt.html#boolean" class="d">boolean</a> values, use <span class="e">lua_isboolean</span>
           <a href="luaref.txt.html#lua_isboolean%28%29" class="l">lua_isboolean()</a> to test the value's type.)

lua_tocfunction                                              <span id="lua_tocfunction%28%29" class="t">lua_tocfunction()</span>
&gt;c
    <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> lua_tocfunction (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Converts <a href="insert.txt.html#a" class="d">a</a> value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> to <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function. That
        value must be <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function; otherwise <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">NULL</span>.

lua_tointeger                                                  <span id="lua_tointeger%28%29" class="t">lua_tointeger()</span>
&gt;c
    <a href="luaref.txt.html#lua_Integer" class="d">lua_Integer</a> lua_tointeger (lua_State *L, int idx);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Converts the <a href="lua.txt.html#Lua" class="d">Lua</a> value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> to the signed
        integral type <span class="e">lua_Integer</span> (see <a href="luaref.txt.html#lua_Integer" class="l">lua_Integer</a>). The <a href="lua.txt.html#Lua" class="d">Lua</a> value
        must be <a href="insert.txt.html#a" class="d">a</a> number or <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> convertible to <a href="insert.txt.html#a" class="d">a</a> number (see
        <a href="luaref.txt.html#lua-coercion" class="l">lua-coercion</a>); otherwise, <span class="e">lua_tointeger</span> returns 0.

        If the number <a href="motion.txt.html#is" class="d">is</a> not an integer, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> truncated in some non-specified
        way.

lua_tolstring                                                  <span id="lua_tolstring%28%29" class="t">lua_tolstring()</span>
&gt;c
    const char *lua_tolstring (lua_State *L, int index, size_t *len);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Converts the <a href="lua.txt.html#Lua" class="d">Lua</a> value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> to <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> string. If
        <span class="e">len</span> <a href="motion.txt.html#is" class="d">is</a> not <span class="e">NULL</span>, <a href="motion.txt.html#it" class="d">it</a> also sets <span class="e">*len</span> with the <a href="vimeval.txt.html#string" class="d">string</a> length. The
        <a href="lua.txt.html#Lua" class="d">Lua</a> value must be <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> or <a href="insert.txt.html#a" class="d">a</a> number; otherwise, the function
        returns <span class="e">NULL</span>. If the value <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number, then <span class="e">lua_tolstring</span>  also
        `changes the actual value in the stack to <a href="motion.txt.html#a%60" class="d">a`</a> <span class="e">string</span>. (This change
        confuses <span class="e">lua_next</span> <a href="luaref.txt.html#lua_next%28%29" class="l">lua_next()</a> when <span class="e">lua_tolstring</span> <a href="motion.txt.html#is" class="d">is</a> applied
        to keys during <a href="insert.txt.html#a" class="d">a</a> table traversal.)

        <span class="e">lua_tolstring</span> returns <a href="insert.txt.html#a" class="d">a</a> fully aligned pointer to <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> inside the
        <a href="lua.txt.html#Lua" class="d">Lua</a> state. This <a href="vimeval.txt.html#string" class="d">string</a> always has <a href="insert.txt.html#a" class="d">a</a> zero (`\0`) after its last
        character (as in C), but may contain other zeros in its body. Because
        <a href="lua.txt.html#Lua" class="d">Lua</a> has garbage collection, there <a href="motion.txt.html#is" class="d">is</a> no guarantee that the pointer
        returned by <span class="e">lua_tolstring</span> will be valid after the corresponding
        value <a href="motion.txt.html#is" class="d">is</a> removed from the stack.

lua_tonumber                                                    <span id="lua_tonumber%28%29" class="t">lua_tonumber()</span>
&gt;c
    <a href="luaref.txt.html#lua_Number" class="d">lua_Number</a> lua_tonumber (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Converts the <a href="lua.txt.html#Lua" class="d">Lua</a> value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> to the <a href="change.txt.html#C" class="d">C</a> type
        <span class="e">lua_Number</span> (see <a href="luaref.txt.html#lua_Number" class="l">lua_Number</a>). The <a href="lua.txt.html#Lua" class="d">Lua</a> value must be <a href="insert.txt.html#a" class="d">a</a> number
        or <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> convertible to <a href="insert.txt.html#a" class="d">a</a> number (see <a href="luaref.txt.html#lua-coercion" class="l">lua-coercion</a>);
        otherwise, <span class="e">lua_tonumber</span> returns 0.

lua_topointer                                                  <span id="lua_topointer%28%29" class="t">lua_topointer()</span>
&gt;c
    const void *lua_topointer (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Converts the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> to <a href="insert.txt.html#a" class="d">a</a> generic <a href="change.txt.html#C" class="d">C</a>
        pointer (`void*`). The value may be <a href="insert.txt.html#a" class="d">a</a> userdata, <a href="insert.txt.html#a" class="d">a</a> table, <a href="insert.txt.html#a" class="d">a</a> thread, or
        <a href="insert.txt.html#a" class="d">a</a> function; otherwise, <span class="e">lua_topointer</span> returns <span class="e">NULL</span>. Different
        <a href="index.txt.html#objects" class="d">objects</a> will give different pointers. There <a href="motion.txt.html#is" class="d">is</a> no way to convert the
        pointer back to its original value.

        Typically this function <a href="motion.txt.html#is" class="d">is</a> used only <a href="luaref.txt.html#for" class="d">for</a> debug information.

lua_tostring                                                    <span id="lua_tostring%28%29" class="t">lua_tostring()</span>
&gt;c
    const char *lua_tostring (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Equivalent to <span class="e">lua_tolstring</span> (see <a href="luaref.txt.html#lua_tolstring%28%29" class="l">lua_tolstring()</a><a href="motion.txt.html#%29" class="d">)</a> with <span class="e">len</span>
        equal to <span class="e">NULL</span>.

lua_tothread                                                    <span id="lua_tothread%28%29" class="t">lua_tothread()</span>
&gt;c
    <a href="luaref.txt.html#lua_State" class="d">lua_State</a> *lua_tothread (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Converts the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> to <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> thread
        (represented <a href="motion.txt.html#as" class="d">as</a> <span class="e">lua_State*</span> <a href="luaref.txt.html#lua_State" class="l">lua_State</a>). This value must be <a href="insert.txt.html#a" class="d">a</a>
        thread; otherwise, the function returns <span class="e">NULL</span>.

lua_touserdata                                                <span id="lua_touserdata%28%29" class="t">lua_touserdata()</span>
&gt;c
    void *lua_touserdata (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the value <a href="motion.txt.html#at" class="d">at</a> the given acceptable <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> full userdata, returns
        its block address. If the value <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> light userdata, returns its
        pointer. Otherwise, <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">NULL</span>.

lua_type                                                            <span id="lua_type%28%29" class="t">lua_type()</span>
&gt;c
    int lua_type (lua_State *L, int index);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the type of the value in the given acceptable index, or
        <span class="e">LUA_TNONE</span> <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> non-valid <a href="index.txt.html#index" class="d">index</a> (that is, an <a href="index.txt.html#index" class="d">index</a> to an "empty"
        stack position). The types returned by <span class="e">lua_type</span> are coded by the
        following constants defined in <span class="e">lua.h</span> <a href="cmdline.txt.html#%3A" class="d">:</a> <span class="e">LUA_TNIL</span>, <span class="e">LUA_TNUMBER</span>,
        <span class="e">LUA_TBOOLEAN</span>, <span class="e">LUA_TSTRING</span>, <span class="e">LUA_TTABLE</span>, <span class="e">LUA_TFUNCTION</span>,
        <span class="e">LUA_TUSERDATA</span>, <span class="e">LUA_TTHREAD</span>, and <span class="e">LUA_TLIGHTUSERDATA</span>.

lua_typename                                                    <span id="lua_typename%28%29" class="t">lua_typename()</span>
&gt;c
    const char *lua_typename  (lua_State *L, int tp);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the name of the type encoded by the value <span class="e">tp</span>, which must be
        one the values returned by <span class="e">lua_type</span>.

<a href="luaref.txt.html#lua_Writer" class="d">lua_Writer</a>                                                          <span id="lua_Writer" class="t">lua_Writer</span>
&gt;c
    typedef int <a href="motion.txt.html#%28" class="d">(</a>*lua_Writer) (lua_State *L,
                               const void* p,
                               size_t sz,
                               void* ud);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        The writer function used by <span class="e">lua_dump</span> (see <a href="luaref.txt.html#lua_dump%28%29" class="l">lua_dump()</a>). Every
        time <a href="motion.txt.html#it" class="d">it</a> produces another piece of chunk, <span class="e">lua_dump</span> calls the writer,
        passing along the buffer to be written (`p`), its size (`sz`), and the
        <span class="e">data</span> parameter supplied to <span class="e">lua_dump</span>.

        The writer returns an error code: <a href="motion.txt.html#0" class="d">0</a> means no errors; any other value
        means an error and stops <span class="e">lua_dump</span> from calling the writer again.

lua_xmove                                                          <span id="lua_xmove%28%29" class="t">lua_xmove()</span>
&gt;c
    void lua_xmove (lua_State *from, <a href="luaref.txt.html#lua_State" class="d">lua_State</a> *to, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Exchange values between different threads of the <span class="e">same</span> global state.

        This function pops <span class="e">n</span> values from the stack <span class="e">from</span>, and pushes them
        onto the stack <span class="e">to</span>.

lua_yield                                                          <span id="lua_yield%28%29" class="t">lua_yield()</span>
&gt;c
    int lua_yield (lua_State *L, int nresults);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Yields <a href="insert.txt.html#a" class="d">a</a> coroutine.

        This function should only be called <a href="motion.txt.html#as" class="d">as</a> the return <a href="vimeval.txt.html#expression" class="d">expression</a> of <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a>
        function, <a href="motion.txt.html#as" class="d">as</a> follows:
&gt;c
               return lua_yield (L, nresults);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        When <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function calls <span class="e">lua_yield</span> in that way, the running coroutine
        suspends its execution, and the call to <span class="e">lua_resume</span> (see
        <a href="luaref.txt.html#lua_resume%28%29" class="l">lua_resume()</a><a href="motion.txt.html#%29" class="d">)</a> that started this coroutine returns. The
        parameter <span class="e">nresults</span> <a href="motion.txt.html#is" class="d">is</a> the number of values from the stack that are
        passed <a href="motion.txt.html#as" class="d">as</a> results to <span class="e">lua_resume</span>.

                                                           <span id="lua-stackexample" class="t">lua-stackexample</span>
        As an example of stack manipulation, if the stack starts <a href="motion.txt.html#as" class="d">as</a>
        `10 20 30 40 50*<a href="motion.txt.html#%60" class="d">`</a> (from bottom to top; the <span class="e">*</span> marks the top), then

<span class="e">               lua_pushvalue(L, 3)    --&gt; 10 20 30 40 50 30*</span>
<span class="e">               lua_pushvalue(L, -1)   --&gt; 10 20 30 40 50 30 30*</span>
<span class="e">               lua_remove(L, -3)      --&gt; 10 20 30 40 30 30*</span>
<span class="e">               lua_remove(L,  6)      --&gt; 10 20 30 40 30*</span>
<span class="e">               lua_insert(L,  1)      --&gt; 30 10 20 30 40*</span>
<span class="e">               lua_insert(L, -1)      --&gt; 30 10 20 30 40*  (no effect)</span>
<span class="e">               lua_replace(L, 2)      --&gt; 30 40 20 30*</span>
<span class="e">               lua_settop(L, -3)      --&gt; 30 40*</span>
<span class="e">               lua_settop(L,  6)      --&gt; 30 40 nil nil nil nil*</span>


<span class="h">==============================================================================</span>
3.8  The Debug Interface                                       <span id="lua-apiDebug" class="t">lua-apiDebug</span>

<a href="lua.txt.html#Lua" class="d">Lua</a> has no built-in debugging facilities. Instead, <a href="motion.txt.html#it" class="d">it</a> offers <a href="insert.txt.html#a" class="d">a</a> special
interface by means of <a href="vimeval.txt.html#functions" class="d">functions</a> and hooks. This interface allows the
construction of different kinds of debuggers, profilers, and other tools that
need "inside information" from the interpreter.

<a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a>                                                            <span id="lua_Debug" class="t">lua_Debug</span>

&gt;c
    typedef struct <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> <a href="motion.txt.html#%7B" class="d">{</a>
        int event;
        const char *name;           <a href="pattern.txt.html#%2F" class="d">/</a>* (n) *<a href="pattern.txt.html#%2F" class="d">/</a>
        const char *namewhat;       <a href="pattern.txt.html#%2F" class="d">/</a>* (n) *<a href="pattern.txt.html#%2F" class="d">/</a>
        const char *what;           <a href="pattern.txt.html#%2F" class="d">/</a>* (S) *<a href="pattern.txt.html#%2F" class="d">/</a>
        const char *source;         <a href="pattern.txt.html#%2F" class="d">/</a>* (S) *<a href="pattern.txt.html#%2F" class="d">/</a>
        int currentline;            <a href="pattern.txt.html#%2F" class="d">/</a>* (l) *<a href="pattern.txt.html#%2F" class="d">/</a>
        int nups;                   <a href="pattern.txt.html#%2F" class="d">/</a>* (u) number of upvalues *<a href="pattern.txt.html#%2F" class="d">/</a>
        int linedefined;            <a href="pattern.txt.html#%2F" class="d">/</a>* (S) *<a href="pattern.txt.html#%2F" class="d">/</a>
        int lastlinedefined;        <a href="pattern.txt.html#%2F" class="d">/</a>* (S) *<a href="pattern.txt.html#%2F" class="d">/</a>
        char short_src[LUA_IDSIZE]; <a href="pattern.txt.html#%2F" class="d">/</a>* (S) *<a href="pattern.txt.html#%2F" class="d">/</a>
        <a href="pattern.txt.html#%2F" class="d">/</a>* private part *<a href="pattern.txt.html#%2F" class="d">/</a>
        other fields
    <a href="motion.txt.html#%7D" class="d">}</a> lua_Debug;
<a href="change.txt.html#%3C" class="d">&lt;</a>

<a href="insert.txt.html#A" class="d">A</a> structure used to carry different pieces of information about an active
function. <span class="e">lua_getstack</span> (see <a href="luaref.txt.html#lua_getstack%28%29" class="l">lua_getstack()</a><a href="motion.txt.html#%29" class="d">)</a> fills only the private part
of this structure, <a href="luaref.txt.html#for" class="d">for</a> later use. To fill the other fields of <span class="e">lua_Debug</span> with
useful information, call <span class="e">lua_getinfo</span> (see <a href="luaref.txt.html#lua_getinfo%28%29" class="l">lua_getinfo()</a>).

The fields of <span class="e">lua_Debug</span> have the following meaning:

<a href="motion.txt.html#-" class="d">-</a> <span class="e">source</span>             If the function was defined in <a href="insert.txt.html#a" class="d">a</a> string, then <span class="e">source</span> <a href="motion.txt.html#is" class="d">is</a>
                     that string. If the function was defined in <a href="insert.txt.html#a" class="d">a</a> file, then
                     <span class="e">source</span> starts with <a href="insert.txt.html#a" class="d">a</a> <span class="e">@</span> followed by the file name.
<a href="motion.txt.html#-" class="d">-</a> <span class="e">short_src</span>          <a href="insert.txt.html#a" class="d">a</a> "printable" version of <span class="e">source</span>, to be used in error messages.
<a href="motion.txt.html#-" class="d">-</a> <span class="e">linedefined</span>        the line number where the definition of the function starts.
<a href="motion.txt.html#-" class="d">-</a> <span class="e">lastlinedefined</span>    the line number where the definition of the function ends.
<a href="motion.txt.html#-" class="d">-</a> <span class="e">what</span>               the <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">"Lua"</span> if the function <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function,
                     <span class="e">"C"</span> if <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function, <span class="e">"main"</span> if <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> the main
                     part of <a href="insert.txt.html#a" class="d">a</a> chunk, and <span class="e">"tail"</span> if <a href="motion.txt.html#it" class="d">it</a> was <a href="insert.txt.html#a" class="d">a</a> function that
                     did <a href="insert.txt.html#a" class="d">a</a> tail call. In the latter case, <a href="lua.txt.html#Lua" class="d">Lua</a> has no other
                     information about the function.
<a href="motion.txt.html#-" class="d">-</a> <span class="e">currentline</span>        the current line where the given function <a href="motion.txt.html#is" class="d">is</a> executing.
                     When no line information <a href="motion.txt.html#is" class="d">is</a> available, <span class="e">currentline</span> <a href="motion.txt.html#is" class="d">is</a>
                     set to -1.
<a href="motion.txt.html#-" class="d">-</a> <span class="e">name</span>               <a href="insert.txt.html#a" class="d">a</a> reasonable name <a href="luaref.txt.html#for" class="d">for</a> the given function. Because
                     <a href="vimeval.txt.html#functions" class="d">functions</a> in <a href="lua.txt.html#Lua" class="d">Lua</a> are first-class values, they <a href="diff.txt.html#do" class="d">do</a> not have
                     <a href="insert.txt.html#a" class="d">a</a> fixed name: some <a href="vimeval.txt.html#functions" class="d">functions</a> may be the value of multiple
                     global variables, while others may be stored only in <a href="insert.txt.html#a" class="d">a</a>
                     table field. The <span class="e">lua_getinfo</span> function checks how the
                     function was called to find <a href="insert.txt.html#a" class="d">a</a> suitable name. If <a href="motion.txt.html#it" class="d">it</a> cannot
                     find <a href="insert.txt.html#a" class="d">a</a> name, then <span class="e">name</span> <a href="motion.txt.html#is" class="d">is</a> set to <span class="e">NULL</span>.
<a href="motion.txt.html#-" class="d">-</a> <span class="e">namewhat</span>           explains the <span class="e">name</span> field. The value of <span class="e">namewhat</span> can be
                     <span class="e">"global"</span>, <span class="e">"local"</span>, <span class="e">"method"</span>, <span class="e">"field"</span>,
                     <span class="e">"upvalue"</span>, or <span class="e">""</span> (the empty string), according to how
                     the function was called. (Lua uses the empty <a href="vimeval.txt.html#string" class="d">string</a> when
                     no other option seems to apply.) <span class="e">nups</span>  the number of
                     upvalues of the function.

lua_gethook                                                      <span id="lua_gethook%28%29" class="t">lua_gethook()</span>
&gt;c
    <a href="luaref.txt.html#lua_Hook" class="d">lua_Hook</a> lua_gethook (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the current hook function.

lua_gethookcount                                            <span id="lua_gethookcount%28%29" class="t">lua_gethookcount()</span>
&gt;c
    int lua_gethookcount (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the current hook count.

lua_gethookmask                                              <span id="lua_gethookmask%28%29" class="t">lua_gethookmask()</span>
&gt;c
    int lua_gethookmask (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the current hook mask.

lua_getinfo                                                      <span id="lua_getinfo%28%29" class="t">lua_getinfo()</span>
&gt;c
    int lua_getinfo (lua_State *L, const char *what, <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> *ar);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns information about <a href="insert.txt.html#a" class="d">a</a> specific function or function invocation.

        To get information about <a href="insert.txt.html#a" class="d">a</a> function invocation, the parameter <span class="e">ar</span>
        must be <a href="insert.txt.html#a" class="d">a</a> valid activation record that was filled by <a href="insert.txt.html#a" class="d">a</a> previous call
        to <span class="e">lua_getstack</span> (see <a href="luaref.txt.html#lua_getstack%28%29" class="l">lua_getstack()</a><a href="motion.txt.html#%29" class="d">)</a> or given <a href="motion.txt.html#as" class="d">as</a> argument to
        <a href="insert.txt.html#a" class="d">a</a> hook (see <a href="luaref.txt.html#lua_Hook" class="l">lua_Hook</a>).

        To get information about <a href="insert.txt.html#a" class="d">a</a> function you push <a href="motion.txt.html#it" class="d">it</a> onto the stack and
        start the <span class="e">what</span> <a href="vimeval.txt.html#string" class="d">string</a> with the character <span class="e">&gt;</span>. (In that case,
        <span class="e">lua_getinfo</span> pops the function in the top of the stack.) For
        instance, to know in which line <a href="insert.txt.html#a" class="d">a</a> function <span class="e">f</span> was defined, you can
        write the following code:
&gt;c
               <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> ar;
               lua_getfield(L, LUA_GLOBALSINDEX, "<a href="motion.txt.html#f" class="d">f</a>");  <a href="pattern.txt.html#%2F" class="d">/</a>* get global 'f' *<a href="pattern.txt.html#%2F" class="d">/</a>
               lua_getinfo(L, "&gt;S"<a href="motion.txt.html#%2C" class="d">,</a> &amp;ar);
               printf("%d\n"<a href="motion.txt.html#%2C" class="d">,</a> ar.linedefined);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Each character in the <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">what</span> selects some fields of the
        structure <span class="e">ar</span> to be filled or <a href="insert.txt.html#a" class="d">a</a> value to be pushed on the stack:

        <span class="e">'n'</span>  fills in the field <span class="e">name</span> and <span class="e">namewhat</span>
        <span class="e">'S'</span>  fills in the fields <span class="e">source</span>, <span class="e">short_src</span>, <span class="e">linedefined</span>,
             <span class="e">lastlinedefined</span>, and <span class="e">what</span>
        <span class="e">'l'</span>  fills in the field <span class="e">currentline</span>
        <span class="e">'u'</span>  fills in the field <span class="e">nups</span>
        <span class="e">'f'</span>  pushes onto the stack the function that <a href="motion.txt.html#is" class="d">is</a> running <a href="motion.txt.html#at" class="d">at</a> the
             given level
        <span class="e">'L'</span>  pushes onto the stack <a href="insert.txt.html#a" class="d">a</a> table whose indices are the numbers
             of the lines that are valid on the function. (A `valid line` <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a>
             line with some associated code, that is, <a href="insert.txt.html#a" class="d">a</a> line where you can <a href="change.txt.html#put" class="d">put</a>
             <a href="insert.txt.html#a" class="d">a</a> break point. Non-valid lines include empty lines and comments.)

        This function returns <a href="motion.txt.html#0" class="d">0</a> on error (for instance, an invalid option in
        <span class="e">what</span>).

lua_getlocal                                                    <span id="lua_getlocal%28%29" class="t">lua_getlocal()</span>
&gt;c
    const char *lua_getlocal (lua_State *L, <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> *ar, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Gets information about <a href="insert.txt.html#a" class="d">a</a> local variable of <a href="insert.txt.html#a" class="d">a</a> given activation record.
        The parameter <span class="e">ar</span> must be <a href="insert.txt.html#a" class="d">a</a> valid activation record that was filled
        by <a href="insert.txt.html#a" class="d">a</a> previous call to <span class="e">lua_getstack</span> (see <a href="luaref.txt.html#lua_getstack%28%29" class="l">lua_getstack()</a><a href="motion.txt.html#%29" class="d">)</a> or
        given <a href="motion.txt.html#as" class="d">as</a> argument to <a href="insert.txt.html#a" class="d">a</a> hook (see <a href="luaref.txt.html#lua_Hook" class="l">lua_Hook</a>). The <a href="index.txt.html#index" class="d">index</a> <span class="e">n</span>
        selects which local variable to inspect (1 <a href="motion.txt.html#is" class="d">is</a> the first parameter or
        active local variable, and so on, until the last active local
        variable). <span class="e">lua_getlocal</span> pushes the variable's value onto the stack
        and returns its name.

        Variable names <a href="starting.txt.html#starting" class="d">starting</a> with <span class="e">(</span> (open parentheses) represent
        internal <a href="vimeval.txt.html#variables" class="d">variables</a> (loop <a href="intro.txt.html#control" class="d">control</a> variables, temporaries, and <a href="change.txt.html#C" class="d">C</a>
        function locals).

        Returns <span class="e">NULL</span> (and pushes nothing) when the <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> greater than the
        number of active local variables.

lua_getstack                                                    <span id="lua_getstack%28%29" class="t">lua_getstack()</span>
&gt;c
    int lua_getstack (lua_State *L, int level, <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> *ar);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Gets information about the interpreter runtime stack.

        This function fills parts of <a href="insert.txt.html#a" class="d">a</a> <span class="e">lua_Debug</span> (see <a href="luaref.txt.html#lua_Debug" class="l">lua_Debug</a><a href="motion.txt.html#%29" class="d">)</a>
        structure with an identification of the `activation record` of the
        function executing <a href="motion.txt.html#at" class="d">at</a> <a href="insert.txt.html#a" class="d">a</a> given level. Level <a href="motion.txt.html#0" class="d">0</a> <a href="motion.txt.html#is" class="d">is</a> the current running
        function, whereas level <span class="e">n+1</span> <a href="motion.txt.html#is" class="d">is</a> the function that has called level
        <span class="e">n</span>. When there are no errors, <span class="e">lua_getstack</span> returns 1; when called
        with <a href="insert.txt.html#a" class="d">a</a> level greater than the stack depth, <a href="motion.txt.html#it" class="d">it</a> returns 0.

lua_getupvalue                                                <span id="lua_getupvalue%28%29" class="t">lua_getupvalue()</span>
&gt;c
    const char *lua_getupvalue (lua_State *L, int funcindex, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Gets information about <a href="insert.txt.html#a" class="d">a</a> closure's upvalue. (For <a href="lua.txt.html#Lua" class="d">Lua</a> functions,
        upvalues are the external local <a href="vimeval.txt.html#variables" class="d">variables</a> that the function uses, and
        that are consequently included in its closure.) <span class="e">lua_getupvalue</span> gets
        the <a href="index.txt.html#index" class="d">index</a> <span class="e">n</span> of an upvalue, pushes the upvalue's value onto the
        stack, and returns its name. <span class="e">funcindex</span> points to the <a href="vimeval.txt.html#closure" class="d">closure</a> in the
        stack. (Upvalues have no particular order, <a href="motion.txt.html#as" class="d">as</a> they are active through
        the whole function. So, they are numbered in an arbitrary order.)

        Returns <span class="e">NULL</span> (and pushes nothing) when the <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> greater than the
        number of upvalues. For <a href="change.txt.html#C" class="d">C</a> functions, this function uses the empty
        <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">""</span> <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> name <a href="luaref.txt.html#for" class="d">for</a> all upvalues.

<a href="luaref.txt.html#lua_Hook" class="d">lua_Hook</a>                                                              <span id="lua_Hook" class="t">lua_Hook</span>
&gt;c
    typedef void <a href="motion.txt.html#%28" class="d">(</a>*lua_Hook) (lua_State *L, <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> *ar);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Type <a href="luaref.txt.html#for" class="d">for</a> debugging hook functions.

        Whenever <a href="insert.txt.html#a" class="d">a</a> hook <a href="motion.txt.html#is" class="d">is</a> called, its <span class="e">ar</span> argument has its field <span class="e">event</span> set
        to the specific event that triggered the hook. <a href="lua.txt.html#Lua" class="d">Lua</a> identifies these
        <a href="autocmd.txt.html#events" class="d">events</a> with the following constants: <span class="e">LUA_HOOKCALL</span>, <span class="e">LUA_HOOKRET</span>,
        <span class="e">LUA_HOOKTAILRET</span>, <span class="e">LUA_HOOKLINE</span>, and <span class="e">LUA_HOOKCOUNT</span>. Moreover, <a href="luaref.txt.html#for" class="d">for</a>
        line events, the field <span class="e">currentline</span> <a href="motion.txt.html#is" class="d">is</a> also set. To get the value of
        any other field in <span class="e">ar</span>, the hook must call <span class="e">lua_getinfo</span> (see
        <a href="luaref.txt.html#lua_getinfo%28%29" class="l">lua_getinfo()</a>). For return events, <span class="e">event</span> may be
        <span class="e">LUA_HOOKRET</span>, the normal value, or <span class="e">LUA_HOOKTAILRET</span>. In the latter
        case, <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> simulating <a href="insert.txt.html#a" class="d">a</a> return from <a href="insert.txt.html#a" class="d">a</a> function that did <a href="insert.txt.html#a" class="d">a</a> tail call;
        in this case, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> useless to call <span class="e">lua_getinfo</span>.

        While <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> running <a href="insert.txt.html#a" class="d">a</a> hook, <a href="motion.txt.html#it" class="d">it</a> disables other calls to hooks.
        Therefore, if <a href="insert.txt.html#a" class="d">a</a> hook calls back <a href="lua.txt.html#Lua" class="d">Lua</a> to execute <a href="insert.txt.html#a" class="d">a</a> function or <a href="insert.txt.html#a" class="d">a</a> chunk,
        this execution occurs without any calls to hooks.


lua_sethook                                                      <span id="lua_sethook%28%29" class="t">lua_sethook()</span>
&gt;c
    int lua_sethook (lua_State *L, <a href="luaref.txt.html#lua_Hook" class="d">lua_Hook</a> f, int mask, int count);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Sets the debugging hook function.

        Argument <span class="e">f</span> <a href="motion.txt.html#is" class="d">is</a> the hook function. <span class="e">mask</span> specifies on which <a href="autocmd.txt.html#events" class="d">events</a>
        the hook will be called: <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> formed by <a href="insert.txt.html#a" class="d">a</a> bitwise <span class="e">or</span> of the
        constants <span class="e">LUA_MASKCALL</span>, <span class="e">LUA_MASKRET</span>, <span class="e">LUA_MASKLINE</span>, and
        <span class="e">LUA_MASKCOUNT</span>. The <span class="e">count</span> argument <a href="motion.txt.html#is" class="d">is</a> only meaningful when the mask
        includes <span class="e">LUA_MASKCOUNT</span>. For each event, the hook <a href="motion.txt.html#is" class="d">is</a> called <a href="motion.txt.html#as" class="d">as</a>
        explained below:

         <a href="motion.txt.html#-" class="d">-</a> `The call hook`: <a href="motion.txt.html#is" class="d">is</a> called when the interpreter calls <a href="insert.txt.html#a" class="d">a</a> function.
           The hook <a href="motion.txt.html#is" class="d">is</a> called just after <a href="lua.txt.html#Lua" class="d">Lua</a> enters the new function, before
           the function gets its arguments.
         <a href="motion.txt.html#-" class="d">-</a> `The return hook`: <a href="motion.txt.html#is" class="d">is</a> called when the interpreter returns from <a href="insert.txt.html#a" class="d">a</a>
           function. The hook <a href="motion.txt.html#is" class="d">is</a> called just before <a href="lua.txt.html#Lua" class="d">Lua</a> leaves the function.
           You have no access to the values to be returned by the function.
         <a href="motion.txt.html#-" class="d">-</a> `The line hook`: <a href="motion.txt.html#is" class="d">is</a> called when the interpreter <a href="motion.txt.html#is" class="d">is</a> about to start
           the execution of <a href="insert.txt.html#a" class="d">a</a> new line of code, or when <a href="motion.txt.html#it" class="d">it</a> jumps back in the
           code (even to the same line). (This event only happens while <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a>
           executing <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function.)
         <a href="motion.txt.html#-" class="d">-</a> `The <a href="intro.txt.html#count" class="d">count</a> hook`: <a href="motion.txt.html#is" class="d">is</a> called after the interpreter executes every
           <span class="e">count</span> instructions. (This event only happens while <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a>
           executing <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function.)

        <a href="insert.txt.html#A" class="d">A</a> hook <a href="motion.txt.html#is" class="d">is</a> disabled by setting <span class="e">mask</span> to zero.

lua_setlocal                                                    <span id="lua_setlocal%28%29" class="t">lua_setlocal()</span>
&gt;c
    const char *lua_setlocal (lua_State *L, <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> *ar, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Sets the value of <a href="insert.txt.html#a" class="d">a</a> local variable of <a href="insert.txt.html#a" class="d">a</a> given activation record.
        Parameters <span class="e">ar</span> and <span class="e">n</span> are <a href="motion.txt.html#as" class="d">as</a> in <span class="e">lua_getlocal</span> (see
        <a href="luaref.txt.html#lua_getlocal%28%29" class="l">lua_getlocal()</a>). <span class="e">lua_setlocal</span> assigns the value <a href="motion.txt.html#at" class="d">at</a> the top of
        the stack to the variable and returns its name. It also pops the value
        from the stack.

        Returns <span class="e">NULL</span> (and pops nothing) when the <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> greater than the
        number of active local variables.

lua_setupvalue                                                <span id="lua_setupvalue%28%29" class="t">lua_setupvalue()</span>
&gt;c
    const char *lua_setupvalue (lua_State *L, int funcindex, int n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Sets the value of <a href="insert.txt.html#a" class="d">a</a> closure's upvalue. It assigns the value <a href="motion.txt.html#at" class="d">at</a> the top
        of the stack to the upvalue and returns its name. It also pops the
        value from the stack. Parameters <span class="e">funcindex</span> and <span class="e">n</span> are <a href="motion.txt.html#as" class="d">as</a> in the
        <span class="e">lua_getupvalue</span> (see <a href="luaref.txt.html#lua_getupvalue%28%29" class="l">lua_getupvalue()</a>).

        Returns <span class="e">NULL</span> (and pops nothing) when the <a href="index.txt.html#index" class="d">index</a> <a href="motion.txt.html#is" class="d">is</a> greater than the
        number of upvalues.

                                                           <span id="lua-debugexample" class="t">lua-debugexample</span>
        As an example, the following function lists the names of all local
        <a href="vimeval.txt.html#variables" class="d">variables</a> and upvalues <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> function <a href="motion.txt.html#at" class="d">at</a> <a href="insert.txt.html#a" class="d">a</a> given level of the stack:
&gt;c
               int listvars (lua_State *L, int level) <a href="motion.txt.html#%7B" class="d">{</a>
                 <a href="luaref.txt.html#lua_Debug" class="d">lua_Debug</a> ar;
                 int i;
                 const char *name;
                 if (lua_getstack(L, level, &amp;ar) <a href="change.txt.html#%3D%3D" class="d">==</a> 0)
                   return 0;  <a href="pattern.txt.html#%2F" class="d">/</a>* failure: no such level in the stack *<a href="pattern.txt.html#%2F" class="d">/</a>
                 <a href="insert.txt.html#i" class="d">i</a> <a href="change.txt.html#%3D" class="d">=</a> 1;
                 while ((name <a href="change.txt.html#%3D" class="d">=</a> lua_getlocal(L, &amp;ar, i++)) != NULL) <a href="motion.txt.html#%7B" class="d">{</a>
                   printf("local %d %s\n"<a href="motion.txt.html#%2C" class="d">,</a> i-1, name);
                   lua_pop(L, 1);  <a href="pattern.txt.html#%2F" class="d">/</a>* remove variable value *<a href="pattern.txt.html#%2F" class="d">/</a>
                 <a href="motion.txt.html#%7D" class="d">}</a>
                 lua_getinfo(L, "<a href="motion.txt.html#f" class="d">f</a>"<a href="motion.txt.html#%2C" class="d">,</a> &amp;ar);  <a href="pattern.txt.html#%2F" class="d">/</a>* retrieves function *<a href="pattern.txt.html#%2F" class="d">/</a>
                 <a href="insert.txt.html#i" class="d">i</a> <a href="change.txt.html#%3D" class="d">=</a> 1;
                 while ((name <a href="change.txt.html#%3D" class="d">=</a> lua_getupvalue(L, -1, i++)) != NULL) <a href="motion.txt.html#%7B" class="d">{</a>
                   printf("upvalue %d %s\n"<a href="motion.txt.html#%2C" class="d">,</a> i-1, name);
                   lua_pop(L, 1);  <a href="pattern.txt.html#%2F" class="d">/</a>* remove upvalue value *<a href="pattern.txt.html#%2F" class="d">/</a>
                 <a href="motion.txt.html#%7D" class="d">}</a>
                 return 1;
               <a href="motion.txt.html#%7D" class="d">}</a>
<a href="change.txt.html#%3C" class="d">&lt;</a>

<span class="h">==============================================================================</span>
4  THE AUXILIARY LIBRARY                                            <span id="lua-aux" class="t">lua-aux</span>

The auxiliary library provides several convenient <a href="vimeval.txt.html#functions" class="d">functions</a> to interface <a href="change.txt.html#C" class="d">C</a>
with Lua. While the basic <a href="api.txt.html#API" class="d">API</a> provides the primitive <a href="vimeval.txt.html#functions" class="d">functions</a> <a href="luaref.txt.html#for" class="d">for</a> all
interactions between <a href="change.txt.html#C" class="d">C</a> and Lua, the auxiliary library provides higher-level
<a href="vimeval.txt.html#functions" class="d">functions</a> <a href="luaref.txt.html#for" class="d">for</a> some common tasks.

All <a href="vimeval.txt.html#functions" class="d">functions</a> from the auxiliary library are defined in header file <span class="e">lauxlib.h</span>
and have <a href="insert.txt.html#a" class="d">a</a> prefix <span class="e">luaL_</span>.

All <a href="vimeval.txt.html#functions" class="d">functions</a> in the auxiliary library are built on top of the basic API, and
so they provide nothing that cannot be done with this API.

Several <a href="vimeval.txt.html#functions" class="d">functions</a> in the auxiliary library are used to check <a href="change.txt.html#C" class="d">C</a> function
arguments. Their names are always <span class="e">luaL_check*</span> or <span class="e">luaL_opt*</span>. All of these
<a href="vimeval.txt.html#functions" class="d">functions</a> raise an error if the check <a href="motion.txt.html#is" class="d">is</a> not satisfied. Because the error
message <a href="motion.txt.html#is" class="d">is</a> formatted <a href="luaref.txt.html#for" class="d">for</a> arguments (e.g., "bad argument #1"), you should not
use these <a href="vimeval.txt.html#functions" class="d">functions</a> <a href="luaref.txt.html#for" class="d">for</a> other stack values.

<span class="h">==============================================================================</span>
4.1  Functions and Types                                   <span id="lua-auxFunctions" class="t">lua-auxFunctions</span>

Here we <a href="vimeval.txt.html#list" class="d">list</a> all <a href="vimeval.txt.html#functions" class="d">functions</a> and types from the auxiliary library in
alphabetical order.

luaL_addchar                                                    <span id="luaL_addchar%28%29" class="t">luaL_addchar()</span>
&gt;c
    void luaL_addchar (luaL_Buffer *B, char c);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Adds the character <span class="e">c</span> to the buffer <span class="e">B</span> (see <a href="luaref.txt.html#luaL_Buffer" class="l">luaL_Buffer</a>).

luaL_addlstring                                              <span id="luaL_addlstring%28%29" class="t">luaL_addlstring()</span>
&gt;c
    void luaL_addlstring (luaL_Buffer *B, const char *s, size_t l);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Adds the <a href="vimeval.txt.html#string" class="d">string</a> pointed to by <span class="e">s</span> with length <span class="e">l</span> to the buffer <span class="e">B</span>
        (see <a href="luaref.txt.html#luaL_Buffer" class="l">luaL_Buffer</a>). The <a href="vimeval.txt.html#string" class="d">string</a> may contain embedded zeros.

luaL_addsize                                                    <span id="luaL_addsize%28%29" class="t">luaL_addsize()</span>
&gt;c
    void luaL_addsize (luaL_Buffer *B, size_t n);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Adds to the buffer <span class="e">B</span> (see <a href="luaref.txt.html#luaL_Buffer" class="l">luaL_Buffer</a><a href="motion.txt.html#%29" class="d">)</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> of length
        <span class="e">n</span> previously copied to the buffer area (see
        <a href="luaref.txt.html#luaL_prepbuffer%28%29" class="l">luaL_prepbuffer()</a>).

luaL_addstring                                                <span id="luaL_addstring%28%29" class="t">luaL_addstring()</span>
&gt;c
    void luaL_addstring (luaL_Buffer *B, const char *s);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Adds the zero-terminated <a href="vimeval.txt.html#string" class="d">string</a> pointed to by <span class="e">s</span> to the buffer <span class="e">B</span>
        (see <a href="luaref.txt.html#luaL_Buffer" class="l">luaL_Buffer</a>). The <a href="vimeval.txt.html#string" class="d">string</a> may not contain embedded zeros.

luaL_addvalue                                                  <span id="luaL_addvalue%28%29" class="t">luaL_addvalue()</span>
&gt;c
    void luaL_addvalue (luaL_Buffer *B);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Adds the value <a href="motion.txt.html#at" class="d">at</a> the top of the stack to the buffer <span class="e">B</span> (see
        <a href="luaref.txt.html#luaL_Buffer" class="l">luaL_Buffer</a>). Pops the value.

        This <a href="motion.txt.html#is" class="d">is</a> the only function on <a href="vimeval.txt.html#string" class="d">string</a> <a href="windows.txt.html#buffers" class="d">buffers</a> that can (and must) be
        called with an extra element on the stack, which <a href="motion.txt.html#is" class="d">is</a> the value to be
        added to the buffer.

luaL_argcheck                                                  <span id="luaL_argcheck%28%29" class="t">luaL_argcheck()</span>
&gt;c
    void luaL_argcheck (lua_State *L,
                        int cond,
                        int narg,
                        const char *extramsg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether <span class="e">cond</span> <a href="motion.txt.html#is" class="d">is</a> true. If not, raises an error with the
        following message, where <span class="e">func</span> <a href="motion.txt.html#is" class="d">is</a> retrieved from the call stack:

<span class="e">               bad argument #&lt;narg&gt; to &lt;func&gt; (&lt;extramsg&gt;)</span>


luaL_argerror                                                  <span id="luaL_argerror%28%29" class="t">luaL_argerror()</span>
&gt;c
    int luaL_argerror (lua_State *L, int narg, const char *extramsg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Raises an error with the following message, where <span class="e">func</span> <a href="motion.txt.html#is" class="d">is</a> retrieved
        from the call stack:

<span class="e">               bad argument #&lt;narg&gt; to &lt;func&gt; (&lt;extramsg&gt;)</span>

        This function never returns, but <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> an idiom to use <a href="motion.txt.html#it" class="d">it</a> in <a href="change.txt.html#C" class="d">C</a>
        <a href="vimeval.txt.html#functions" class="d">functions</a> <a href="motion.txt.html#as" class="d">as</a> `return luaL_argerror(` <span class="e">args</span> <span class="e">)</span>.

<a href="luaref.txt.html#luaL_Buffer" class="d">luaL_Buffer</a>                                                        <span id="luaL_Buffer" class="t">luaL_Buffer</span>
&gt;c
    typedef struct <a href="luaref.txt.html#luaL_Buffer" class="d">luaL_Buffer</a> luaL_Buffer;
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Type <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> `string buffer`.

        <a href="insert.txt.html#A" class="d">A</a> <a href="vimeval.txt.html#string" class="d">string</a> buffer allows <a href="change.txt.html#C" class="d">C</a> code to build <a href="lua.txt.html#Lua" class="d">Lua</a> strings piecemeal. Its
        <a href="pattern.txt.html#pattern" class="d">pattern</a> of use <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#as" class="d">as</a> follows:

         <a href="motion.txt.html#-" class="d">-</a> First you declare <a href="insert.txt.html#a" class="d">a</a> variable <span class="e">b</span> of type <span class="e">luaL_Buffer</span>.
         <a href="motion.txt.html#-" class="d">-</a> Then you initialize <a href="motion.txt.html#it" class="d">it</a> with <a href="insert.txt.html#a" class="d">a</a> call `luaL_buffinit(L, &amp;b)` (see
           <a href="luaref.txt.html#luaL_buffinit%28%29" class="l">luaL_buffinit()</a>).
         <a href="motion.txt.html#-" class="d">-</a> Then you add <a href="vimeval.txt.html#string" class="d">string</a> pieces to the buffer calling any of the
           <span class="e">luaL_add*</span> functions.
         <a href="motion.txt.html#-" class="d">-</a> You finish by calling <span class="e">luaL_pushresult(&amp;b)</span> (see
           <a href="luaref.txt.html#luaL_pushresult%28%29" class="l">luaL_pushresult()</a>). This call leaves the final <a href="vimeval.txt.html#string" class="d">string</a> on the
           top of the stack.

        During its normal operation, <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> buffer uses <a href="insert.txt.html#a" class="d">a</a> variable number of
        stack slots. So, while using <a href="insert.txt.html#a" class="d">a</a> buffer, you cannot assume that you know
        where the top of the stack is. You can use the stack between
        successive calls to buffer operations <a href="motion.txt.html#as" class="d">as</a> long <a href="motion.txt.html#as" class="d">as</a> that use <a href="motion.txt.html#is" class="d">is</a> balanced;
        that is, when you call <a href="insert.txt.html#a" class="d">a</a> buffer operation, the stack <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#at" class="d">at</a> the same
        level <a href="motion.txt.html#it" class="d">it</a> was immediately after the previous buffer operation. (The
        only exception to this rule <a href="motion.txt.html#is" class="d">is</a> <span class="e">luaL_addvalue</span>
        <a href="luaref.txt.html#luaL_addvalue%28%29" class="l">luaL_addvalue()</a>.) After calling <span class="e">luaL_pushresult</span> the stack <a href="motion.txt.html#is" class="d">is</a>
        back to its level when the buffer was initialized, plus the final
        <a href="vimeval.txt.html#string" class="d">string</a> on its top.

luaL_buffinit                                                  <span id="luaL_buffinit%28%29" class="t">luaL_buffinit()</span>
&gt;c
    void luaL_buffinit (lua_State *L, <a href="luaref.txt.html#luaL_Buffer" class="d">luaL_Buffer</a> *B);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Initializes <a href="insert.txt.html#a" class="d">a</a> buffer <span class="e">B</span>. This function does not allocate any space;
        the buffer must be declared <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> variable (see <a href="luaref.txt.html#luaL_Buffer" class="l">luaL_Buffer</a>).

luaL_callmeta                                                  <span id="luaL_callmeta%28%29" class="t">luaL_callmeta()</span>
&gt;c
    int luaL_callmeta (lua_State *L, int obj, const char *e);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Calls <a href="insert.txt.html#a" class="d">a</a> metamethod.

        If the object <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> <span class="e">obj</span> has <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> and this <a href="luaref.txt.html#metatable" class="d">metatable</a> has <a href="insert.txt.html#a" class="d">a</a>
        field <span class="e">e</span>, this function calls this field and passes the object <a href="motion.txt.html#as" class="d">as</a> its
        only argument. In this <a href="change.txt.html#case" class="d">case</a> this function returns 1 and pushes onto
        the stack the value returned by the call. If there <a href="motion.txt.html#is" class="d">is</a> no <a href="luaref.txt.html#metatable" class="d">metatable</a> or
        no metamethod, this function returns
        <a href="motion.txt.html#0" class="d">0</a> (without pushing any value on the stack).

luaL_checkany                                                  <span id="luaL_checkany%28%29" class="t">luaL_checkany()</span>
&gt;c
    void luaL_checkany (lua_State *L, int narg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function has an argument of any type (including
        <span class="e">nil</span>) <a href="motion.txt.html#at" class="d">at</a> position <span class="e">narg</span>.

luaL_checkint                                                  <span id="luaL_checkint%28%29" class="t">luaL_checkint()</span>
&gt;c
    int luaL_checkint (lua_State *L, int narg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number and returns
        this number cast to an <span class="e">int</span>.

luaL_checkinteger                                          <span id="luaL_checkinteger%28%29" class="t">luaL_checkinteger()</span>
&gt;c
    <a href="luaref.txt.html#lua_Integer" class="d">lua_Integer</a> luaL_checkinteger (lua_State *L, int narg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number and returns
        this number cast to <a href="insert.txt.html#a" class="d">a</a> <span class="e">lua_Integer</span> (see <a href="luaref.txt.html#lua_Integer" class="l">lua_Integer</a>).

luaL_checklong                                                <span id="luaL_checklong%28%29" class="t">luaL_checklong()</span>
&gt;c
    long luaL_checklong (lua_State *L, int narg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number and returns
        this number cast to <a href="insert.txt.html#a" class="d">a</a> <span class="e">long</span>.

luaL_checklstring                                          <span id="luaL_checklstring%28%29" class="t">luaL_checklstring()</span>
&gt;c
    const char *luaL_checklstring (lua_State *L, int narg, size_t *l);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> and returns
        this string; if <span class="e">l</span> <a href="motion.txt.html#is" class="d">is</a> not <span class="e">NULL</span> fills <span class="e">*l</span> with the string's length.

luaL_checknumber                                            <span id="luaL_checknumber%28%29" class="t">luaL_checknumber()</span>
&gt;c
    <a href="luaref.txt.html#lua_Number" class="d">lua_Number</a> luaL_checknumber (lua_State *L, int narg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number and returns
        this number (see <a href="luaref.txt.html#lua_Number" class="l">lua_Number</a>).

luaL_checkoption                                            <span id="luaL_checkoption%28%29" class="t">luaL_checkoption()</span>
&gt;c
    int luaL_checkoption (lua_State *L,
                          int narg,
                          const char *def,
                          const char *const lst[]);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> and searches
        <a href="luaref.txt.html#for" class="d">for</a> this <a href="vimeval.txt.html#string" class="d">string</a> in the array <span class="e">lst</span> (which must be NULL-terminated).
        Returns the <a href="index.txt.html#index" class="d">index</a> in the array where the <a href="vimeval.txt.html#string" class="d">string</a> was found. Raises an
        error if the argument <a href="motion.txt.html#is" class="d">is</a> not <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> or if the <a href="vimeval.txt.html#string" class="d">string</a> cannot be
        found.

        If <span class="e">def</span> <a href="motion.txt.html#is" class="d">is</a> not <span class="e">NULL</span>, the function uses <span class="e">def</span> <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> default value
        when there <a href="motion.txt.html#is" class="d">is</a> no argument <span class="e">narg</span> or if this argument <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>.

        This <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> useful function <a href="luaref.txt.html#for" class="d">for</a> <a href="map.txt.html#mapping" class="d">mapping</a> strings to <a href="change.txt.html#C" class="d">C</a> enums. (The usual
        convention in <a href="lua.txt.html#Lua" class="d">Lua</a> libraries <a href="motion.txt.html#is" class="d">is</a> to use strings instead of numbers to
        select options.)

luaL_checkstack                                              <span id="luaL_checkstack%28%29" class="t">luaL_checkstack()</span>
&gt;c
    void luaL_checkstack (lua_State *L, int sz, const char *msg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Grows the stack size to `top <a href="motion.txt.html#%2B" class="d">+</a> sz` elements, raising an error if the
        stack cannot grow to that size. <span class="e">msg</span> <a href="motion.txt.html#is" class="d">is</a> an additional text to <a href="motion.txt.html#go" class="d">go</a> into
        the error message.

luaL_checkstring                                            <span id="luaL_checkstring%28%29" class="t">luaL_checkstring()</span>
&gt;c
    const char *luaL_checkstring (lua_State *L, int narg);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> and returns
        this string.

luaL_checktype                                                <span id="luaL_checktype%28%29" class="t">luaL_checktype()</span>
&gt;c
    void luaL_checktype (lua_State *L, int narg, int t);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> has type <span class="e">t</span> (see
        <a href="luaref.txt.html#lua_type%28%29" class="l">lua_type()</a>).

luaL_checkudata                                              <span id="luaL_checkudata%28%29" class="t">luaL_checkudata()</span>
&gt;c
    void *luaL_checkudata (lua_State *L, int narg, const char *tname);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Checks whether the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#userdata" class="d">userdata</a> of the type
        <span class="e">tname</span> (see <a href="luaref.txt.html#luaL_newmetatable%28%29" class="l">luaL_newmetatable()</a>).

luaL_dofile                                                      <span id="luaL_dofile%28%29" class="t">luaL_dofile()</span>
&gt;c
    int luaL_dofile (lua_State *L, const char *filename);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Loads and runs the given file. It <a href="motion.txt.html#is" class="d">is</a> defined <a href="motion.txt.html#as" class="d">as</a> the following macro:
&gt;c
               (luaL_loadfile(L, filename) || lua_pcall(L, 0, LUA_MULTRET, 0))
<a href="change.txt.html#%3C" class="d">&lt;</a>
        It returns <a href="motion.txt.html#0" class="d">0</a> if there are no <a href="message.txt.html#errors" class="d">errors</a> or 1 in <a href="change.txt.html#case" class="d">case</a> of errors.

luaL_dostring                                                  <span id="luaL_dostring%28%29" class="t">luaL_dostring()</span>
&gt;c
    int luaL_dostring (lua_State *L, const char *str);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Loads and runs the given string. It <a href="motion.txt.html#is" class="d">is</a> defined <a href="motion.txt.html#as" class="d">as</a> the following macro:
&gt;c
               (luaL_loadstring(L, str) || lua_pcall(L, 0, LUA_MULTRET, 0))
<a href="change.txt.html#%3C" class="d">&lt;</a>
        It returns <a href="motion.txt.html#0" class="d">0</a> if there are no <a href="message.txt.html#errors" class="d">errors</a> or 1 in <a href="change.txt.html#case" class="d">case</a> of errors.

luaL_error                                                        <span id="luaL_error%28%29" class="t">luaL_error()</span>
&gt;c
    int luaL_error (lua_State *L, const char *fmt, ...);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Raises an error. The error message format <a href="motion.txt.html#is" class="d">is</a> given by <span class="e">fmt</span> plus any
        extra arguments, following the same rules of <span class="e">lua_pushfstring</span> (see
        <a href="luaref.txt.html#lua_pushfstring%28%29" class="l">lua_pushfstring()</a>). It also adds <a href="motion.txt.html#at" class="d">at</a> the beginning of the
        message the file name and the line number where the error occurred, if
        this information <a href="motion.txt.html#is" class="d">is</a> available.

        This function never returns, but <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> an idiom to use <a href="motion.txt.html#it" class="d">it</a> in <a href="change.txt.html#C" class="d">C</a>
        <a href="vimeval.txt.html#functions" class="d">functions</a> <a href="motion.txt.html#as" class="d">as</a> `return luaL_error(` <span class="e">args</span> <span class="e">)</span>.

luaL_getmetafield                                          <span id="luaL_getmetafield%28%29" class="t">luaL_getmetafield()</span>
&gt;c
    int luaL_getmetafield (lua_State *L, int obj, const char *e);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the field <span class="e">e</span> from the <a href="luaref.txt.html#metatable" class="d">metatable</a> of the object
        <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> <span class="e">obj</span>. If the object does not have <a href="insert.txt.html#a" class="d">a</a> metatable, or if the
        <a href="luaref.txt.html#metatable" class="d">metatable</a> does not have this field, returns <a href="motion.txt.html#0" class="d">0</a> and pushes nothing.

luaL_getmetatable                                          <span id="luaL_getmetatable%28%29" class="t">luaL_getmetatable()</span>
&gt;c
    void luaL_getmetatable (lua_State *L, const char *tname);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack the <a href="luaref.txt.html#metatable" class="d">metatable</a> associated with name <span class="e">tname</span> in
        the registry (see <a href="luaref.txt.html#luaL_newmetatable%28%29" class="l">luaL_newmetatable()</a>).

luaL_gsub                                                          <span id="luaL_gsub%28%29" class="t">luaL_gsub()</span>
&gt;c
    const char *luaL_gsub (lua_State *L,
                           const char *s,
                           const char *p,
                           const char *r);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Creates <a href="insert.txt.html#a" class="d">a</a> copy of <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">s</span> by <a href="change.txt.html#replacing" class="d">replacing</a> any occurrence of the <a href="vimeval.txt.html#string" class="d">string</a>
        <span class="e">p</span> with the <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">r</span>. Pushes the resulting <a href="vimeval.txt.html#string" class="d">string</a> on the stack and
        returns it.

luaL_loadbuffer                                              <span id="luaL_loadbuffer%28%29" class="t">luaL_loadbuffer()</span>
&gt;c
    int luaL_loadbuffer (lua_State *L,
                         const char *buff,
                         size_t sz,
                         const char *name);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Loads <a href="insert.txt.html#a" class="d">a</a> buffer <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> chunk. This function uses <span class="e">lua_load</span> (see
        <a href="luaref.txt.html#lua_load%28%29" class="l">lua_load()</a><a href="motion.txt.html#%29" class="d">)</a> to load the chunk in the buffer pointed to by
        <span class="e">buff</span> with size <span class="e">sz</span>.

        This function returns the same results <a href="motion.txt.html#as" class="d">as</a> <span class="e">lua_load</span>. <span class="e">name</span> <a href="motion.txt.html#is" class="d">is</a> the
        chunk name, used <a href="luaref.txt.html#for" class="d">for</a> debug information and error messages.

luaL_loadfile                                                  <span id="luaL_loadfile%28%29" class="t">luaL_loadfile()</span>
&gt;c
    int luaL_loadfile (lua_State *L, const char *filename);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Loads <a href="insert.txt.html#a" class="d">a</a> file <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> chunk. This function uses <span class="e">lua_load</span> (see
        <a href="luaref.txt.html#lua_load%28%29" class="l">lua_load()</a><a href="motion.txt.html#%29" class="d">)</a> to load the chunk in the file named <span class="e">filename</span>. If
        <span class="e">filename</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">NULL</span>, then <a href="motion.txt.html#it" class="d">it</a> loads from the standard input. The first
        line in the file <a href="motion.txt.html#is" class="d">is</a> ignored if <a href="motion.txt.html#it" class="d">it</a> starts with <a href="insert.txt.html#a" class="d">a</a> <span class="e">#</span>.

        This function returns the same results <a href="motion.txt.html#as" class="d">as</a> <span class="e">lua_load</span>, but <a href="motion.txt.html#it" class="d">it</a> has an
        extra error code <span class="e">LUA_ERRFILE</span> if <a href="motion.txt.html#it" class="d">it</a> cannot open/read the file.

        As <span class="e">lua_load</span>, this function only loads the chunk; <a href="motion.txt.html#it" class="d">it</a> does not run it.

luaL_loadstring                                              <span id="luaL_loadstring%28%29" class="t">luaL_loadstring()</span>
&gt;c
    int luaL_loadstring (lua_State *L, const char *s);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Loads <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> chunk. This function uses <span class="e">lua_load</span> (see
        <a href="luaref.txt.html#lua_load%28%29" class="l">lua_load()</a><a href="motion.txt.html#%29" class="d">)</a> to load the chunk in the zero-terminated <a href="vimeval.txt.html#string" class="d">string</a>
        <span class="e">s</span>.

        This function returns the same results <a href="motion.txt.html#as" class="d">as</a> <span class="e">lua_load</span>.

        Also <a href="motion.txt.html#as" class="d">as</a> <span class="e">lua_load</span>, this function only loads the chunk; <a href="motion.txt.html#it" class="d">it</a> does not
        run it.

luaL_newmetatable                                          <span id="luaL_newmetatable%28%29" class="t">luaL_newmetatable()</span>
&gt;c
    int luaL_newmetatable (lua_State *L, const char *tname);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the registry already has the key <span class="e">tname</span>, returns 0. Otherwise,
        creates <a href="insert.txt.html#a" class="d">a</a> new table to be used <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="luaref.txt.html#for" class="d">for</a> userdata, adds <a href="motion.txt.html#it" class="d">it</a> to
        the registry with key <span class="e">tname</span>, and returns 1.

        In both cases pushes onto the stack the final value associated with
        <span class="e">tname</span> in the registry.

luaL_newstate                                                  <span id="luaL_newstate%28%29" class="t">luaL_newstate()</span>
&gt;c
    <a href="luaref.txt.html#lua_State" class="d">lua_State</a> *luaL_newstate (void);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Creates <a href="insert.txt.html#a" class="d">a</a> new <a href="lua.txt.html#Lua" class="d">Lua</a> state. It calls <span class="e">lua_newstate</span> (see
        <a href="luaref.txt.html#lua_newstate%28%29" class="l">lua_newstate()</a><a href="motion.txt.html#%29" class="d">)</a> with an allocator based on the standard <a href="change.txt.html#C" class="d">C</a>
        <span class="e">realloc</span> function and then sets <a href="insert.txt.html#a" class="d">a</a> panic function (see
        <a href="luaref.txt.html#lua_atpanic%28%29" class="l">lua_atpanic()</a><a href="motion.txt.html#%29" class="d">)</a> that prints an error message to the standard
        error output in <a href="change.txt.html#case" class="d">case</a> of fatal errors.

        Returns the new state, or <span class="e">NULL</span> if there <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> memory allocation
        error.

luaL_openlibs                                                  <span id="luaL_openlibs%28%29" class="t">luaL_openlibs()</span>
&gt;c
    void luaL_openlibs (lua_State *L);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Opens all standard <a href="lua.txt.html#Lua" class="d">Lua</a> libraries into the given state. See also
        <a href="luaref.txt.html#lua-openlibs" class="l">lua-openlibs</a> <a href="luaref.txt.html#for" class="d">for</a> details on how to open individual libraries.

luaL_optint                                                      <span id="luaL_optint%28%29" class="t">luaL_optint()</span>
&gt;c
    int luaL_optint (lua_State *L, int narg, int d);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number, returns this number cast
        to an <span class="e">int</span>. If this argument <a href="motion.txt.html#is" class="d">is</a> absent or <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, returns <span class="e">d</span>.
        Otherwise, raises an error.

luaL_optinteger                                              <span id="luaL_optinteger%28%29" class="t">luaL_optinteger()</span>
&gt;c
    <a href="luaref.txt.html#lua_Integer" class="d">lua_Integer</a> luaL_optinteger (lua_State *L,
                                 int narg,
                                 <a href="luaref.txt.html#lua_Integer" class="d">lua_Integer</a> d);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number, returns this number cast
        to <a href="insert.txt.html#a" class="d">a</a> <span class="e">lua_Integer</span> (see <a href="luaref.txt.html#lua_Integer" class="l">lua_Integer</a>). If this argument <a href="motion.txt.html#is" class="d">is</a>
        absent or <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, returns <span class="e">d</span>. Otherwise, raises an error.

luaL_optlong                                                    <span id="luaL_optlong%28%29" class="t">luaL_optlong()</span>
&gt;c
    long luaL_optlong (lua_State *L, int narg, long d);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number, returns this number cast
        to <a href="insert.txt.html#a" class="d">a</a> <span class="e">long</span>. If this argument <a href="motion.txt.html#is" class="d">is</a> absent or <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, returns <span class="e">d</span>.
        Otherwise, raises an error.

luaL_optlstring                                              <span id="luaL_optlstring%28%29" class="t">luaL_optlstring()</span>
&gt;c
    const char *luaL_optlstring (lua_State *L,
                                 int narg,
                                 const char *d,
                                 size_t *l);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> string, returns this string. If
        this argument <a href="motion.txt.html#is" class="d">is</a> absent or <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, returns <span class="e">d</span>. Otherwise, raises an
        error.

        If <span class="e">l</span> <a href="motion.txt.html#is" class="d">is</a> not <span class="e">NULL</span>, fills the position <span class="e">*l</span> with the results' length.

luaL_optnumber                                                <span id="luaL_optnumber%28%29" class="t">luaL_optnumber()</span>
&gt;c
    <a href="luaref.txt.html#lua_Number" class="d">lua_Number</a> luaL_optnumber (lua_State *L, int narg, <a href="luaref.txt.html#lua_Number" class="d">lua_Number</a> d);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number, returns this number. If
        this argument <a href="motion.txt.html#is" class="d">is</a> absent or <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, returns <span class="e">d</span>. Otherwise, raises an
        error.

luaL_optstring                                                <span id="luaL_optstring%28%29" class="t">luaL_optstring()</span>
&gt;c
    const char *luaL_optstring (lua_State *L,
                                int narg,
                                const char *d);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        If the function argument <span class="e">narg</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> string, returns this string. If
        this argument <a href="motion.txt.html#is" class="d">is</a> absent or <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, returns <span class="e">d</span>. Otherwise, raises an
        error.

luaL_prepbuffer                                              <span id="luaL_prepbuffer%28%29" class="t">luaL_prepbuffer()</span>
&gt;c
    char *luaL_prepbuffer (luaL_Buffer *B);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns an address to <a href="insert.txt.html#a" class="d">a</a> <a href="intro.txt.html#space" class="d">space</a> of size <span class="e">LUAL_BUFFERSIZE</span> where you can
        copy <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> to be added to buffer <span class="e">B</span> (see <a href="luaref.txt.html#luaL_Buffer" class="l">luaL_Buffer</a>).
        After <a href="uganda.txt.html#copying" class="d">copying</a> the <a href="vimeval.txt.html#string" class="d">string</a> into this <a href="intro.txt.html#space" class="d">space</a> you must call <span class="e">luaL_addsize</span>
        (see <a href="luaref.txt.html#luaL_addsize%28%29" class="l">luaL_addsize()</a><a href="motion.txt.html#%29" class="d">)</a> with the size of the <a href="vimeval.txt.html#string" class="d">string</a> to actually
        add <a href="motion.txt.html#it" class="d">it</a> to the buffer.

luaL_pushresult                                              <span id="luaL_pushresult%28%29" class="t">luaL_pushresult()</span>
&gt;c
    void luaL_pushresult (luaL_Buffer *B);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Finishes the use of buffer <span class="e">B</span> leaving the final <a href="vimeval.txt.html#string" class="d">string</a> on the top of
        the stack.

luaL_ref                                                            <span id="luaL_ref%28%29" class="t">luaL_ref()</span>
&gt;c
    int luaL_ref (lua_State *L, int t);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Creates and returns <a href="insert.txt.html#a" class="d">a</a> <span class="e">reference</span>, in the table <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> <span class="e">t</span>, <a href="luaref.txt.html#for" class="d">for</a> the
        object <a href="motion.txt.html#at" class="d">at</a> the top of the stack (and pops the object).

        <a href="insert.txt.html#A" class="d">A</a> <a href="intro.txt.html#reference" class="d">reference</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> unique integer key. As long <a href="motion.txt.html#as" class="d">as</a> you <a href="diff.txt.html#do" class="d">do</a> not manually
        add integer keys into table <span class="e">t</span>, <span class="e">luaL_ref</span> ensures the uniqueness of
        the key <a href="motion.txt.html#it" class="d">it</a> returns. You can retrieve an object referred by <a href="intro.txt.html#reference" class="d">reference</a>
        <span class="e">r</span> by calling `lua_rawgeti(L, t, r)` (see <a href="luaref.txt.html#lua_rawgeti%28%29" class="l">lua_rawgeti()</a>).
        Function <span class="e">luaL_unref</span> (see <a href="luaref.txt.html#luaL_unref%28%29" class="l">luaL_unref()</a><a href="motion.txt.html#%29" class="d">)</a> frees <a href="insert.txt.html#a" class="d">a</a> <a href="intro.txt.html#reference" class="d">reference</a> and
        its associated object.

        If the object <a href="motion.txt.html#at" class="d">at</a> the top of the stack <a href="motion.txt.html#is" class="d">is</a> <span class="e">nil</span>, <span class="e">luaL_ref</span> returns the
        constant <span class="e">LUA_REFNIL</span>. The constant <span class="e">LUA_NOREF</span> <a href="motion.txt.html#is" class="d">is</a> guaranteed to be
        different from any <a href="intro.txt.html#reference" class="d">reference</a> returned by <span class="e">luaL_ref</span>.

<a href="luaref.txt.html#luaL_Reg" class="d">luaL_Reg</a>                                                              <span id="luaL_Reg" class="t">luaL_Reg</span>
&gt;c
    typedef struct <a href="luaref.txt.html#luaL_Reg" class="d">luaL_Reg</a> <a href="motion.txt.html#%7B" class="d">{</a>
        const char *name;
        <a href="luaref.txt.html#lua_CFunction" class="d">lua_CFunction</a> func;
    <a href="motion.txt.html#%7D" class="d">}</a> luaL_Reg;
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Type <a href="luaref.txt.html#for" class="d">for</a> arrays of <a href="vimeval.txt.html#functions" class="d">functions</a> to be registered by <span class="e">luaL_register</span>  (see
        <a href="luaref.txt.html#luaL_register%28%29" class="l">luaL_register()</a>). <span class="e">name</span> <a href="motion.txt.html#is" class="d">is</a> the function name and <span class="e">func</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a>
        pointer to the function. Any array of <span class="e">luaL_Reg</span> must <a href="intro.txt.html#end" class="d">end</a> with <a href="insert.txt.html#a" class="d">a</a>
        sentinel entry in which both <span class="e">name</span> and <span class="e">func</span> are <span class="e">NULL</span>.

luaL_register                                                  <span id="luaL_register%28%29" class="t">luaL_register()</span>
&gt;c
    void luaL_register (lua_State *L,
                        const char *libname,
                        const <a href="luaref.txt.html#luaL_Reg" class="d">luaL_Reg</a> *l);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Opens <a href="insert.txt.html#a" class="d">a</a> library.

        When called with <span class="e">libname</span> equal to <span class="e">NULL</span>, <a href="motion.txt.html#it" class="d">it</a> simply <a href="change.txt.html#registers" class="d">registers</a> all
        <a href="vimeval.txt.html#functions" class="d">functions</a> in the <a href="vimeval.txt.html#list" class="d">list</a> <span class="e">l</span> (see <a href="luaref.txt.html#luaL_Reg" class="l">luaL_Reg</a><a href="motion.txt.html#%29" class="d">)</a> into the table on
        the top of the stack.

        When called with <a href="insert.txt.html#a" class="d">a</a> non-null <span class="e">libname</span>, <span class="e">luaL_register</span> creates <a href="insert.txt.html#a" class="d">a</a> new
        table <span class="e">t</span>, sets <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#as" class="d">as</a> the value of the global variable <span class="e">libname</span>, sets
        <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#as" class="d">as</a> the value of <span class="e">package.loaded[libname]</span>, and <a href="change.txt.html#registers" class="d">registers</a> on <a href="motion.txt.html#it" class="d">it</a> all
        <a href="vimeval.txt.html#functions" class="d">functions</a> in the <a href="vimeval.txt.html#list" class="d">list</a> <span class="e">l</span>. If there <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> table in
        <span class="e">package.loaded[libname]</span> or in variable <span class="e">libname</span>, reuses this table
        instead of creating <a href="insert.txt.html#a" class="d">a</a> new one.

        In any <a href="change.txt.html#case" class="d">case</a> the function leaves the table on the top of the stack.

luaL_typename                                                  <span id="luaL_typename%28%29" class="t">luaL_typename()</span>
&gt;c
    const char *luaL_typename (lua_State *L, int idx);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Returns the name of the type of the value <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> <span class="e">idx</span>.

luaL_typerror                                                  <span id="luaL_typerror%28%29" class="t">luaL_typerror()</span>
&gt;c
    int luaL_typerror (lua_State *L, int narg, const char *tname);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Generates an error with <a href="insert.txt.html#a" class="d">a</a> message like the following:

          <span class="e">location</span>  `: bad argument`  <span class="e">narg</span>  <span class="e">to</span>  <span class="e">'func'</span>  <span class="e">(</span>  <span class="e">tname</span>
          `expected, got`  <span class="e">rt</span>  <span class="e">)</span>

        where <span class="e">location</span> <a href="motion.txt.html#is" class="d">is</a> produced by <span class="e">luaL_where</span>  (see
        <a href="luaref.txt.html#luaL_where%28%29" class="l">luaL_where()</a>), <span class="e">func</span> <a href="motion.txt.html#is" class="d">is</a> the name of the current function, and
        <span class="e">rt</span> <a href="motion.txt.html#is" class="d">is</a> the type name of the actual argument.

luaL_unref                                                        <span id="luaL_unref%28%29" class="t">luaL_unref()</span>
&gt;c
    void luaL_unref (lua_State *L, int t, int ref);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Releases <a href="intro.txt.html#reference" class="d">reference</a> <span class="e">ref</span> from the table <a href="motion.txt.html#at" class="d">at</a> <a href="index.txt.html#index" class="d">index</a> <span class="e">t</span> (see
        <a href="luaref.txt.html#luaL_ref%28%29" class="l">luaL_ref()</a>). The entry <a href="motion.txt.html#is" class="d">is</a> removed from the table, so that the
        referred object can be collected. The <a href="intro.txt.html#reference" class="d">reference</a> <span class="e">ref</span> <a href="motion.txt.html#is" class="d">is</a> also freed to
        be used again.

        If <span class="e">ref</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">LUA_NOREF</span> or <span class="e">LUA_REFNIL</span>, <span class="e">luaL_unref</span> does nothing.

luaL_where                                                        <span id="luaL_where%28%29" class="t">luaL_where()</span>
&gt;c
    void luaL_where (lua_State *L, int lvl);
<a href="change.txt.html#%3C" class="d">&lt;</a>
        Pushes onto the stack <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> identifying the current position of the
        <a href="intro.txt.html#control" class="d">control</a> <a href="motion.txt.html#at" class="d">at</a> level <span class="e">lvl</span> in the call stack. Typically this <a href="vimeval.txt.html#string" class="d">string</a> has
        the following format:

            <span class="e">chunkname:currentline:</span>

        Level <a href="motion.txt.html#0" class="d">0</a> <a href="motion.txt.html#is" class="d">is</a> the running function, level 1 <a href="motion.txt.html#is" class="d">is</a> the function that called
        the running function, etc.

        This function <a href="motion.txt.html#is" class="d">is</a> used to build <a href="insert.txt.html#a" class="d">a</a> prefix <a href="luaref.txt.html#for" class="d">for</a> error messages.

<span class="h">==============================================================================</span>
5  STANDARD LIBRARIES                                               <span id="lua-lib" class="t">lua-lib</span>

The standard libraries provide useful <a href="vimeval.txt.html#functions" class="d">functions</a> that are implemented directly
through the <a href="change.txt.html#C" class="d">C</a> API. Some of these <a href="vimeval.txt.html#functions" class="d">functions</a> provide essential services to the
language (e.g., <span class="e">type</span> and <span class="e">getmetatable</span>); others provide access to "outside"
services (e.g., I/O); and others could be implemented in <a href="lua.txt.html#Lua" class="d">Lua</a> itself, but are
quite useful or have critical performance requirements that deserve an
implementation in <a href="change.txt.html#C" class="d">C</a> (e.g., <span class="e">sort</span>).

All libraries are implemented through the official <a href="change.txt.html#C" class="d">C</a> <a href="api.txt.html#API" class="d">API</a> and are provided <a href="motion.txt.html#as" class="d">as</a>
separate <a href="change.txt.html#C" class="d">C</a> modules. Currently, <a href="lua.txt.html#Lua" class="d">Lua</a> has the following standard libraries:

<a href="motion.txt.html#-" class="d">-</a> basic library;
<a href="motion.txt.html#-" class="d">-</a> package library;
<a href="motion.txt.html#-" class="d">-</a> <a href="vimeval.txt.html#string" class="d">string</a> manipulation;
<a href="motion.txt.html#-" class="d">-</a> table manipulation;
<a href="motion.txt.html#-" class="d">-</a> mathematical <a href="vimeval.txt.html#functions" class="d">functions</a> (sin, log, etc.);
<a href="motion.txt.html#-" class="d">-</a> input and output;
<a href="motion.txt.html#-" class="d">-</a> operating system facilities;
<a href="motion.txt.html#-" class="d">-</a> debug facilities.

Except <a href="luaref.txt.html#for" class="d">for</a> the basic and package libraries, each library provides all its
<a href="vimeval.txt.html#functions" class="d">functions</a> <a href="motion.txt.html#as" class="d">as</a> fields of <a href="insert.txt.html#a" class="d">a</a> global table or <a href="motion.txt.html#as" class="d">as</a> methods of its objects.

                                                               <span id="lua-openlibs" class="t">lua-openlibs</span>
To have access to these libraries, the <a href="change.txt.html#C" class="d">C</a> host program should call the
<span class="e">luaL_openlibs</span> function, which opens all standard libraries (see
<a href="luaref.txt.html#luaL_openlibs%28%29" class="l">luaL_openlibs()</a>). Alternatively, the host program can open the libraries
individually by calling <span class="e">luaopen_base</span> (for the basic library),
<span class="e">luaopen_package</span> (for the package library), <span class="e">luaopen_string</span> (for the <a href="vimeval.txt.html#string" class="d">string</a>
library), <span class="e">luaopen_table</span> (for the table library), <span class="e">luaopen_math</span> (for the
mathematical library), <span class="e">luaopen_io</span> (for the I/O and the Operating System
libraries), and <span class="e">luaopen_debug</span> (for the debug library). These <a href="vimeval.txt.html#functions" class="d">functions</a> are
declared in <span class="e">lualib.h</span> and should not be called directly: you must call them
like any other <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="change.txt.html#C" class="d">C</a> function, e.g., by using <span class="e">lua_call</span> (see <a href="luaref.txt.html#lua_call%28%29" class="l">lua_call()</a>).

<span class="h">==============================================================================</span>
5.1  Basic Functions                                           <span id="lua-lib-core" class="t">lua-lib-core</span>

The basic library provides some core <a href="vimeval.txt.html#functions" class="d">functions</a> to Lua. If you <a href="diff.txt.html#do" class="d">do</a> not include
this library in your application, you should check carefully whether you need
to provide implementations <a href="luaref.txt.html#for" class="d">for</a> some of its facilities.

assert({v} [, <span class="s">{message}</span>])                               <span id="assert%28%29" class="t">assert()</span>
    Issues an error when the value of its argument <span class="e">v</span> <a href="motion.txt.html#is" class="d">is</a> false (i.e., <span class="e">nil</span> or
    <span class="e">false</span>); otherwise, returns all its arguments. <span class="e">message</span> <a href="motion.txt.html#is" class="d">is</a> an error message;
    when absent, <a href="motion.txt.html#it" class="d">it</a> <a href="vim_diff.txt.html#defaults" class="d">defaults</a> to "assertion failed!"

collectgarbage({opt} [, <span class="s">{arg}</span>])                         <span id="collectgarbage%28%29" class="t">collectgarbage()</span>
        This function <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> generic interface to the garbage collector. It
        performs different <a href="vimeval.txt.html#functions" class="d">functions</a> according to its first argument, <span class="s">{opt}</span>:

        <span class="e">"stop"</span>       stops the garbage collector.
        <span class="e">"restart"</span>    restarts the garbage collector.
        <span class="e">"collect"</span>    performs <a href="insert.txt.html#a" class="d">a</a> full garbage-collection cycle.
        <span class="e">"count"</span>      returns the total memory in use by <a href="lua.txt.html#Lua" class="d">Lua</a> (in Kbytes).
        <span class="e">"step"</span>       performs <a href="insert.txt.html#a" class="d">a</a> garbage-collection step. The step "size" <a href="motion.txt.html#is" class="d">is</a>
                     controlled by <span class="s">{arg}</span> (larger values mean more steps) in <a href="insert.txt.html#a" class="d">a</a>
                     non-specified way. If you want to <a href="intro.txt.html#control" class="d">control</a> the step size
                     you must experimentally tune the value of <span class="s">{arg}</span>. Returns
                     <span class="e">true</span> if the step finished <a href="insert.txt.html#a" class="d">a</a> collection cycle.
        <span class="e">"setpause"</span>   sets <span class="s">{arg}</span> /100 <a href="motion.txt.html#as" class="d">as</a> the new value <a href="luaref.txt.html#for" class="d">for</a> the <span class="e">pause</span> of
                     the collector (see <a href="luaref.txt.html#lua-gc" class="l">lua-gc</a>).
        <span class="e">"setstepmul"</span> sets <span class="s">{arg}</span> /100 <a href="motion.txt.html#as" class="d">as</a> the new value <a href="luaref.txt.html#for" class="d">for</a> the `step
                     multiplier` of the collector (see <a href="luaref.txt.html#lua-gc" class="l">lua-gc</a>).

dofile({filename})                                      <span id="dofile%28%29" class="t">dofile()</span>
        Opens the named file and executes its contents <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> chunk. When
        called without arguments, <span class="e">dofile</span> executes the contents of the
        standard input (`stdin`). Returns all values returned by the chunk. In
        <a href="change.txt.html#case" class="d">case</a> of errors, <span class="e">dofile</span> propagates the error to its caller (that is,
        <span class="e">dofile</span> does not run in protected mode).

error({message} [, <span class="s">{level}</span>])                            <span id="error%28%29" class="t">error()</span>
        Terminates the last protected function called and returns <span class="e">message</span> <a href="motion.txt.html#as" class="d">as</a>
        the error message. Function <span class="s">{error}</span> never returns.

        Usually, <span class="s">{error}</span> adds some information about the error position <a href="motion.txt.html#at" class="d">at</a> the
        beginning of the message. The <span class="s">{level}</span> argument specifies how to get
        the error position. With level 1 (the default), the error position <a href="motion.txt.html#is" class="d">is</a>
        where the <span class="s">{error}</span> function was called. Level 2 points the error to
        where the function that called <span class="s">{error}</span> was called; and so on. Passing
        <a href="insert.txt.html#a" class="d">a</a> level <a href="motion.txt.html#0" class="d">0</a> avoids the addition of error position information to the
        message.

<a href="luaref.txt.html#_G" class="d">_G</a>                                                      <span id="_G" class="t">_G</span>
        <a href="insert.txt.html#A" class="d">A</a> global variable (not <a href="insert.txt.html#a" class="d">a</a> function) that holds the global environment
        (that is, `_G._G <a href="change.txt.html#%3D" class="d">=</a> _G`). <a href="lua.txt.html#Lua" class="d">Lua</a> itself does not use this variable;
        <a href="change.txt.html#changing" class="d">changing</a> its value does not affect any environment, nor vice-versa.
        (Use <span class="e">setfenv</span> to change environments.)

getfenv({f})                                            <span id="getfenv%28%29" class="t">getfenv()</span>
        Returns the current environment in use by the function. <span class="s">{f}</span> can be <a href="insert.txt.html#a" class="d">a</a>
        <a href="lua.txt.html#Lua" class="d">Lua</a> function or <a href="insert.txt.html#a" class="d">a</a> number that specifies the function <a href="motion.txt.html#at" class="d">at</a> that stack
        level: Level 1 <a href="motion.txt.html#is" class="d">is</a> the function calling <span class="e">getfenv</span>. If the given
        function <a href="motion.txt.html#is" class="d">is</a> not <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function, or if <span class="s">{f}</span> <a href="motion.txt.html#is" class="d">is</a> 0, <span class="e">getfenv</span> returns the
        global environment. The default <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{f}</span> <a href="motion.txt.html#is" class="d">is</a> 1.

getmetatable({object})                                  <span id="getmetatable%28%29" class="t">getmetatable()</span>
        If <span class="s">{object}</span> does not have <a href="insert.txt.html#a" class="d">a</a> metatable, returns <span class="e">nil</span>. Otherwise, if
        the object's <a href="luaref.txt.html#metatable" class="d">metatable</a> has <a href="insert.txt.html#a" class="d">a</a> <span class="e">"__metatable"</span> field, returns the
        associated value. Otherwise, returns the <a href="luaref.txt.html#metatable" class="d">metatable</a> of the given
        object.

ipairs({t})                                             <span id="ipairs%28%29" class="t">ipairs()</span>
        Returns three values: an <a href="lua.txt.html#iterator" class="l">iterator</a> function, the table <span class="s">{t}</span>, and 0, so
        that the construction

               `for i,v in ipairs(t) do`  <span class="e">body</span>  <span class="e">end</span>

        will iterate over the pairs (`1,t[1]`), (`2,t[2]`), ..., up to the
        first integer key absent from the table.

load({func} [, <span class="s">{chunkname}</span>])                            <span id="load%28%29" class="t">load()</span>
        Loads <a href="insert.txt.html#a" class="d">a</a> chunk using function <span class="s">{func}</span> to get its pieces. Each call to
        <span class="s">{func}</span> must return <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> that concatenates with previous results. <a href="insert.txt.html#A" class="d">A</a>
        return of <span class="e">nil</span> (or no value) signals the <a href="intro.txt.html#end" class="d">end</a> of the chunk.

        If there are no errors, returns the compiled chunk <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> function;
        otherwise, returns <span class="e">nil</span> plus the error message. The environment of
        the returned function <a href="motion.txt.html#is" class="d">is</a> the global environment.

        <span class="s">{chunkname}</span> <a href="motion.txt.html#is" class="d">is</a> used <a href="motion.txt.html#as" class="d">as</a> the chunk name <a href="luaref.txt.html#for" class="d">for</a> error <a href="message.txt.html#messages" class="d">messages</a> and debug
        information.

loadfile([{filename}])                                  <span id="loadfile%28%29" class="t">loadfile()</span>
        Similar to <span class="e">load</span> (see <a href="luaref.txt.html#load%28%29" class="l">load()</a>), but gets the chunk from file
        <span class="s">{filename}</span> or from the standard input, if no file name <a href="motion.txt.html#is" class="d">is</a> given.

loadstring({string} [, <span class="s">{chunkname}</span>])                    <span id="loadstring%28%29" class="t">loadstring()</span>
        Similar to <span class="e">load</span> (see <a href="luaref.txt.html#load%28%29" class="l">load()</a>), but gets the chunk from the
        given <span class="s">{string}</span>.

        To load and run <a href="insert.txt.html#a" class="d">a</a> given string, use the idiom

<span class="e">               assert(loadstring(s))()</span>


next({table} [, <span class="s">{index}</span>])                               <span id="next%28%29" class="t">next()</span>
        Allows <a href="insert.txt.html#a" class="d">a</a> program to traverse all fields of <a href="insert.txt.html#a" class="d">a</a> table. Its first argument
        <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> table and its second argument <a href="motion.txt.html#is" class="d">is</a> an <a href="index.txt.html#index" class="d">index</a> in this table. <span class="e">next</span>
        returns the next <a href="index.txt.html#index" class="d">index</a> of the table and its associated value. When
        called with <span class="e">nil</span> <a href="motion.txt.html#as" class="d">as</a> its second argument, <span class="e">next</span> returns an initial
        <a href="index.txt.html#index" class="d">index</a> and its associated value. When called with the last index, or
        with <span class="e">nil</span> in an empty table, <span class="e">next</span> returns <span class="e">nil</span>. If the second
        argument <a href="motion.txt.html#is" class="d">is</a> absent, then <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> interpreted <a href="motion.txt.html#as" class="d">as</a> <span class="e">nil</span>. In particular,
        you can use <span class="e">next(t)</span> to check whether <a href="insert.txt.html#a" class="d">a</a> table <a href="motion.txt.html#is" class="d">is</a> empty.

        The order in which the indices are enumerated <a href="motion.txt.html#is" class="d">is</a> not specified, even
        <a href="luaref.txt.html#for" class="d">for</a> numeric indices. (To traverse <a href="insert.txt.html#a" class="d">a</a> table in numeric order, use <a href="insert.txt.html#a" class="d">a</a>
        numerical <span class="e">for</span> or the <a href="luaref.txt.html#ipairs%28%29" class="l">ipairs()</a> function.)

        The behavior of <span class="e">next</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">undefined</span> if, during the traversal, you
        assign any value to <a href="insert.txt.html#a" class="d">a</a> non-existent field in the table. You may however
        modify existing fields. In particular, you may clear existing fields.

pairs({t})                                              <span id="pairs%28%29" class="t">pairs()</span>
        Returns three values: the <a href="luaref.txt.html#next%28%29" class="l">next()</a> function, the table <span class="s">{t}</span>, and <span class="e">nil</span>,
        so that the construction

               `for k,v in pairs(t) do`  <span class="e">body</span>  <span class="e">end</span>

        will iterate over all key-value pairs of table <span class="s">{t}</span>.

pcall({f}, <span class="s">{arg1}</span>, <span class="s">{...}</span>)                               <span id="pcall%28%29" class="t">pcall()</span>
        Calls function <span class="s">{f}</span> with the given arguments in `protected mode`. This
        means that any error inside <span class="s">{f}</span> <a href="motion.txt.html#is" class="d">is</a> not propagated; instead, <span class="e">pcall</span>
        catches the error and returns <a href="insert.txt.html#a" class="d">a</a> status code. Its first result <a href="motion.txt.html#is" class="d">is</a> the
        status code (a boolean), which <a href="motion.txt.html#is" class="d">is</a> <span class="e">true</span> if the call succeeds without
        errors. In such case, <span class="e">pcall</span> also returns all results from the call,
        after this first result. In <a href="change.txt.html#case" class="d">case</a> of any error, <span class="e">pcall</span> returns <span class="e">false</span>
        plus the error message.

print({...})                                            <span id="print%28%29" class="t">print()</span>
        Receives any number of arguments, and prints their values to <span class="e">stdout</span>,
        using the <span class="e">tostring</span> <a href="luaref.txt.html#tostring%28%29" class="l">tostring()</a> function to convert them to
        strings. <span class="e">print</span> <a href="motion.txt.html#is" class="d">is</a> not intended <a href="luaref.txt.html#for" class="d">for</a> formatted output, but only <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a>
        quick way to show <a href="insert.txt.html#a" class="d">a</a> value, typically <a href="luaref.txt.html#for" class="d">for</a> debugging. For formatted
        output, use <span class="e">string.format</span> (see <a href="luaref.txt.html#string.format%28%29" class="l">string.format()</a>).

rawequal({v1}, <span class="s">{v2}</span>)                                    <span id="rawequal%28%29" class="t">rawequal()</span>
        Checks whether <span class="s">{v1}</span> <a href="motion.txt.html#is" class="d">is</a> equal to <span class="s">{v2}</span>, without invoking any metamethod.
        Returns <a href="insert.txt.html#a" class="d">a</a> boolean.

rawget({table}, <span class="s">{index}</span>)                                <span id="rawget%28%29" class="t">rawget()</span>
        Gets the real value of <span class="e">table[index]</span>, without invoking any
        metamethod. <span class="s">{table}</span> must be <a href="insert.txt.html#a" class="d">a</a> table; <span class="s">{index}</span> may be any value.

rawset({table}, <span class="s">{index}</span>, <span class="s">{value}</span>)                       <span id="rawset%28%29" class="t">rawset()</span>
        Sets the real value of <span class="e">table[index]</span> to <span class="s">{value}</span>, without invoking any
        metamethod. <span class="s">{table}</span> must be <a href="insert.txt.html#a" class="d">a</a> table, <span class="s">{index}</span> any value different from
        <span class="e">nil</span>, and <span class="s">{value}</span> any <a href="lua.txt.html#Lua" class="d">Lua</a> value.

        This function returns <span class="s">{table}</span>.

select({index}, <span class="s">{...}</span>)                                  <span id="select%28%29" class="t">select()</span>
        If <span class="s">{index}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number, returns all arguments after argument number
        <span class="s">{index}</span>. Otherwise, <span class="s">{index}</span> must be the <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">"#"</span>, and <span class="e">select</span>
        returns the total number of extra arguments <a href="motion.txt.html#it" class="d">it</a> received.

setfenv({f}, <span class="s">{table}</span>)                                   <span id="setfenv%28%29" class="t">setfenv()</span>
        Sets the environment to be used by the given function. <span class="s">{f}</span> can be <a href="insert.txt.html#a" class="d">a</a>
        <a href="lua.txt.html#Lua" class="d">Lua</a> function or <a href="insert.txt.html#a" class="d">a</a> number that specifies the function <a href="motion.txt.html#at" class="d">at</a> that stack
        level: Level 1 <a href="motion.txt.html#is" class="d">is</a> the function calling <span class="e">setfenv</span>. <span class="e">setfenv</span> returns
        the given function.

        As <a href="insert.txt.html#a" class="d">a</a> special case, when <span class="s">{f}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#0" class="d">0</a> <span class="e">setfenv</span> changes the environment of
        the running thread. In this case, <span class="e">setfenv</span> returns no values.

setmetatable({table}, <span class="s">{metatable}</span>)                      <span id="setmetatable%28%29" class="t">setmetatable()</span>
        Sets the <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="luaref.txt.html#for" class="d">for</a> the given table. (You cannot change the
        <a href="luaref.txt.html#metatable" class="d">metatable</a> of other types from Lua, only from C.) If <span class="s">{metatable}</span> <a href="motion.txt.html#is" class="d">is</a>
        <span class="e">nil</span>, removes the <a href="luaref.txt.html#metatable" class="d">metatable</a> of the given table. If the original
        <a href="luaref.txt.html#metatable" class="d">metatable</a> has <a href="insert.txt.html#a" class="d">a</a> <span class="e">"__metatable"</span> field, raises an error.

        This function returns <span class="s">{table}</span>.

tonumber({e} [, <span class="s">{base}</span>])                                <span id="tonumber%28%29" class="t">tonumber()</span>
        Tries to convert its argument to <a href="insert.txt.html#a" class="d">a</a> number. If the argument <a href="motion.txt.html#is" class="d">is</a> already
        <a href="insert.txt.html#a" class="d">a</a> number or <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> convertible to <a href="insert.txt.html#a" class="d">a</a> number, then <span class="e">tonumber</span> returns
        this number; otherwise, <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">nil</span>.

        An optional argument specifies the base to interpret the numeral. The
        base may be any integer between 2 and 36, inclusive. In bases above
        10, the letter <span class="e">A</span> (in either upper or lower case) represents 10, <span class="e">B</span>
        represents 11, and so forth, with <span class="e">Z'</span> representing 35. In base 10
        (the default), the number may have <a href="insert.txt.html#a" class="d">a</a> decimal part, <a href="motion.txt.html#as" class="d">as</a> well <a href="motion.txt.html#as" class="d">as</a> an
        optional exponent part (see <a href="luaref.txt.html#lua-lexical" class="l">lua-lexical</a>). In other bases,
        only unsigned integers are accepted.

tostring({e})                                           <span id="tostring%28%29" class="t">tostring()</span>
        Receives an argument of any type and converts <a href="motion.txt.html#it" class="d">it</a> to <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> in <a href="insert.txt.html#a" class="d">a</a>
        reasonable format. For complete <a href="intro.txt.html#control" class="d">control</a> of how numbers are converted,
        use <span class="e">string.format</span> (see <a href="luaref.txt.html#string.format%28%29" class="l">string.format()</a>).

                                                        <span id="__tostring" class="t">__tostring</span>
        If the <a href="luaref.txt.html#metatable" class="d">metatable</a> of <span class="s">{e}</span> has <a href="insert.txt.html#a" class="d">a</a> <span class="e">"__tostring"</span> field, <span class="e">tostring</span> calls
        the corresponding value with <span class="s">{e}</span> <a href="motion.txt.html#as" class="d">as</a> argument, and uses the result of
        the call <a href="motion.txt.html#as" class="d">as</a> its result.

type({v})                                               <span id="lua-type%28%29" class="t">lua-type()</span>
        Returns the type of its only argument, coded <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> string. The possible
        results of this function are <span class="e">"nil"</span> (a string, not the value <span class="e">nil</span>),
        <span class="e">"number"</span>, <span class="e">"string"</span>, <span class="e">"boolean</span>, <span class="e">"table"</span>, <span class="e">"function"</span>,
        <span class="e">"thread"</span>, and <span class="e">"userdata"</span>.

unpack({list} [, <span class="s">{i}</span> [, <span class="s">{j}</span>]])                          <span id="unpack%28%29" class="t">unpack()</span>
        Returns the elements from the given table. This function <a href="motion.txt.html#is" class="d">is</a> equivalent
        to

<span class="e">          return list[i], list[i+1], ..., list[j]</span>

        except that the above code can be written only <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> fixed number of
        elements. By default, <span class="s">{i}</span> <a href="motion.txt.html#is" class="d">is</a> 1 and <span class="s">{j}</span> <a href="motion.txt.html#is" class="d">is</a> the length of the list, <a href="motion.txt.html#as" class="d">as</a>
        defined by the length <a href="motion.txt.html#operator" class="d">operator</a> (see <a href="luaref.txt.html#lua-length" class="l">lua-length</a>).

<a href="luaref.txt.html#_VERSION" class="d">_VERSION</a>                                                <span id="_VERSION" class="t">_VERSION</span>
        <a href="insert.txt.html#A" class="d">A</a> global variable (not <a href="insert.txt.html#a" class="d">a</a> function) that holds <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> containing the
        current interpreter version. The current contents of this <a href="vimeval.txt.html#string" class="d">string</a> <a href="motion.txt.html#is" class="d">is</a>
        <a href="motion.txt.html#%60" class="d">`</a>"<a href="lua.txt.html#Lua" class="d">Lua</a> 5.1"<a href="motion.txt.html#%60" class="d">`</a> <a href="repeat.txt.html#." class="d">.</a>

xpcall({f}, <span class="s">{err}</span>)                                      <span id="xpcall%28%29" class="t">xpcall()</span>
        This function <a href="motion.txt.html#is" class="d">is</a> similar to <span class="e">pcall</span> (see <a href="luaref.txt.html#pcall%28%29" class="l">pcall()</a>), except that you
        can set <a href="insert.txt.html#a" class="d">a</a> new error handler.

        <span class="e">xpcall</span> calls function <span class="s">{f}</span> in protected mode, using <span class="s">{err}</span> <a href="motion.txt.html#as" class="d">as</a> the
        error handler. Any error inside <span class="s">{f}</span> <a href="motion.txt.html#is" class="d">is</a> not propagated; instead,
        <span class="e">xpcall</span> catches the error, calls the <span class="s">{err}</span> function with the original
        error object, and returns <a href="insert.txt.html#a" class="d">a</a> status code. Its first result <a href="motion.txt.html#is" class="d">is</a> the
        status code (a boolean), which <a href="motion.txt.html#is" class="d">is</a> true if the call succeeds without
        errors. In this case, <span class="e">xpcall</span> also returns all results from the call,
        after this first result. In <a href="change.txt.html#case" class="d">case</a> of any error, <span class="e">xpcall</span> returns
        <span class="e">false</span> plus the result from <span class="s">{err}</span>.

<span class="h">==============================================================================</span>
5.2  Coroutine Manipulation                     <span id="lua-lib-coroutine" class="t">lua-lib-coroutine</span>

The operations related to coroutines comprise <a href="insert.txt.html#a" class="d">a</a> sub-library of the basic
library and come inside the table <span class="e">coroutine</span>. See <a href="luaref.txt.html#lua-coroutine" class="l">lua-coroutine</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a>
general description of coroutines.

coroutine.create({f})                                       <span id="coroutine.create%28%29" class="t">coroutine.create()</span>
        Creates <a href="insert.txt.html#a" class="d">a</a> new coroutine, with body <span class="s">{f}</span>. <span class="s">{f}</span> must be <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function.
        Returns this new coroutine, an object with type <span class="e">"thread"</span>.

coroutine.resume({co} [, <span class="s">{val1}</span>, <span class="s">{...}</span>])                    <span id="coroutine.resume%28%29" class="t">coroutine.resume()</span>
        Starts or continues the execution of coroutine <span class="s">{co}</span>. The first time
        you resume <a href="insert.txt.html#a" class="d">a</a> coroutine, <a href="motion.txt.html#it" class="d">it</a> starts running its body. The values <span class="s">{val1}</span>,
        <span class="s">{...}</span> are passed <a href="motion.txt.html#as" class="d">as</a> arguments to the body function. If the coroutine has
        yielded, <span class="e">resume</span> restarts it; the values <span class="s">{val1}</span>, <span class="s">{...}</span> are passed <a href="motion.txt.html#as" class="d">as</a>
        the results from the yield.

        If the coroutine runs without any errors, <span class="e">resume</span> returns <span class="e">true</span> plus
        any values passed to <span class="e">yield</span> (if the coroutine yields) or any values
        returned by the body function(if the coroutine terminates). If there
        <a href="motion.txt.html#is" class="d">is</a> any error, <span class="e">resume</span> returns <span class="e">false</span> plus the error message.

<a href="luaref.txt.html#coroutine.running%28%29" class="d">coroutine.running()</a>                                        <span id="coroutine.running%28%29" class="t">coroutine.running()</span>
        Returns the running coroutine, or <span class="e">nil</span> when called by the main
        thread.

coroutine.status({co})                                      <span id="coroutine.status%28%29" class="t">coroutine.status()</span>
        Returns the status of coroutine <span class="s">{co}</span>, <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> string: <span class="e">"running"</span>, if the
        coroutine <a href="motion.txt.html#is" class="d">is</a> running (that is, <a href="motion.txt.html#it" class="d">it</a> called <span class="e">status</span>); <span class="e">"suspended"</span>, if
        the coroutine <a href="motion.txt.html#is" class="d">is</a> suspended in <a href="insert.txt.html#a" class="d">a</a> call to <span class="e">yield</span>, or if <a href="motion.txt.html#it" class="d">it</a> has not
        started running yet; <span class="e">"normal"</span> if the coroutine <a href="motion.txt.html#is" class="d">is</a> active but not
        running (that is, <a href="motion.txt.html#it" class="d">it</a> has resumed another coroutine); and <span class="e">"dead"</span> if
        the coroutine has finished its body function, or if <a href="motion.txt.html#it" class="d">it</a> has stopped
        with an error.

coroutine.wrap({f})                                           <span id="coroutine.wrap%28%29" class="t">coroutine.wrap()</span>
        Creates <a href="insert.txt.html#a" class="d">a</a> new coroutine, with body <span class="s">{f}</span>. <span class="s">{f}</span> must be <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function.
        Returns <a href="insert.txt.html#a" class="d">a</a> function that resumes the coroutine each time <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> called.
        Any arguments passed to the function behave <a href="motion.txt.html#as" class="d">as</a> the extra arguments to
        <span class="e">resume</span>. Returns the same values returned by <span class="e">resume</span>, except the
        first boolean. In <a href="change.txt.html#case" class="d">case</a> of error, propagates the error.

coroutine.yield({...})                                       <span id="coroutine.yield%28%29" class="t">coroutine.yield()</span>
        Suspends the execution of the calling coroutine. The coroutine cannot
        be running <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function, <a href="insert.txt.html#a" class="d">a</a> metamethod, or an <a href="lua.txt.html#iterator" class="l">iterator</a><a href="repeat.txt.html#." class="d">.</a> Any arguments
        to <span class="e">yield</span> are passed <a href="motion.txt.html#as" class="d">as</a> extra results to <span class="e">resume</span>.

<span class="h">==============================================================================</span>
5.3 Modules                                                   <span id="lua-modules" class="t">lua-modules</span>

The package library provides basic facilities <a href="luaref.txt.html#for" class="d">for</a> loading and building modules
in Lua. It exports two of its <a href="vimeval.txt.html#functions" class="d">functions</a> directly in the global environment:
<span class="e">require</span> and <span class="e">module</span> (see <a href="luaref.txt.html#require%28%29" class="l">require()</a> and <a href="luaref.txt.html#module%28%29" class="l">module()</a>). Everything else <a href="motion.txt.html#is" class="d">is</a>
exported in <a href="insert.txt.html#a" class="d">a</a> table <span class="e">package</span>.

module({name} [, <span class="s">{...}</span>])                                <span id="module%28%29" class="t">module()</span>
        Creates <a href="insert.txt.html#a" class="d">a</a> module. If there <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> table in <span class="e">package.loaded[name]</span>, this
        table <a href="motion.txt.html#is" class="d">is</a> the module. Otherwise, if there <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> global table <span class="e">t</span> with
        the given name, this table <a href="motion.txt.html#is" class="d">is</a> the module. Otherwise creates <a href="insert.txt.html#a" class="d">a</a> new
        table <span class="e">t</span> and sets <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#as" class="d">as</a> the value of the global <span class="s">{name}</span> and the value
        of <span class="e">package.loaded[name]</span>. This function also initializes <span class="e">t._NAME</span>
        with the given name, <span class="e">t._M</span> with the module (`t` itself), and
        <span class="e">t._PACKAGE</span> with the package name (the full module name minus last
        component; see below). Finally, <span class="e">module</span> sets <span class="e">t</span> <a href="motion.txt.html#as" class="d">as</a> the new
        environment of the current function and the new value of
        <span class="e">package.loaded[name]</span>, so that <a href="luaref.txt.html#require%28%29" class="l">require()</a> returns <span class="e">t</span>.

        If <span class="s">{name}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> compound name (that is, one with components separated
        by dots), <span class="e">module</span> creates (or reuses, if they already exist) tables
        <a href="luaref.txt.html#for" class="d">for</a> each component. For instance, if <span class="s">{name}</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">a.b.c</span>, then <span class="e">module</span>
        stores the module table in field <span class="e">c</span> of field <span class="e">b</span> of global <span class="e">a</span>.

        This function may receive optional <span class="e">options</span> after the module name,
        where each option <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> function to be applied over the module.

require({modname})                                      <span id="require%28%29" class="t">require()</span>
        Loads the given module. The function starts by looking into the
        <span class="e">package.loaded</span> table to determine whether <span class="s">{modname}</span> <a href="motion.txt.html#is" class="d">is</a> already
        loaded. If <a href="motion.txt.html#it" class="d">it</a> is, then <span class="e">require</span> returns the value stored <a href="motion.txt.html#at" class="d">at</a>
        <span class="e">package.loaded[modname]</span>. Otherwise, <a href="motion.txt.html#it" class="d">it</a> tries to find <a href="insert.txt.html#a" class="d">a</a> <span class="e">loader</span> <a href="luaref.txt.html#for" class="d">for</a>
        the module.

        To find <a href="insert.txt.html#a" class="d">a</a> loader, first <span class="e">require</span> queries <span class="e">package.preload[modname]</span>.
        If <a href="motion.txt.html#it" class="d">it</a> has <a href="insert.txt.html#a" class="d">a</a> value, this value (which should be <a href="insert.txt.html#a" class="d">a</a> function) <a href="motion.txt.html#is" class="d">is</a> the
        loader. Otherwise <span class="e">require</span> searches <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> loader using the path
        stored in <span class="e">package.path</span>. If that also fails, <a href="motion.txt.html#it" class="d">it</a> searches <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a>
        loader using the path stored in <span class="e">package.cpath</span>. If that also fails,
        <a href="motion.txt.html#it" class="d">it</a> tries an <span class="e">all-in-one</span> loader (see below).

        When loading <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> library, <span class="e">require</span> first uses <a href="insert.txt.html#a" class="d">a</a> dynamic link facility
        to link the application with the library. Then <a href="motion.txt.html#it" class="d">it</a> tries to find <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a>
        function inside this library to be used <a href="motion.txt.html#as" class="d">as</a> the loader. The name of
        this <a href="change.txt.html#C" class="d">C</a> function <a href="motion.txt.html#is" class="d">is</a> the <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">"luaopen_"</span> concatenated with <a href="insert.txt.html#a" class="d">a</a> copy of
        the module name where each dot <a href="motion.txt.html#is" class="d">is</a> replaced by an underscore. Moreover,
        if the module name has <a href="insert.txt.html#a" class="d">a</a> hyphen, its prefix up to (and including) the
        first hyphen <a href="motion.txt.html#is" class="d">is</a> removed. For instance, if the module name <a href="motion.txt.html#is" class="d">is</a>
        <span class="e">a.v1-b.c</span>, the function name will be <span class="e">luaopen_b_c</span>.

        If <span class="e">require</span> finds neither <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> library nor <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> library <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> module,
        <a href="motion.txt.html#it" class="d">it</a> calls the `all-in-one loader`. This loader searches the <a href="change.txt.html#C" class="d">C</a> path <a href="luaref.txt.html#for" class="d">for</a>
        <a href="insert.txt.html#a" class="d">a</a> library <a href="luaref.txt.html#for" class="d">for</a> the root name of the given module. For instance, when
        requiring <span class="e">a.b.c</span>, <a href="motion.txt.html#it" class="d">it</a> will search <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> library <a href="luaref.txt.html#for" class="d">for</a> <span class="e">a</span>. If found,
        <a href="motion.txt.html#it" class="d">it</a> looks into <a href="motion.txt.html#it" class="d">it</a> <a href="luaref.txt.html#for" class="d">for</a> an open function <a href="luaref.txt.html#for" class="d">for</a> the submodule; in our
        example, that would be <span class="e">luaopen_a_b_c</span>. With this facility, <a href="insert.txt.html#a" class="d">a</a> package
        can pack several <a href="change.txt.html#C" class="d">C</a> submodules into one single library, with each
        submodule keeping its original open function.

        Once <a href="insert.txt.html#a" class="d">a</a> loader <a href="motion.txt.html#is" class="d">is</a> found, <span class="e">require</span> calls the loader with <a href="insert.txt.html#a" class="d">a</a> single
        argument, <span class="s">{modname}</span>. If the loader returns any value, <span class="e">require</span>
        assigns the returned value to <span class="e">package.loaded[modname]</span>. If the loader
        returns no value and has not assigned any value to
        <span class="e">package.loaded[modname]</span>, then <span class="e">require</span> assigns <span class="e">true</span> to this
        entry. In any case, <span class="e">require</span> returns the final value of
        <span class="e">package.loaded[modname]</span>.

        If there <a href="motion.txt.html#is" class="d">is</a> any error loading or running the module, or if <a href="motion.txt.html#it" class="d">it</a> cannot
        find any loader <a href="luaref.txt.html#for" class="d">for</a> the module, then <span class="e">require</span> signals an error.

<a href="luaref.txt.html#package.cpath" class="d">package.cpath</a>                                                    <span id="package.cpath" class="t">package.cpath</span>
        The path used by <span class="e">require</span> to search <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> loader.

        <a href="lua.txt.html#Lua" class="d">Lua</a> initializes the <a href="change.txt.html#C" class="d">C</a> path <span class="e">package.cpath</span> in the same way <a href="motion.txt.html#it" class="d">it</a>
        initializes the <a href="lua.txt.html#Lua" class="d">Lua</a> path <span class="e">package.path</span>, using the environment
        variable <span class="e">LUA_CPATH</span> (plus another default path defined in
        <span class="e">luaconf.h</span>).

<a href="luaref.txt.html#package.loaded" class="d">package.loaded</a>                                                  <span id="package.loaded" class="t">package.loaded</span>
        <a href="insert.txt.html#A" class="d">A</a> table used by <span class="e">require</span> to <a href="intro.txt.html#control" class="d">control</a> which modules are already loaded.
        When you require <a href="insert.txt.html#a" class="d">a</a> module <span class="e">modname</span> and <span class="e">package.loaded[modname]</span> <a href="motion.txt.html#is" class="d">is</a>
        not false, <span class="e">require</span> simply returns the value stored there.

package.loadlib({libname}, <span class="s">{funcname}</span>)                       <span id="package.loadlib%28%29" class="t">package.loadlib()</span>
        Dynamically links the host program with the <a href="change.txt.html#C" class="d">C</a> library <span class="s">{libname}</span>.
        Inside this library, looks <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> function <span class="s">{funcname}</span> and returns this
        function <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#C" class="d">C</a> function. (So, <span class="s">{funcname}</span> must follow the protocol
        (see <a href="luaref.txt.html#lua_CFunction" class="l">lua_CFunction</a>)).

        This <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> low-level function. It completely bypasses the package and
        module system. Unlike <span class="e">require</span>, <a href="motion.txt.html#it" class="d">it</a> does not perform any path
        searching and does not automatically adds extensions. <span class="s">{libname}</span> must
        be the complete file name of the <a href="change.txt.html#C" class="d">C</a> library, including if necessary <a href="insert.txt.html#a" class="d">a</a>
        path and extension. <span class="s">{funcname}</span> must be the exact name exported by the
        <a href="change.txt.html#C" class="d">C</a> library (which may depend on the <a href="change.txt.html#C" class="d">C</a> compiler and linker used).

        This function <a href="motion.txt.html#is" class="d">is</a> not supported by ANSI C. As such, <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> only
        available on some platforms (Windows, Linux, Mac OS X, Solaris, BSD,
        plus other Unix systems that <a href="support.txt.html#support" class="d">support</a> the <span class="e">dlfcn</span> standard).

<a href="luaref.txt.html#package.path" class="d">package.path</a>                                                      <span id="package.path" class="t">package.path</span>
        The path used by <span class="e">require</span> to search <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> loader.

        At start-up, <a href="lua.txt.html#Lua" class="d">Lua</a> initializes this variable with the value of the
        environment variable <span class="e">LUA_PATH</span> or with <a href="insert.txt.html#a" class="d">a</a> default path defined in
        <span class="e">luaconf.h</span>, if the environment variable <a href="motion.txt.html#is" class="d">is</a> not defined. Any <span class="e">";;"</span> in
        the value of the environment variable <a href="motion.txt.html#is" class="d">is</a> replaced by the default path.

        <a href="insert.txt.html#A" class="d">A</a> path <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> sequence of <span class="e">templates</span> separated by semicolons. For each
        template, <span class="e">require</span> will change each interrogation <a href="motion.txt.html#mark" class="d">mark</a> in the
        <a href="autocmd.txt.html#template" class="d">template</a> by <span class="e">filename</span>, which <a href="motion.txt.html#is" class="d">is</a> <span class="e">modname</span> with each dot replaced by <a href="insert.txt.html#a" class="d">a</a>
        "directory separator" (such <a href="motion.txt.html#as" class="d">as</a> <span class="e">"/"</span>  in Unix); then <a href="motion.txt.html#it" class="d">it</a> will try to
        load the resulting file name. So, <a href="luaref.txt.html#for" class="d">for</a> instance, if the <a href="lua.txt.html#Lua" class="d">Lua</a> path <a href="motion.txt.html#is" class="d">is</a>

<span class="e">               "./?.lua;./?.lc;/usr/local/?/init.lua"</span>

        the search <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> loader <a href="luaref.txt.html#for" class="d">for</a> module <span class="e">foo</span> will try to load the
        files <span class="e">./foo.lua</span>, <span class="e">./foo.lc</span>, and <span class="e">/usr/local/foo/init.lua</span>, in that
        order.

package.preload                                              <span id="package.preload%28%29" class="t">package.preload()</span>
        <a href="insert.txt.html#A" class="d">A</a> table to store loaders <a href="luaref.txt.html#for" class="d">for</a> specific modules (see <a href="luaref.txt.html#require%28%29" class="l">require()</a>).

package.seeall({module})                                      <span id="package.seeall%28%29" class="t">package.seeall()</span>
        Sets <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{module}</span> with its <span class="e">__index</span> field referring to
        the global environment, so that this module inherits values from the
        global environment. To be used <a href="motion.txt.html#as" class="d">as</a> an option to function <span class="s">{module}</span>.

<span class="h">==============================================================================</span>
5.4 <a href="vimeval.txt.html#String" class="d">String</a> Manipulation                                       <span id="lua-lib-string" class="t">lua-lib-string</span>

This library provides generic <a href="vimeval.txt.html#functions" class="d">functions</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="vimeval.txt.html#string" class="d">string</a> manipulation, such <a href="motion.txt.html#as" class="d">as</a>
finding and extracting substrings, and <a href="pattern.txt.html#pattern" class="d">pattern</a> matching. When indexing <a href="insert.txt.html#a" class="d">a</a>
<a href="vimeval.txt.html#string" class="d">string</a> in Lua, the first character <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#at" class="d">at</a> position 1 (not <a href="motion.txt.html#at" class="d">at</a> 0, <a href="motion.txt.html#as" class="d">as</a> in C).
Indices are allowed to be negative and are interpreted <a href="motion.txt.html#as" class="d">as</a> indexing backwards,
from the <a href="intro.txt.html#end" class="d">end</a> of the string. Thus, the last character <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#at" class="d">at</a> position -1, and
so on.

The <a href="vimeval.txt.html#string" class="d">string</a> library provides all its <a href="vimeval.txt.html#functions" class="d">functions</a> inside the table <span class="e">string</span>.
It also sets <a href="insert.txt.html#a" class="d">a</a> <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="luaref.txt.html#for" class="d">for</a> strings where the <span class="e">__index</span> field points to the
<span class="e">string</span> table. Therefore, you can use the <a href="vimeval.txt.html#string" class="d">string</a> <a href="vimeval.txt.html#functions" class="d">functions</a> in object-oriented
style. For instance, `string.byte(s, i)` can be written <a href="motion.txt.html#as" class="d">as</a> <span class="e">s:byte(i)</span>.

string.byte({s} [, <span class="s">{i}</span> [, <span class="s">{j}</span>]])                                 <span id="string.byte%28%29" class="t">string.byte()</span>
        Returns the internal numerical codes of the characters <span class="e">s[i]</span>,
        <span class="e">s[i+1]</span>,..., <span class="e">s[j]</span>. The default value <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{i}</span> <a href="motion.txt.html#is" class="d">is</a> 1; the default
        value <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{j}</span> <a href="motion.txt.html#is" class="d">is</a> <span class="s">{i}</span>.

        <span class="n">Note</span> that numerical codes are not necessarily portable across
        platforms.

string.char({...})                                               <span id="string.char%28%29" class="t">string.char()</span>
        Receives zero or more integers. Returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> with length equal to
        the number of arguments, in which each character has the internal
        numerical code equal to its correspondent argument.

        <span class="n">Note</span> that numerical codes are not necessarily portable across
        platforms.

string.dump({function})                                          <span id="string.dump%28%29" class="t">string.dump()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> containing <a href="insert.txt.html#a" class="d">a</a> binary representation of the given
        function, so that <a href="insert.txt.html#a" class="d">a</a> later <a href="luaref.txt.html#loadstring%28%29" class="l">loadstring()</a> on this <a href="vimeval.txt.html#string" class="d">string</a> returns <a href="insert.txt.html#a" class="d">a</a>
        copy of the function. <span class="s">{function}</span> must be <a href="insert.txt.html#a" class="d">a</a> <a href="lua.txt.html#Lua" class="d">Lua</a> function without
        upvalues.

string.find({s}, <span class="s">{pattern}</span> [, <span class="s">{init}</span> [, <span class="s">{plain}</span>]])               <span id="string.find%28%29" class="t">string.find()</span>
        Looks <a href="luaref.txt.html#for" class="d">for</a> the first match of <span class="s">{pattern}</span> in the <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{s}</span>. If <a href="motion.txt.html#it" class="d">it</a> finds
        <a href="insert.txt.html#a" class="d">a</a> match, then <span class="s">{find}</span> returns the indices of <span class="s">{s}</span> where this occurrence
        starts and ends; otherwise, <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">nil</span>. <a href="insert.txt.html#A" class="d">A</a> third, optional
        numerical argument <span class="s">{init}</span> specifies where to start the search; its
        default value <a href="motion.txt.html#is" class="d">is</a> 1 and may be negative. <a href="insert.txt.html#A" class="d">A</a> value of <span class="s">{true}</span> <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> fourth,
        optional argument <span class="s">{plain}</span> turns off the <a href="pattern.txt.html#pattern" class="d">pattern</a> matching facilities,
        so the function does <a href="insert.txt.html#a" class="d">a</a> plain "find <a href="vimeval.txt.html#substring" class="d">substring</a>" operation, with no
        characters in <span class="s">{pattern}</span> being considered "magic"<a href="repeat.txt.html#." class="d">.</a> <span class="n">Note</span> that if <span class="s">{plain}</span>
        <a href="motion.txt.html#is" class="d">is</a> given, then <span class="s">{init}</span> must be given <a href="motion.txt.html#as" class="d">as</a> well.

        If the <a href="pattern.txt.html#pattern" class="d">pattern</a> has captures, then in <a href="insert.txt.html#a" class="d">a</a> successful match the captured
        values are also returned, after the two indices.

string.format({formatstring}, <span class="s">{...}</span>)                           <span id="string.format%28%29" class="t">string.format()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> formatted version of its variable number of arguments
        following the description given in its first argument (which must be <a href="insert.txt.html#a" class="d">a</a>
        string). The format <a href="vimeval.txt.html#string" class="d">string</a> follows the same rules <a href="motion.txt.html#as" class="d">as</a> the <span class="e">printf</span>
        family of standard <a href="change.txt.html#C" class="d">C</a> functions. The only differences are that the
        options/modifiers <span class="e">*</span>, <span class="e">l</span>, <span class="e">L</span>, <span class="e">n</span>, <span class="e">p</span>, and <span class="e">h</span> are not supported
        and that there <a href="motion.txt.html#is" class="d">is</a> an extra option, <span class="e">q</span>. The <span class="e">q</span> option formats <a href="insert.txt.html#a" class="d">a</a>
        <a href="vimeval.txt.html#string" class="d">string</a> in <a href="insert.txt.html#a" class="d">a</a> form suitable to be safely read back by the <a href="lua.txt.html#Lua" class="d">Lua</a>
        interpreter: the <a href="vimeval.txt.html#string" class="d">string</a> <a href="motion.txt.html#is" class="d">is</a> written between double quotes, and all
        double quotes, newlines, embedded zeros, and backslashes in the <a href="vimeval.txt.html#string" class="d">string</a>
        are correctly escaped when written. For instance, the call

<span class="e">               string.format('%q', 'a string with "quotes" and \n new line')</span>

        will produce the string:

<span class="e">               "a string with \"quotes\" and \</span>
<span class="e">                new line"</span>

        The <a href="options.txt.html#options" class="d">options</a> <span class="e">c</span>, <span class="e">d</span>, <span class="e">E</span>, <span class="e">e</span>, <span class="e">f</span>, <span class="e">g</span>, <span class="e">G</span>, <span class="e">i</span>, <span class="e">o</span>, <span class="e">u</span>, <span class="e">X</span>, and
        <span class="e">x</span> all expect <a href="insert.txt.html#a" class="d">a</a> number <a href="motion.txt.html#as" class="d">as</a> argument, whereas <span class="e">q</span> and <span class="e">s</span> expect <a href="insert.txt.html#a" class="d">a</a>
        string.

        This function does not accept <a href="vimeval.txt.html#string" class="d">string</a> values containing embedded zeros.

string.gmatch({s}, <span class="s">{pattern}</span>)                                  <span id="string.gmatch%28%29" class="t">string.gmatch()</span>
        Returns an <a href="lua.txt.html#iterator" class="l">iterator</a> function that, each time <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> called, returns the
        next captures from <span class="s">{pattern}</span> over <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{s}</span>.

        If <span class="s">{pattern}</span> specifies no captures, then the whole match <a href="motion.txt.html#is" class="d">is</a> produced
        in each call.

        As an example, the following loop

<span class="e">               s = "hello world from Lua"</span>
<span class="e">               for w in string.gmatch(s, "%a+") do</span>
<span class="e">                 print(w)</span>
<span class="e">               end</span>

        will iterate over all the words from <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{s}</span>, printing one per
        line. The next example collects all pairs <span class="e">key=value</span> from the given
        <a href="vimeval.txt.html#string" class="d">string</a> into <a href="insert.txt.html#a" class="d">a</a> table:

<span class="e">               t = {}</span>
<span class="e">               s = "from=world, to=Lua"</span>
<span class="e">               for k, v in string.gmatch(s, "(%w+)=(%w+)") do</span>
<span class="e">                 t[k] = v</span>
<span class="e">               end</span>


string.gsub({s}, <span class="s">{pattern}</span>, <span class="s">{repl}</span> [, <span class="s">{n}</span>])                      <span id="string.gsub%28%29" class="t">string.gsub()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> copy of <span class="s">{s}</span> in which all occurrences of the <span class="s">{pattern}</span> have
        been replaced by <a href="insert.txt.html#a" class="d">a</a> replacement <a href="vimeval.txt.html#string" class="d">string</a> specified by <span class="s">{repl}</span>, which may
        be <a href="insert.txt.html#a" class="d">a</a> string, <a href="insert.txt.html#a" class="d">a</a> table, or <a href="insert.txt.html#a" class="d">a</a> function. <span class="e">gsub</span> also returns, <a href="motion.txt.html#as" class="d">as</a> its
        second value, the total number of substitutions made.

        If <span class="s">{repl}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> string, then its value <a href="motion.txt.html#is" class="d">is</a> used <a href="luaref.txt.html#for" class="d">for</a> replacement. The
        character <span class="e">%</span> works <a href="motion.txt.html#as" class="d">as</a> an <a href="intro.txt.html#escape" class="d">escape</a> character: any sequence in <span class="s">{repl}</span> of
        the form <span class="e">%n</span>, with <span class="s">{n}</span> between 1 and 9, stands <a href="luaref.txt.html#for" class="d">for</a> the value of the
        <span class="s">{n}</span> -th captured <a href="vimeval.txt.html#substring" class="d">substring</a> (see below). The sequence <span class="e">%0</span> stands <a href="luaref.txt.html#for" class="d">for</a>
        the whole match. The sequence <span class="e">%%</span> stands <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> single <span class="e">%</span>.

        If <span class="s">{repl}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> table, then the table <a href="motion.txt.html#is" class="d">is</a> queried <a href="luaref.txt.html#for" class="d">for</a> every match, using
        the first capture <a href="motion.txt.html#as" class="d">as</a> the key; if the <a href="pattern.txt.html#pattern" class="d">pattern</a> specifies no captures,
        then the whole match <a href="motion.txt.html#is" class="d">is</a> used <a href="motion.txt.html#as" class="d">as</a> the key.

        If <span class="s">{repl}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> function, then this function <a href="motion.txt.html#is" class="d">is</a> called every time <a href="insert.txt.html#a" class="d">a</a>
        match occurs, with all captured substrings passed <a href="motion.txt.html#as" class="d">as</a> arguments, in
        order; if the <a href="pattern.txt.html#pattern" class="d">pattern</a> specifies no captures, then the whole match <a href="motion.txt.html#is" class="d">is</a>
        passed <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> sole argument.

        If the value returned by the table query or by the function call <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a>
        <a href="vimeval.txt.html#string" class="d">string</a> or <a href="insert.txt.html#a" class="d">a</a> number, then <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> used <a href="motion.txt.html#as" class="d">as</a> the replacement string;
        otherwise, if <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> <span class="e">false</span> or <span class="e">nil</span>, then there <a href="motion.txt.html#is" class="d">is</a> no replacement
        (that is, the original match <a href="motion.txt.html#is" class="d">is</a> kept in the string).

        The optional last parameter <span class="s">{n}</span> <a href="vi_diff.txt.html#limits" class="d">limits</a> the maximum number of
        substitutions to occur. For instance, when <span class="s">{n}</span> <a href="motion.txt.html#is" class="d">is</a> 1 only the first
        occurrence of <span class="e">pattern</span> <a href="motion.txt.html#is" class="d">is</a> replaced.

        Here are some examples:

<span class="e">           x = string.gsub("hello world", "(%w+)", "%1 %1")</span>
<span class="e">           --&gt; x="hello hello world world"</span>
<span class="e"></span>
<span class="e">           x = string.gsub("hello world", "%w+", "%0 %0", 1)</span>
<span class="e">           --&gt; x="hello hello world"</span>
<span class="e"></span>
<span class="e">           x = string.gsub("hello world from Lua", "(%w+)%s*(%w+)", "%2 %1")</span>
<span class="e">           --&gt; x="world hello Lua from"</span>
<span class="e"></span>
<span class="e">           x = string.gsub("home = $HOME, user = $USER", "%$(%w+)", os.getenv)</span>
<span class="e">           --&gt; x="home = /home/roberto, user = roberto"</span>
<span class="e"></span>
<span class="e">           x = string.gsub("4+5 = $return 4+5$", "%$(.-)%$", function (s)</span>
<span class="e">                 return loadstring(s)()</span>
<span class="e">               end)</span>
<span class="e">           --&gt; x="4+5 = 9"</span>
<span class="e"></span>
<span class="e">           local t = {name="lua", version="5.1"}</span>
<span class="e">           x = string.gsub("$name%-$version.tar.gz", "%$(%w+)", t)</span>
<span class="e">           --&gt; x="lua-5.1.tar.gz"</span>


string.len({s})                                                   <span id="string.len%28%29" class="t">string.len()</span>
        Receives <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> and returns its length. The empty <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">""</span> has
        length 0. Embedded zeros are counted, so <span class="e">"a\000b\000c"</span> has length 5.

string.lower({s})                                               <span id="string.lower%28%29" class="t">string.lower()</span>
        Receives <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> and returns <a href="insert.txt.html#a" class="d">a</a> copy of this <a href="vimeval.txt.html#string" class="d">string</a> with all <a href="change.txt.html#uppercase" class="d">uppercase</a>
        letters changed to lowercase. All other characters are left unchanged.
        The definition of what an <a href="change.txt.html#uppercase" class="d">uppercase</a> letter <a href="motion.txt.html#is" class="d">is</a> depends on the current
        locale.

string.match({s}, <span class="s">{pattern}</span> [, <span class="s">{init}</span>])                         <span id="string.match%28%29" class="t">string.match()</span>
        Looks <a href="luaref.txt.html#for" class="d">for</a> the first <span class="e">match</span> of <span class="s">{pattern}</span> in the <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{s}</span>. If <a href="motion.txt.html#it" class="d">it</a>
        finds one, then <span class="e">match</span> returns the captures from the pattern;
        otherwise <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">nil</span>. If <span class="s">{pattern}</span> specifies no captures, then
        the whole match <a href="motion.txt.html#is" class="d">is</a> returned. <a href="insert.txt.html#A" class="d">A</a> third, optional numerical argument
        <span class="s">{init}</span> specifies where to start the search; its default value <a href="motion.txt.html#is" class="d">is</a> 1 and
        may be negative.

string.rep({s}, <span class="s">{n}</span>)                                              <span id="string.rep%28%29" class="t">string.rep()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> that <a href="motion.txt.html#is" class="d">is</a> the concatenation of <span class="s">{n}</span> copies of the <a href="vimeval.txt.html#string" class="d">string</a>
        <span class="s">{s}</span>.

string.reverse({s})                                           <span id="string.reverse%28%29" class="t">string.reverse()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> that <a href="motion.txt.html#is" class="d">is</a> the <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{s}</span> reversed.

string.sub({s}, <span class="s">{i}</span> [, <span class="s">{j}</span>])                                      <span id="string.sub%28%29" class="t">string.sub()</span>
        Returns the <a href="vimeval.txt.html#substring" class="d">substring</a> of <span class="s">{s}</span> that starts <a href="motion.txt.html#at" class="d">at</a> <span class="s">{i}</span> and continues until
        <span class="s">{j}</span>; <span class="s">{i}</span> and <span class="s">{j}</span> may be negative. If <span class="s">{j}</span> <a href="motion.txt.html#is" class="d">is</a> absent, then <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> assumed
        to be equal to <span class="e">-1</span> (which <a href="motion.txt.html#is" class="d">is</a> the same <a href="motion.txt.html#as" class="d">as</a> the <a href="vimeval.txt.html#string" class="d">string</a> length). In
        particular, the call <span class="e">string.sub(s,1,j)</span> returns <a href="insert.txt.html#a" class="d">a</a> prefix of <span class="s">{s}</span> with
        length <span class="s">{j}</span>, and <span class="e">string.sub(s,-i)</span> returns <a href="insert.txt.html#a" class="d">a</a> suffix of <span class="s">{s}</span> with length
        <span class="s">{i}</span>.

string.upper({s})                                               <span id="string.upper%28%29" class="t">string.upper()</span>
        Receives <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> and returns <a href="insert.txt.html#a" class="d">a</a> copy of that <a href="vimeval.txt.html#string" class="d">string</a> with all <a href="change.txt.html#lowercase" class="d">lowercase</a>
        letters changed to uppercase. All other characters are left unchanged.
        The definition of what <a href="insert.txt.html#a" class="d">a</a> <a href="change.txt.html#lowercase" class="d">lowercase</a> letter <a href="motion.txt.html#is" class="d">is</a> depends on the current
        locale.

<span class="h">------------------------------------------------------------------------------</span>
5.4.1  Patterns                                                  <span id="lua-pattern" class="t">lua-pattern</span>

<a href="insert.txt.html#A" class="d">A</a> character class <a href="motion.txt.html#is" class="d">is</a> used to represent <a href="insert.txt.html#a" class="d">a</a> set of characters. The following
combinations are allowed in describing <a href="insert.txt.html#a" class="d">a</a> character class:

    <a href="motion.txt.html#-" class="d">-</a> <span class="e">x</span>   (where <span class="e">x</span> <a href="motion.txt.html#is" class="d">is</a> not one of the magic characters <span class="e">^$()%.[]*+-?</span>)
          represents the character <span class="e">x</span> itself.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">.</span>   (a dot) represents all characters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%a</span>  represents all letters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%c</span>  represents all <a href="intro.txt.html#control" class="d">control</a> characters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%d</span>  represents all digits.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%l</span>  represents all <a href="change.txt.html#lowercase" class="d">lowercase</a> letters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%p</span>  represents all punctuation characters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%s</span>  represents all <a href="intro.txt.html#space" class="d">space</a> characters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%u</span>  represents all <a href="change.txt.html#uppercase" class="d">uppercase</a> letters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%w</span>  represents all alphanumeric characters.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%x</span>  represents all hexadecimal digits.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%z</span>  represents the character with representation <span class="e">0</span>.
    <a href="motion.txt.html#-" class="d">-</a> <span class="e">%x</span>  (where <span class="e">x</span> <a href="motion.txt.html#is" class="d">is</a> any non-alphanumeric character) represents the
          character <span class="e">x</span>. This <a href="motion.txt.html#is" class="d">is</a> the standard way to <a href="intro.txt.html#escape" class="d">escape</a> the magic
          characters. Any punctuation character (even the non-magic) can be
          preceded by <a href="insert.txt.html#a" class="d">a</a> <span class="e">%</span> when used to represent itself in <a href="insert.txt.html#a" class="d">a</a> pattern.

    <a href="motion.txt.html#-" class="d">-</a> <span class="e">[set]</span>  represents the class which <a href="motion.txt.html#is" class="d">is</a> the union of all characters in
         <span class="e">set</span>. <a href="insert.txt.html#A" class="d">A</a> range of characters may be specified by separating the <a href="intro.txt.html#end" class="d">end</a>
         characters of the range with <a href="insert.txt.html#a" class="d">a</a> <span class="e">-</span>. All classes <span class="e">%x</span> described
         above may also be used <a href="motion.txt.html#as" class="d">as</a> components in <span class="e">set</span>. All other characters
         in <span class="e">set</span> represent themselves. For example, <span class="e">[%w_]</span> (or <span class="e">[_%w]</span>)
         represents all alphanumeric characters plus the underscore, <span class="e">[0-7]</span>
         represents the <a href="vimeval.txt.html#octal" class="d">octal</a> digits, and <span class="e">[0-7%l%-]</span> represents the <a href="vimeval.txt.html#octal" class="d">octal</a>
         digits plus the <a href="change.txt.html#lowercase" class="d">lowercase</a> letters plus the <span class="e">-</span> character.

         The interaction between ranges and classes <a href="motion.txt.html#is" class="d">is</a> not defined. Therefore,
         patterns like <span class="e">[%a-z]</span> or <span class="e">[a-%%]</span> have no meaning.

    <a href="motion.txt.html#-" class="d">-</a> <span class="e">[^set]</span>  represents the complement of <span class="e">set</span>, where <span class="e">set</span> <a href="motion.txt.html#is" class="d">is</a> interpreted
         <a href="motion.txt.html#as" class="d">as</a> above.

For all classes represented by single letters (`%a`, <span class="e">%c</span>, etc.), the
corresponding <a href="change.txt.html#uppercase" class="d">uppercase</a> letter represents the complement of the class. For
instance, <span class="e">%S</span> represents all non-space characters.

The <a href="intro.txt.html#definitions" class="d">definitions</a> of letter, space, and other character groups depend on the
current locale. In particular, the class <span class="e">[a-z]</span> may not be equivalent to <span class="e">%l</span>.

<span class="c">PATTERN ITEM</span>                                                <span id="lua-patternitem" class="t">lua-patternitem</span>

<a href="insert.txt.html#A" class="d">A</a> <a href="pattern.txt.html#pattern" class="d">pattern</a> item may be

   <a href="motion.txt.html#-" class="d">-</a> <a href="insert.txt.html#a" class="d">a</a> single character class, which matches any single character in the
      class;
   <a href="motion.txt.html#-" class="d">-</a> <a href="insert.txt.html#a" class="d">a</a> single character class followed by <span class="e">*</span>, which matches <a href="motion.txt.html#0" class="d">0</a> or more
      repetitions of characters in the class. These repetition items will
      always match the longest possible sequence;
   <a href="motion.txt.html#-" class="d">-</a> <a href="insert.txt.html#a" class="d">a</a> single character class followed by <span class="e">+</span>, which matches 1 or more
      repetitions of characters in the class. These repetition items will
      always match the longest possible sequence;
                                                               <span id="lua-nongreedy" class="t">lua-nongreedy</span>
   <a href="motion.txt.html#-" class="d">-</a> <a href="insert.txt.html#a" class="d">a</a> single character class followed by <span class="e">-</span>, which also matches <a href="motion.txt.html#0" class="d">0</a> or
      more repetitions of characters in the class. Unlike <span class="e">*</span>, these
      repetition items will always match the shortest possible sequence;
   <a href="motion.txt.html#-" class="d">-</a> <a href="insert.txt.html#a" class="d">a</a> single character class followed by <span class="e">?</span>, which matches <a href="motion.txt.html#0" class="d">0</a> or 1
      occurrences of <a href="insert.txt.html#a" class="d">a</a> character in the class;
   <a href="motion.txt.html#-" class="d">-</a> <span class="e">%n</span>, <a href="luaref.txt.html#for" class="d">for</a> <span class="e">n</span> between 1 and 9; such item matches <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#substring" class="d">substring</a> equal to the
      <span class="e">n</span> -th captured <a href="vimeval.txt.html#string" class="d">string</a> (see below);
   <a href="motion.txt.html#-" class="d">-</a> <span class="e">%bxy</span>, where <span class="e">x</span> and <span class="e">y</span> are two distinct characters; such item matches
      strings that start with <span class="e">x</span>, <a href="intro.txt.html#end" class="d">end</a> with <span class="e">y</span>, and where the <span class="e">x</span> and <span class="e">y</span>
      are balanced. This means that, if one reads the <a href="vimeval.txt.html#string" class="d">string</a> from left to
      right, counting <span class="e">+1</span> <a href="luaref.txt.html#for" class="d">for</a> an <span class="e">x</span> and <span class="e">-1</span> <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> <span class="e">y</span>, the ending <span class="e">y</span> <a href="motion.txt.html#is" class="d">is</a> the first
      <span class="e">y</span> where the <a href="intro.txt.html#count" class="d">count</a> reaches 0. For instance, the item <span class="e">%b()</span> matches
      expressions with balanced parentheses.

<span class="c">PATTERN</span>

<a href="insert.txt.html#A" class="d">A</a> <a href="pattern.txt.html#pattern" class="d">pattern</a> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> sequence of <a href="pattern.txt.html#pattern" class="d">pattern</a> items. <a href="insert.txt.html#A" class="d">A</a> <span class="e">^</span> <a href="motion.txt.html#at" class="d">at</a> the beginning of <a href="insert.txt.html#a" class="d">a</a> <a href="pattern.txt.html#pattern" class="d">pattern</a>
anchors the match <a href="motion.txt.html#at" class="d">at</a> the beginning of the subject string. <a href="insert.txt.html#A" class="d">A</a> <span class="e">$</span> <a href="motion.txt.html#at" class="d">at</a> the <a href="intro.txt.html#end" class="d">end</a> of
<a href="insert.txt.html#a" class="d">a</a> <a href="pattern.txt.html#pattern" class="d">pattern</a> anchors the match <a href="motion.txt.html#at" class="d">at</a> the <a href="intro.txt.html#end" class="d">end</a> of the subject string. At other
positions, <span class="e">^</span> and <span class="e">$</span> have no special meaning and represent themselves.

<span class="c">CAPTURES</span>                                                        <span id="lua-capture" class="t">lua-capture</span>

<a href="insert.txt.html#A" class="d">A</a> <a href="pattern.txt.html#pattern" class="d">pattern</a> may contain sub-patterns enclosed in parentheses; they describe
captures. When <a href="insert.txt.html#a" class="d">a</a> match succeeds, the substrings of the subject <a href="vimeval.txt.html#string" class="d">string</a> that
match captures are stored (captured) <a href="luaref.txt.html#for" class="d">for</a> future use. Captures are numbered
according to their left parentheses. For instance, in the <a href="pattern.txt.html#pattern" class="d">pattern</a>
<span class="e">"(a*(.)%w(%s*))"</span>, the part of the <a href="vimeval.txt.html#string" class="d">string</a> matching <span class="e">"a*(.)%w(%s*)"</span> <a href="motion.txt.html#is" class="d">is</a> stored
<a href="motion.txt.html#as" class="d">as</a> the first capture (and therefore has number 1); the character matching <span class="e">.</span>
<a href="motion.txt.html#is" class="d">is</a> captured with number 2, and the part matching <span class="e">%s*</span> has number 3.

As <a href="insert.txt.html#a" class="d">a</a> special case, the empty capture <span class="e">()</span> captures the current <a href="vimeval.txt.html#string" class="d">string</a> position
(a number). For instance, if we apply the <a href="pattern.txt.html#pattern" class="d">pattern</a> <span class="e">"()aa()"</span> on the
<a href="vimeval.txt.html#string" class="d">string</a> <span class="e">"flaaap"</span>, there will be two captures: 3 and 5.

<a href="insert.txt.html#A" class="d">A</a> <a href="pattern.txt.html#pattern" class="d">pattern</a> cannot contain embedded zeros.  Use <span class="e">%z</span> instead.

<span class="h">==============================================================================</span>
5.5  Table Manipulation                                        <span id="lua-lib-table" class="t">lua-lib-table</span>

This library provides generic <a href="vimeval.txt.html#functions" class="d">functions</a> <a href="luaref.txt.html#for" class="d">for</a> table manipulation. It provides
all its <a href="vimeval.txt.html#functions" class="d">functions</a> inside the table <span class="e">table</span>.

Most <a href="vimeval.txt.html#functions" class="d">functions</a> in the table library assume that the table represents an array
or <a href="insert.txt.html#a" class="d">a</a> list. For those functions, when we talk about the "length" of <a href="insert.txt.html#a" class="d">a</a> table we
mean the result of the length operator.

table.concat({table} [, <span class="s">{sep}</span> [, <span class="s">{i}</span> [, <span class="s">{j}</span>]]])                 <span id="table.concat%28%29" class="t">table.concat()</span>
        Given an array where all elements are strings or numbers, returns
        `table[i]..sep..table[i+1] <a href="userfunc.txt.html#..." class="d">...</a> sep..table[j]`. The default value <a href="luaref.txt.html#for" class="d">for</a>
        <span class="s">{sep}</span> <a href="motion.txt.html#is" class="d">is</a> the empty string, the default <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{i}</span> <a href="motion.txt.html#is" class="d">is</a> 1, and the default
        <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{j}</span> <a href="motion.txt.html#is" class="d">is</a> the length of the table. If <span class="s">{i}</span> <a href="motion.txt.html#is" class="d">is</a> greater than <span class="s">{j}</span>,
        returns the empty string.

table.foreach({table}, <span class="s">{f}</span>)                                    <span id="table.foreach%28%29" class="t">table.foreach()</span>
        Executes the given <span class="s">{f}</span> over all elements of <span class="s">{table}</span>. For each element,
        <span class="s">{f}</span> <a href="motion.txt.html#is" class="d">is</a> called with the <a href="index.txt.html#index" class="d">index</a> and respective value <a href="motion.txt.html#as" class="d">as</a> arguments. If <span class="s">{f}</span>
        returns <a href="insert.txt.html#a" class="d">a</a> non-`nil` value, then the loop <a href="motion.txt.html#is" class="d">is</a> broken, and this value <a href="motion.txt.html#is" class="d">is</a>
        returned <a href="motion.txt.html#as" class="d">as</a> the final value of <span class="e">table.foreach</span>.

        See <a href="luaref.txt.html#next%28%29" class="l">next()</a> <a href="luaref.txt.html#for" class="d">for</a> extra information about table traversals.

table.foreachi({table}, <span class="s">{f}</span>)                                  <span id="table.foreachi%28%29" class="t">table.foreachi()</span>
        Executes the given <span class="s">{f}</span> over the numerical indices of <span class="s">{table}</span>. For each
        index, <span class="s">{f}</span> <a href="motion.txt.html#is" class="d">is</a> called with the <a href="index.txt.html#index" class="d">index</a> and respective value <a href="motion.txt.html#as" class="d">as</a> arguments.
        Indices are visited in sequential order, from 1 to <span class="e">n</span>, where <span class="e">n</span> <a href="motion.txt.html#is" class="d">is</a>
        the length of the table. If <span class="s">{f}</span> returns <a href="insert.txt.html#a" class="d">a</a> non-`nil` value, then the
        loop <a href="motion.txt.html#is" class="d">is</a> broken and this value <a href="motion.txt.html#is" class="d">is</a> returned <a href="motion.txt.html#as" class="d">as</a> the result of
        <span class="e">table.foreachi</span>.

table.insert({table}, [{pos},] <span class="s">{value}</span>)                         <span id="table.insert%28%29" class="t">table.insert()</span>
        Inserts element <span class="s">{value}</span> <a href="motion.txt.html#at" class="d">at</a> position <span class="s">{pos}</span> in <span class="s">{table}</span>, shifting up
        other elements to open space, if necessary. The default value <a href="luaref.txt.html#for" class="d">for</a>
        <span class="s">{pos}</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">n+1</span>, where <span class="e">n</span> <a href="motion.txt.html#is" class="d">is</a> the length of the table (see
        <a href="luaref.txt.html#lua-length" class="l">lua-length</a>), so that <a href="insert.txt.html#a" class="d">a</a> call <span class="e">table.insert(t,x)</span> inserts <span class="e">x</span>
        <a href="motion.txt.html#at" class="d">at</a> the <a href="intro.txt.html#end" class="d">end</a> of table <span class="e">t</span>.

table.maxn({table})                                               <span id="table.maxn%28%29" class="t">table.maxn()</span>
        Returns the largest positive numerical <a href="index.txt.html#index" class="d">index</a> of the given table, or
        zero if the table has no positive numerical indices. (To <a href="diff.txt.html#do" class="d">do</a> its <a href="job_control.txt.html#job" class="d">job</a>
        this function does <a href="insert.txt.html#a" class="d">a</a> linear traversal of the whole table.)

table.remove({table} [, <span class="s">{pos}</span>])                                 <span id="table.remove%28%29" class="t">table.remove()</span>
        Removes from <span class="s">{table}</span> the element <a href="motion.txt.html#at" class="d">at</a> position <span class="s">{pos}</span>, shifting down
        other elements to close the space, if necessary. Returns the value of
        the removed element. The default value <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{pos}</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">n</span>, where <span class="e">n</span> <a href="motion.txt.html#is" class="d">is</a>
        the length of the table (see <a href="luaref.txt.html#lua-length" class="l">lua-length</a>), so that <a href="insert.txt.html#a" class="d">a</a> call
        <span class="e">table.remove(t)</span> removes the last element of table <span class="e">t</span>.

table.sort({table} [, <span class="s">{comp}</span>])                                    <span id="table.sort%28%29" class="t">table.sort()</span>
        Sorts table elements in <a href="insert.txt.html#a" class="d">a</a> given order, <span class="e">in-place</span>, from <span class="e">table[1]</span> to
        <span class="e">table[n]</span>, where <span class="e">n</span> <a href="motion.txt.html#is" class="d">is</a> the length of the table (see <a href="luaref.txt.html#lua-length" class="l">lua-length</a>).
        If <span class="s">{comp}</span> <a href="motion.txt.html#is" class="d">is</a> given, then <a href="motion.txt.html#it" class="d">it</a> must be <a href="insert.txt.html#a" class="d">a</a> function that receives two table
        elements, and returns true when the first <a href="motion.txt.html#is" class="d">is</a> <a href="various.txt.html#less" class="d">less</a> than the second (so
        that `not comp(a[i+1],a[i])` will be true after the sort). If <span class="s">{comp}</span>
        <a href="motion.txt.html#is" class="d">is</a> not given, then the standard <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#operator" class="d">operator</a> <span class="e">&lt;</span> <a href="motion.txt.html#is" class="d">is</a> used instead.

The sort algorithm <a href="motion.txt.html#is" class="d">is</a> <span class="e">not</span> stable, that is, elements considered equal by the
given order may have their relative positions changed by the sort.

<span class="h">==============================================================================</span>
5.6  Mathematical Functions                                     <span id="lua-lib-math" class="t">lua-lib-math</span>

This library <a href="motion.txt.html#is" class="d">is</a> an interface to most of the <a href="vimeval.txt.html#functions" class="d">functions</a> of the standard <a href="change.txt.html#C" class="d">C</a> math
library. It provides all its <a href="vimeval.txt.html#functions" class="d">functions</a> inside the table <span class="e">math</span>.

math.abs({x})                                                       <span id="math.abs%28%29" class="t">math.abs()</span>
        Returns the absolute value of <span class="s">{x}</span>.

math.acos({x})                                                     <span id="math.acos%28%29" class="t">math.acos()</span>
        Returns the arc cosine of <span class="s">{x}</span> (in radians).

math.asin({x})                                                     <span id="math.asin%28%29" class="t">math.asin()</span>
        Returns the arc sine of <span class="s">{x}</span> (in radians).

math.atan({x})                                                     <span id="math.atan%28%29" class="t">math.atan()</span>
        Returns the arc tangent of <span class="s">{x}</span> (in radians).

math.atan2({x}, <span class="s">{y}</span>)                                              <span id="math.atan2%28%29" class="t">math.atan2()</span>
        Returns the arc tangent of <span class="e">x/y</span> (in radians), but uses the <a href="sign.txt.html#signs" class="d">signs</a> of
        both parameters to find the quadrant of the result. (It also handles
        correctly the <a href="change.txt.html#case" class="d">case</a> of <span class="s">{y}</span> being zero.)

math.ceil({x})                                                     <span id="math.ceil%28%29" class="t">math.ceil()</span>
        Returns the smallest integer larger than or equal to <span class="s">{x}</span>.

math.cos({x})                                                       <span id="math.cos%28%29" class="t">math.cos()</span>
        Returns the cosine of <span class="s">{x}</span> (assumed to be in radians).

math.cosh({x})                                                     <span id="math.cosh%28%29" class="t">math.cosh()</span>
        Returns the hyperbolic cosine of <span class="s">{x}</span>.

math.deg({x})                                                       <span id="math.deg%28%29" class="t">math.deg()</span>
        Returns the angle <span class="s">{x}</span> (given in radians) in degrees.

math.exp({x})                                                       <span id="math.exp%28%29" class="t">math.exp()</span>
        Returns the value <span class="e">e^x</span>.

math.floor({x})                                                   <span id="math.floor%28%29" class="t">math.floor()</span>
        Returns the largest integer smaller than or equal to <span class="s">{x}</span>.

math.fmod({x}, <span class="s">{y}</span>)                                                <span id="math.fmod%28%29" class="t">math.fmod()</span>
        Returns the remainder of the division of <span class="s">{x}</span> by <span class="s">{y}</span>.

math.frexp({x})                                                   <span id="math.frexp%28%29" class="t">math.frexp()</span>
        Returns <span class="e">m</span> and <span class="e">e</span> such that `x <a href="change.txt.html#%3D" class="d">=</a> <a href="motion.txt.html#m" class="d">m</a> * 2^e`, <span class="e">e</span> <a href="motion.txt.html#is" class="d">is</a> an integer and the
        absolute value of <span class="e">m</span> <a href="motion.txt.html#is" class="d">is</a> in the range `[0.5, 1)` (or zero when <span class="s">{x}</span> <a href="motion.txt.html#is" class="d">is</a>
        zero).

<a href="luaref.txt.html#math.huge" class="d">math.huge</a>                                                            <span id="math.huge" class="t">math.huge</span>
        The value <span class="e">HUGE_VAL</span>, <a href="insert.txt.html#a" class="d">a</a> value larger than or equal to any other
        numerical value.

math.ldexp({m}, <span class="s">{e}</span>)                                              <span id="math.ldexp%28%29" class="t">math.ldexp()</span>
        Returns `m * 2^e` (`e` should be an integer).

math.log({x})                                                       <span id="math.log%28%29" class="t">math.log()</span>
        Returns the natural logarithm of <span class="s">{x}</span>.

math.log10({x})                                                   <span id="math.log10%28%29" class="t">math.log10()</span>
        Returns the base-10 logarithm of <span class="s">{x}</span>.

math.max({x}, <span class="s">{...}</span>)                                                <span id="math.max%28%29" class="t">math.max()</span>
        Returns the maximum value among its arguments.

math.min({x}, <span class="s">{...}</span>)                                                <span id="math.min%28%29" class="t">math.min()</span>
        Returns the minimum value among its arguments.

math.modf({x})                                                     <span id="math.modf%28%29" class="t">math.modf()</span>
        Returns two numbers, the integral part of <span class="s">{x}</span> and the fractional part
        of <span class="s">{x}</span>.

<a href="luaref.txt.html#math.pi" class="d">math.pi</a>                                                                <span id="math.pi" class="t">math.pi</span>
        The value of <span class="e">pi</span>.

math.pow({x}, <span class="s">{y}</span>)                                                  <span id="math.pow%28%29" class="t">math.pow()</span>
        Returns <span class="e">x^y</span>. (You can also use the <a href="vimeval.txt.html#expression" class="d">expression</a> <span class="e">x^y</span> to compute this
        value.)

math.rad({x})                                                       <span id="math.rad%28%29" class="t">math.rad()</span>
        Returns the angle <span class="s">{x}</span> (given in degrees) in radians.

math.random([{m} [, <span class="s">{n}</span>]])                                       <span id="math.random%28%29" class="t">math.random()</span>
        This function <a href="motion.txt.html#is" class="d">is</a> an interface to the simple pseudo-random generator
        function <span class="e">rand</span> provided by ANSI C. (No guarantees can be given <a href="luaref.txt.html#for" class="d">for</a>
        its statistical properties.)

        When called without arguments, returns <a href="insert.txt.html#a" class="d">a</a> pseudo-random real number in
        the range <span class="e">[0,1)</span>. When called with <a href="insert.txt.html#a" class="d">a</a> number <span class="s">{m}</span>, <span class="e">math.random</span>
        returns <a href="insert.txt.html#a" class="d">a</a> pseudo-random integer in the range `[1, m]`. When called
        with two numbers <span class="s">{m}</span> and <span class="s">{n}</span>, <span class="e">math.random</span> returns <a href="insert.txt.html#a" class="d">a</a> pseudo-random
        integer in the range `[m, n]`.

math.randomseed({x})                                         <span id="math.randomseed%28%29" class="t">math.randomseed()</span>
        Sets <span class="s">{x}</span> <a href="motion.txt.html#as" class="d">as</a> the "seed" <a href="luaref.txt.html#for" class="d">for</a> the pseudo-random generator: equal seeds
        produce equal sequences of numbers.

math.sin({x})                                                       <span id="math.sin%28%29" class="t">math.sin()</span>
        Returns the sine of <span class="s">{x}</span> (assumed to be in radians).

math.sinh({x})                                                     <span id="math.sinh%28%29" class="t">math.sinh()</span>
        Returns the hyperbolic sine of <span class="s">{x}</span>.

math.sqrt({x})                                                     <span id="math.sqrt%28%29" class="t">math.sqrt()</span>
        Returns the square root of <span class="s">{x}</span>. (You can also use the <a href="vimeval.txt.html#expression" class="d">expression</a>
        <span class="e">x^0.5</span> to compute this value.)

math.tan({x})                                                       <span id="math.tan%28%29" class="t">math.tan()</span>
        Returns the tangent of <span class="s">{x}</span> (assumed to be in radians).

math.tanh({x})                                                     <span id="math.tanh%28%29" class="t">math.tanh()</span>
        Returns the hyperbolic tangent of <span class="s">{x}</span>.

<span class="h">==============================================================================</span>
5.6  Input and Output Facilities                                  <span id="lua-lib-io" class="t">lua-lib-io</span>

The I/O library provides two different styles <a href="luaref.txt.html#for" class="d">for</a> file manipulation. The first
one uses implicit file descriptors; that is, there are operations to set <a href="insert.txt.html#a" class="d">a</a>
default input file and <a href="insert.txt.html#a" class="d">a</a> default output file, and all input/output operations
are over these default files. The second style uses explicit file
descriptors.

When using implicit file descriptors, all operations are supplied by
table <span class="e">io</span>. When using explicit file descriptors, the operation <span class="e">io.open</span> returns
<a href="insert.txt.html#a" class="d">a</a> file descriptor and then all operations are supplied <a href="motion.txt.html#as" class="d">as</a> methods of the file
descriptor.

The table <span class="e">io</span> also provides three predefined file descriptors with their usual
meanings from C: <span class="e">io.stdin</span>, <span class="e">io.stdout</span>, and <span class="e">io.stderr</span>.

Unless otherwise stated, all I/O <a href="vimeval.txt.html#functions" class="d">functions</a> return <span class="e">nil</span> on failure (plus an
error message <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> second result) and some value different from <span class="e">nil</span> on
success.

io.close([{file}])                                                  <span id="io.close%28%29" class="t">io.close()</span>
        Equivalent to <span class="e">file:close</span>. Without <a href="insert.txt.html#a" class="d">a</a> <a href="editing.txt.html#%7Bfile%7D" class="s">{file}</a>, closes the default
        output file.

<a href="luaref.txt.html#io.flush%28%29" class="d">io.flush()</a>                                                          <span id="io.flush%28%29" class="t">io.flush()</span>
        Equivalent to <span class="e">file:flush</span> over the default output file.

io.input([{file}])                                                  <span id="io.input%28%29" class="t">io.input()</span>
        When called with <a href="insert.txt.html#a" class="d">a</a> file name, <a href="motion.txt.html#it" class="d">it</a> opens the named file (in text mode),
        and sets its handle <a href="motion.txt.html#as" class="d">as</a> the default input file. When called with <a href="insert.txt.html#a" class="d">a</a> file
        handle, <a href="motion.txt.html#it" class="d">it</a> simply sets this file handle <a href="motion.txt.html#as" class="d">as</a> the default input file.
        When called without parameters, <a href="motion.txt.html#it" class="d">it</a> returns the current default input
        file.

        In <a href="change.txt.html#case" class="d">case</a> of <a href="message.txt.html#errors" class="d">errors</a> this function raises the error, instead of returning
        an error code.

io.lines([{filename}])                                              <span id="io.lines%28%29" class="t">io.lines()</span>
        Opens the given file name in read mode and returns an <a href="lua.txt.html#iterator" class="l">iterator</a>
        function that, each time <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> called, returns <a href="insert.txt.html#a" class="d">a</a> new line from the
        file. Therefore, the construction

        `for line in io.lines(filename) do`  <span class="e">body</span>  <span class="e">end</span>

        will iterate over all lines of the file. When the <a href="lua.txt.html#iterator" class="d">iterator</a> function
        detects the <a href="intro.txt.html#end" class="d">end</a> of file, <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">nil</span> (to finish the loop) and
        automatically closes the file.

        The call <span class="e">io.lines()</span> (without <a href="insert.txt.html#a" class="d">a</a> file name) <a href="motion.txt.html#is" class="d">is</a> equivalent to
        <span class="e">io.input():lines()</span>; that is, <a href="motion.txt.html#it" class="d">it</a> iterates over the lines of the
        default input file. In this <a href="change.txt.html#case" class="d">case</a> <a href="motion.txt.html#it" class="d">it</a> does not close the file when the
        loop ends.

io.open({filename} [, <span class="s">{mode}</span>])                                       <span id="io.open%28%29" class="t">io.open()</span>
        This function opens <a href="insert.txt.html#a" class="d">a</a> file, in the mode specified in the <a href="vimeval.txt.html#string" class="d">string</a>
        <span class="s">{mode}</span>. It returns <a href="insert.txt.html#a" class="d">a</a> new file handle, or, in <a href="change.txt.html#case" class="d">case</a> of errors, <span class="e">nil</span>
        plus an error message.

        The <span class="s">{mode}</span> <a href="vimeval.txt.html#string" class="d">string</a> can be any of the following:

         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"r"</span>   read mode (the default);
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"w"</span>   write mode;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"a"</span>   append mode;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"r+"</span>  update mode, all previous data <a href="motion.txt.html#is" class="d">is</a> preserved;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"w+"</span>  update mode, all previous data <a href="motion.txt.html#is" class="d">is</a> erased;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"a+"</span>  append update mode, previous data <a href="motion.txt.html#is" class="d">is</a> preserved, <a href="editing.txt.html#writing" class="d">writing</a> <a href="motion.txt.html#is" class="d">is</a>
                 only allowed <a href="motion.txt.html#at" class="d">at</a> the <a href="intro.txt.html#end" class="d">end</a> of file.

        The <span class="s">{mode}</span> <a href="vimeval.txt.html#string" class="d">string</a> may also have <a href="insert.txt.html#a" class="d">a</a> <span class="e">b</span> <a href="motion.txt.html#at" class="d">at</a> the end, which <a href="motion.txt.html#is" class="d">is</a> needed in
        some systems to open the file in binary mode. This <a href="vimeval.txt.html#string" class="d">string</a> <a href="motion.txt.html#is" class="d">is</a> exactly
        what <a href="motion.txt.html#is" class="d">is</a> used in the standard <a href="change.txt.html#C" class="d">C</a> function <span class="e">fopen</span>.

io.output([{file}])                                                <span id="io.output%28%29" class="t">io.output()</span>
        Similar to <span class="e">io.input</span>, but operates over the default output file.

io.popen({prog} [, <span class="s">{mode}</span>])                                         <span id="io.popen%28%29" class="t">io.popen()</span>
        Starts program <span class="s">{prog}</span> in <a href="insert.txt.html#a" class="d">a</a> separated process and returns <a href="insert.txt.html#a" class="d">a</a> file handle
        that you can use to read data from this program (if <span class="s">{mode}</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">"r"</span>,
        the default) or to write data to this program (if <span class="s">{mode}</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">"w"</span>).

        This function <a href="motion.txt.html#is" class="d">is</a> system dependent and <a href="motion.txt.html#is" class="d">is</a> not available on all
        platforms.

io.read({...})                                                       <span id="io.read%28%29" class="t">io.read()</span>
        Equivalent to <span class="e">io.input():read</span>.

<a href="luaref.txt.html#io.tmpfile%28%29" class="d">io.tmpfile()</a>                                                      <span id="io.tmpfile%28%29" class="t">io.tmpfile()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> handle <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> temporary file. This file <a href="motion.txt.html#is" class="d">is</a> opened in update
        mode and <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> automatically removed when the program ends.

io.type({obj})                                                       <span id="io.type%28%29" class="t">io.type()</span>
        Checks whether <span class="s">{obj}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> valid file handle. Returns the <a href="vimeval.txt.html#string" class="d">string</a>
        <span class="e">"file"</span> if <span class="s">{obj}</span> <a href="motion.txt.html#is" class="d">is</a> an open file handle, <a href="motion.txt.html#%60" class="d">`</a>"closed file"<a href="motion.txt.html#%60" class="d">`</a> if <span class="s">{obj}</span> <a href="motion.txt.html#is" class="d">is</a>
        <a href="insert.txt.html#a" class="d">a</a> closed file handle, or <span class="e">nil</span> if <span class="s">{obj}</span> <a href="motion.txt.html#is" class="d">is</a> not <a href="insert.txt.html#a" class="d">a</a> file handle.

io.write({...})                                                     <span id="io.write%28%29" class="t">io.write()</span>
        Equivalent to <span class="e">io.output():write</span>.

<a href="luaref.txt.html#file%3Aclose%28%29" class="d">file:close()</a>                                               <span id="file%3Aclose%28%29" class="t">file:close()</span>
        Closes <span class="e">file</span>. <span class="n">Note</span> that files are automatically closed when their
        handles are garbage collected, but that takes an unpredictable amount
        of time to happen.

<a href="luaref.txt.html#file%3Aflush%28%29" class="d">file:flush()</a>                                               <span id="file%3Aflush%28%29" class="t">file:flush()</span>
        Saves any written data to <span class="e">file</span>.

<a href="luaref.txt.html#file%3Alines%28%29" class="d">file:lines()</a>                                               <span id="file%3Alines%28%29" class="t">file:lines()</span>
        Returns an <a href="lua.txt.html#iterator" class="l">iterator</a> function that, each time <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> called, returns <a href="insert.txt.html#a" class="d">a</a>
        new line from the file. Therefore, the construction

               `for line in <a href="luaref.txt.html#file%3Alines%28%29" class="d">file:lines()</a> do`  <span class="e">body</span>  <span class="e">end</span>

        will iterate over all lines of the file. (Unlike <span class="e">io.lines</span>, this
        function does not close the file when the loop ends.)

file:read({...})                                            <span id="file%3Aread%28%29" class="t">file:read()</span>
        Reads the file <span class="e">file</span>, according to the given formats, which specify
        what to read. For each format, the function returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> (or <a href="insert.txt.html#a" class="d">a</a>
        number) with the characters read, or <span class="e">nil</span> if <a href="motion.txt.html#it" class="d">it</a> cannot read data with
        the specified format. When called without formats, <a href="motion.txt.html#it" class="d">it</a> uses <a href="insert.txt.html#a" class="d">a</a> default
        format that reads the entire next line (see below).

        The available formats are

         <span class="e">"*n"</span>    reads <a href="insert.txt.html#a" class="d">a</a> number; this <a href="motion.txt.html#is" class="d">is</a> the only format that returns <a href="insert.txt.html#a" class="d">a</a>
                 number instead of <a href="insert.txt.html#a" class="d">a</a> string.
         <span class="e">"*a"</span>    reads the whole file, <a href="starting.txt.html#starting" class="d">starting</a> <a href="motion.txt.html#at" class="d">at</a> the current position. On
                 <a href="intro.txt.html#end" class="d">end</a> of file, <a href="motion.txt.html#it" class="d">it</a> returns the empty string.
         <span class="e">"*l"</span>    reads the next line (skipping the <a href="intro.txt.html#end" class="d">end</a> of line), returning
                 <span class="e">nil</span> on <a href="intro.txt.html#end" class="d">end</a> of file. This <a href="motion.txt.html#is" class="d">is</a> the default format.
         <span class="e">number</span>  reads <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> with up to that number of characters,
                 returning <span class="e">nil</span> on <a href="intro.txt.html#end" class="d">end</a> of file. If number <a href="motion.txt.html#is" class="d">is</a> zero, <a href="motion.txt.html#it" class="d">it</a> reads
                 nothing and returns an empty string, or <span class="e">nil</span> on <a href="intro.txt.html#end" class="d">end</a> of file.

file:seek([{whence}] [, <a href="pattern.txt.html#%7Boffset%7D" class="s">{offset}</a>])                          <span id="file%3Aseek%28%29" class="t">file:seek()</span>
        Sets and gets the file position, measured from the beginning of the
        file, to the position given by <a href="pattern.txt.html#%7Boffset%7D" class="s">{offset}</a> plus <a href="insert.txt.html#a" class="d">a</a> base specified by the
        <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{whence}</span>, <a href="motion.txt.html#as" class="d">as</a> follows:

         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"set"</span>: base <a href="motion.txt.html#is" class="d">is</a> position <a href="motion.txt.html#0" class="d">0</a> (beginning of the file);
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"cur"</span>: base <a href="motion.txt.html#is" class="d">is</a> current position;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"end"</span>: base <a href="motion.txt.html#is" class="d">is</a> <a href="intro.txt.html#end" class="d">end</a> of file;

        In <a href="change.txt.html#case" class="d">case</a> of success, function <span class="e">seek</span> returns the final file position,
        measured in bytes from the beginning of the file. If this function
        fails, <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">nil</span>, plus <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> describing the error.

        The default value <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{whence}</span> <a href="motion.txt.html#is" class="d">is</a> <span class="e">"cur"</span>, and <a href="luaref.txt.html#for" class="d">for</a> <a href="pattern.txt.html#%7Boffset%7D" class="s">{offset}</a> <a href="motion.txt.html#is" class="d">is</a> 0.
        Therefore, the call <span class="e">file:seek()</span> returns the current file position,
        without <a href="change.txt.html#changing" class="d">changing</a> it; the call <span class="e">file:seek("set")</span> sets the position to
        the beginning of the file (and returns 0); and the call
        <span class="e">file:seek("end")</span> sets the position to the <a href="intro.txt.html#end" class="d">end</a> of the file, and
        returns its size.

file:setvbuf({mode} [, <span class="s">{size}</span>])                          <span id="file%3Asetvbuf%28%29" class="t">file:setvbuf()</span>
        Sets the buffering mode <a href="luaref.txt.html#for" class="d">for</a> an output file. There are three available
        modes:

         <span class="e">"no"</span>    no buffering; the result of any output operation appears
                 immediately.
         <span class="e">"full"</span>  full buffering; output operation <a href="motion.txt.html#is" class="d">is</a> performed only when
                 the buffer <a href="motion.txt.html#is" class="d">is</a> full (or when you explicitly <span class="e">flush</span> the file
                 (see <a href="luaref.txt.html#io.flush%28%29" class="l">io.flush()</a>).
         <span class="e">"line"</span>  line buffering; output <a href="motion.txt.html#is" class="d">is</a> buffered until <a href="insert.txt.html#a" class="d">a</a> newline <a href="motion.txt.html#is" class="d">is</a>
                 output or there <a href="motion.txt.html#is" class="d">is</a> any input from some special files (such <a href="motion.txt.html#as" class="d">as</a>
                 <a href="insert.txt.html#a" class="d">a</a> <a href="terminal.txt.html#terminal" class="d">terminal</a> device).

        For the last two cases, <span class="s">{size}</span> specifies the size of the buffer, in
        bytes. The default <a href="motion.txt.html#is" class="d">is</a> an appropriate size.

file:write({...})                                          <span id="file%3Awrite%28%29" class="t">file:write()</span>
        Writes the value of each of its arguments to <span class="e">file</span>. The arguments
        must be strings or numbers. To write other values, use <span class="e">tostring</span>
        <a href="luaref.txt.html#tostring%28%29" class="l">tostring()</a> or <span class="e">string.format</span> <a href="luaref.txt.html#string.format%28%29" class="l">string.format()</a> before
        <span class="e">write</span>.

<span class="h">==============================================================================</span>
5.8  Operating System Facilities                                  <span id="lua-lib-os" class="t">lua-lib-os</span>

This library <a href="motion.txt.html#is" class="d">is</a> implemented through table <span class="e">os</span>.

<a href="luaref.txt.html#os.clock%28%29" class="d">os.clock()</a>                                                          <span id="os.clock%28%29" class="t">os.clock()</span>
        Returns an approximation of the amount in seconds of CPU time used by
        the program.

os.date([{format} [, <span class="s">{time}</span>]])                                       <span id="os.date%28%29" class="t">os.date()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> or <a href="insert.txt.html#a" class="d">a</a> table containing date and time, formatted
        according to the given <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{format}</span>.

        If the <span class="s">{time}</span> argument <a href="motion.txt.html#is" class="d">is</a> present, this <a href="motion.txt.html#is" class="d">is</a> the time to be formatted
        (see the <span class="e">os.time</span> function <a href="luaref.txt.html#os.time%28%29" class="l">os.time()</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> description of this
        value). Otherwise, <span class="e">date</span> formats the current time.

        If <span class="s">{format}</span> starts with <span class="e">!</span>, then the date <a href="motion.txt.html#is" class="d">is</a> formatted in
        Coordinated Universal Time. After this optional character, if <span class="s">{format}</span>
        <a href="motion.txt.html#is" class="d">is</a> the <a href="vimeval.txt.html#string" class="d">string</a> <span class="e">"*t"</span>, then <span class="e">date</span> returns <a href="insert.txt.html#a" class="d">a</a> table with the following
        fields: <span class="e">year</span> (four digits), <span class="e">month</span> (1-12), <span class="e">day</span> (1-31), <span class="e">hour</span>
        (0-23), <span class="e">min</span> (0-59), <span class="e">sec</span> (0-61), <span class="e">wday</span> (weekday, Sunday <a href="motion.txt.html#is" class="d">is</a> 1),
        <span class="e">yday</span> (day of the year), and <span class="e">isdst</span> (daylight saving flag, <a href="insert.txt.html#a" class="d">a</a>
        boolean).

        If <span class="s">{format}</span> <a href="motion.txt.html#is" class="d">is</a> not <span class="e">"*t"</span>, then <span class="e">date</span> returns the date <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> string,
        formatted according to the same rules <a href="motion.txt.html#as" class="d">as</a> the <a href="change.txt.html#C" class="d">C</a> function <span class="e">strftime</span>.

        When called without arguments, <span class="e">date</span> returns <a href="insert.txt.html#a" class="d">a</a> reasonable date and
        time representation that depends on the host system and on the current
        <a href="mbyte.txt.html#locale" class="d">locale</a> (that is, <span class="e">os.date()</span> <a href="motion.txt.html#is" class="d">is</a> equivalent to <span class="e">os.date("%c")</span>).

os.difftime({t2}, <span class="s">{t1}</span>)                                          <span id="os.difftime%28%29" class="t">os.difftime()</span>
        Returns the number of seconds from time <span class="s">{t1}</span> to time <span class="s">{t2}</span>. In POSIX,
        Windows, and some other systems, this value <a href="motion.txt.html#is" class="d">is</a> exactly `t2 <a href="motion.txt.html#-" class="d">-</a> t1` <a href="repeat.txt.html#." class="d">.</a>

os.execute([{command}])                                           <span id="os.execute%28%29" class="t">os.execute()</span>
        This function <a href="motion.txt.html#is" class="d">is</a> equivalent to the <a href="change.txt.html#C" class="d">C</a> function <span class="e">system</span>. It passes
        <span class="s">{command}</span> to be executed by an operating system shell. It returns <a href="insert.txt.html#a" class="d">a</a>
        status code, which <a href="motion.txt.html#is" class="d">is</a> system-dependent. If <span class="s">{command}</span> <a href="motion.txt.html#is" class="d">is</a> absent, then
        <a href="motion.txt.html#it" class="d">it</a> returns nonzero if <a href="insert.txt.html#a" class="d">a</a> shell <a href="motion.txt.html#is" class="d">is</a> available and zero otherwise.

os.exit([{code}])                                                    <span id="os.exit%28%29" class="t">os.exit()</span>
        Calls the <a href="change.txt.html#C" class="d">C</a> function <span class="e">exit</span>, with an optional <span class="s">{code}</span>, to terminate the
        host program. The default value <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{code}</span> <a href="motion.txt.html#is" class="d">is</a> the success code.

os.getenv({varname})                                               <span id="os.getenv%28%29" class="t">os.getenv()</span>
        Returns the value of the process environment variable <span class="s">{varname}</span>, or
        <span class="e">nil</span> if the variable <a href="motion.txt.html#is" class="d">is</a> not defined.

os.remove({filename})                                              <span id="os.remove%28%29" class="t">os.remove()</span>
        Deletes the file with the given name. Directories must be empty to be
        removed. If this function fails, <a href="motion.txt.html#it" class="d">it</a> returns <span class="e">nil</span>, plus <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a>
        describing the error.

os.rename({oldname}, <span class="s">{newname}</span>)                                    <span id="os.rename%28%29" class="t">os.rename()</span>
        Renames file named <span class="s">{oldname}</span> to <span class="s">{newname}</span>. If this function fails, <a href="motion.txt.html#it" class="d">it</a>
        returns <span class="e">nil</span>, plus <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> describing the error.

os.setlocale({locale} [, <span class="s">{category}</span>])                           <span id="os.setlocale%28%29" class="t">os.setlocale()</span>
        Sets the current <a href="mbyte.txt.html#locale" class="d">locale</a> of the program. <span class="s">{locale}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a>
        specifying <a href="insert.txt.html#a" class="d">a</a> locale; <span class="s">{category}</span> <a href="motion.txt.html#is" class="d">is</a> an optional <a href="vimeval.txt.html#string" class="d">string</a> describing which
        category to change: <span class="e">"all"</span>, <span class="e">"collate"</span>, <span class="e">"ctype"</span>, <span class="e">"monetary"</span>,
        <span class="e">"numeric"</span>, or <span class="e">"time"</span>; the default category <a href="motion.txt.html#is" class="d">is</a> <span class="e">"all"</span>. The
        function returns the name of the new locale, or <span class="e">nil</span> if the request
        cannot be honored.

os.time([{table}])                                                   <span id="os.time%28%29" class="t">os.time()</span>
        Returns the current time when called without arguments, or <a href="insert.txt.html#a" class="d">a</a> time
        representing the date and time specified by the given table. This
        table must have fields <span class="e">year</span>, <span class="e">month</span>, and <span class="e">day</span>, and may have fields
        <span class="e">hour</span>, <span class="e">min</span>, <span class="e">sec</span>, and <span class="e">isdst</span> (for <a href="insert.txt.html#a" class="d">a</a> description of these fields,
        see the <span class="e">os.date</span> function <a href="luaref.txt.html#os.date%28%29" class="l">os.date()</a>).

        The returned value <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number, whose meaning depends on your system.
        In POSIX, Windows, and some other systems, this number counts the
        number of seconds since some given start time (the "epoch"). In other
        systems, the meaning <a href="motion.txt.html#is" class="d">is</a> not specified, and the number returned by
        <span class="e">time</span> can be used only <a href="motion.txt.html#as" class="d">as</a> an argument to <span class="e">date</span> and <span class="e">difftime</span>.

<a href="luaref.txt.html#os.tmpname%28%29" class="d">os.tmpname()</a>                                                      <span id="os.tmpname%28%29" class="t">os.tmpname()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> with <a href="insert.txt.html#a" class="d">a</a> file name that can be used <a href="luaref.txt.html#for" class="d">for</a> <a href="insert.txt.html#a" class="d">a</a> temporary
        file. The file must be explicitly opened before its use and explicitly
        removed when no longer needed.

<span class="h">==============================================================================</span>
5.9  The Debug Library                                         <span id="lua-lib-debug" class="t">lua-lib-debug</span>

This library provides the functionality of the debug interface to <a href="lua.txt.html#Lua" class="d">Lua</a>
programs. You should exert care when using this library. The <a href="vimeval.txt.html#functions" class="d">functions</a>
provided here should be used exclusively <a href="luaref.txt.html#for" class="d">for</a> debugging and similar tasks, such
<a href="motion.txt.html#as" class="d">as</a> profiling. Please resist the temptation to use them <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> usual programming
tool: they can be very slow. Moreover, several of its <a href="vimeval.txt.html#functions" class="d">functions</a> violate some
assumptions about <a href="lua.txt.html#Lua" class="d">Lua</a> code (e.g., that <a href="vimeval.txt.html#variables" class="d">variables</a> local to <a href="insert.txt.html#a" class="d">a</a> function cannot be
accessed from outside or that <a href="luaref.txt.html#userdata" class="d">userdata</a> metatables cannot be changed by <a href="lua.txt.html#Lua" class="d">Lua</a>
code) and therefore can compromise otherwise secure code.

All <a href="vimeval.txt.html#functions" class="d">functions</a> in this library are provided inside the <span class="e">debug</span> table. All
<a href="vimeval.txt.html#functions" class="d">functions</a> that operate over <a href="insert.txt.html#a" class="d">a</a> thread have an optional first argument which <a href="motion.txt.html#is" class="d">is</a>
the thread to operate over. The default <a href="motion.txt.html#is" class="d">is</a> always the current thread.

<a href="luaref.txt.html#debug.debug%28%29" class="d">debug.debug()</a>                                                    <span id="debug.debug%28%29" class="t">debug.debug()</span>
        Enters an interactive mode with the user, running each <a href="vimeval.txt.html#string" class="d">string</a> that the
        user enters. Using simple commands and other debug facilities, the
        user can inspect global and local variables, change their values,
        evaluate expressions, and so on. <a href="insert.txt.html#A" class="d">A</a> line containing only the <a href="motion.txt.html#word" class="d">word</a>
        <span class="e">cont</span> finishes this function, so that the caller continues its
        execution.

        <span class="n">Note</span> that commands <a href="luaref.txt.html#for" class="d">for</a> <span class="e">debug.debug</span> are not lexically nested within
        any function, and so have no direct access to local variables.

debug.getfenv(o)                                               <span id="debug.getfenv%28%29" class="t">debug.getfenv()</span>
        Returns the environment of object <span class="s">{o}</span>.

debug.gethook([{thread}])                                      <span id="debug.gethook%28%29" class="t">debug.gethook()</span>
        Returns the current hook settings of the thread, <a href="motion.txt.html#as" class="d">as</a> three values: the
        current hook function, the current hook mask, and the current hook
        <a href="intro.txt.html#count" class="d">count</a> (as set by the <span class="e">debug.sethook</span> function).

debug.getinfo([{thread},] <span class="s">{function}</span> [, <span class="s">{what}</span>])               <span id="debug.getinfo%28%29" class="t">debug.getinfo()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> table with information about <a href="insert.txt.html#a" class="d">a</a> function. You can give the
        function directly, or you can give <a href="insert.txt.html#a" class="d">a</a> number <a href="motion.txt.html#as" class="d">as</a> the value of
        <span class="s">{function}</span>, which means the function running <a href="motion.txt.html#at" class="d">at</a> level <span class="s">{function}</span> of
        the call stack of the given thread: level <a href="motion.txt.html#0" class="d">0</a> <a href="motion.txt.html#is" class="d">is</a> the current function
        (`getinfo` itself); level 1 <a href="motion.txt.html#is" class="d">is</a> the function that called <span class="e">getinfo</span>; and
        so on. If <span class="s">{function}</span> <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> number larger than the number of active
        functions, then <span class="e">getinfo</span> returns <span class="e">nil</span>.

        The returned table may contain all the fields returned by
        <span class="e">lua_getinfo</span> (see <a href="luaref.txt.html#lua_getinfo%28%29" class="l">lua_getinfo()</a>), with the <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{what}</span>
        describing which fields to fill in. The default <a href="luaref.txt.html#for" class="d">for</a> <span class="s">{what}</span> <a href="motion.txt.html#is" class="d">is</a> to get
        all information available, except the table of valid lines. If
        present, the option <span class="e">f</span> adds <a href="insert.txt.html#a" class="d">a</a> field named <span class="e">func</span> with the function
        itself. If present, the option <span class="e">L</span> adds <a href="insert.txt.html#a" class="d">a</a> field named <span class="e">activelines</span>
        with the table of valid lines.

        For instance, the <a href="vimeval.txt.html#expression" class="d">expression</a> <span class="e">debug.getinfo(1,"n").name</span> returns the
        name of the current function, if <a href="insert.txt.html#a" class="d">a</a> reasonable name can be found, and
        <span class="e">debug.getinfo(print)</span> returns <a href="insert.txt.html#a" class="d">a</a> table with all available information
        about the <span class="e">print</span> function.

debug.getlocal([{thread},] <span class="s">{level}</span>, <span class="s">{local}</span>)                  <span id="debug.getlocal%28%29" class="t">debug.getlocal()</span>
        This function returns the name and the value of the local variable
        with <a href="index.txt.html#index" class="d">index</a> <span class="s">{local}</span> of the function <a href="motion.txt.html#at" class="d">at</a> level <span class="s">{level}</span> of the stack. (The
        first parameter or local variable has <a href="index.txt.html#index" class="d">index</a> 1, and so on, until the
        last active local variable.) The function returns <span class="e">nil</span> if there <a href="motion.txt.html#is" class="d">is</a> no
        local variable with the given index, and raises an error when called
        with <a href="insert.txt.html#a" class="d">a</a> <span class="s">{level}</span> out of range. (You can call <span class="e">debug.getinfo</span>
        <a href="luaref.txt.html#debug.getinfo%28%29" class="l">debug.getinfo()</a> to check whether the level <a href="motion.txt.html#is" class="d">is</a> valid.)

        Variable names <a href="starting.txt.html#starting" class="d">starting</a> with <span class="e">(</span> (open parentheses) represent
        internal <a href="vimeval.txt.html#variables" class="d">variables</a> (loop <a href="intro.txt.html#control" class="d">control</a> variables, temporaries, and <a href="change.txt.html#C" class="d">C</a>
        function locals).

debug.getmetatable({object})                              <span id="debug.getmetatable%28%29" class="t">debug.getmetatable()</span>
        Returns the <a href="luaref.txt.html#metatable" class="d">metatable</a> of the given <span class="s">{object}</span> or <span class="e">nil</span> if <a href="motion.txt.html#it" class="d">it</a> does not
        have <a href="insert.txt.html#a" class="d">a</a> metatable.

<a href="luaref.txt.html#debug.getregistry%28%29" class="d">debug.getregistry()</a>                                        <span id="debug.getregistry%28%29" class="t">debug.getregistry()</span>
        Returns the registry table (see <a href="luaref.txt.html#lua-registry" class="l">lua-registry</a>).

debug.getupvalue({func}, <span class="s">{up}</span>)                              <span id="debug.getupvalue%28%29" class="t">debug.getupvalue()</span>
        This function returns the name and the value of the upvalue with <a href="index.txt.html#index" class="d">index</a>
        <span class="s">{up}</span> of the function <span class="s">{func}</span>. The function returns <span class="e">nil</span> if there <a href="motion.txt.html#is" class="d">is</a> no
        upvalue with the given index.

debug.setfenv({object}, <span class="s">{table}</span>)                               <span id="debug.setfenv%28%29" class="t">debug.setfenv()</span>
        Sets the environment of the given <span class="s">{object}</span> to the given <span class="s">{table}</span>.
        Returns <span class="s">{object}</span>.

debug.sethook([{thread},] <span class="s">{hook}</span>, <span class="s">{mask}</span> [, <span class="s">{count}</span>])          <span id="debug.sethook%28%29" class="t">debug.sethook()</span>
        Sets the given function <a href="motion.txt.html#as" class="d">as</a> <a href="insert.txt.html#a" class="d">a</a> hook. The <a href="vimeval.txt.html#string" class="d">string</a> <span class="s">{mask}</span> and the number
        <span class="s">{count}</span> describe when the hook will be called. The <a href="vimeval.txt.html#string" class="d">string</a> mask may
        have the following characters, with the given meaning:

         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"c"</span> <a href="cmdline.txt.html#%3A" class="d">:</a> The hook <a href="motion.txt.html#is" class="d">is</a> called every time <a href="lua.txt.html#Lua" class="d">Lua</a> calls <a href="insert.txt.html#a" class="d">a</a> function;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"r"</span> <a href="cmdline.txt.html#%3A" class="d">:</a> The hook <a href="motion.txt.html#is" class="d">is</a> called every time <a href="lua.txt.html#Lua" class="d">Lua</a> returns from <a href="insert.txt.html#a" class="d">a</a> function;
         <a href="motion.txt.html#-" class="d">-</a> <span class="e">"l"</span> <a href="cmdline.txt.html#%3A" class="d">:</a> The hook <a href="motion.txt.html#is" class="d">is</a> called every time <a href="lua.txt.html#Lua" class="d">Lua</a> enters <a href="insert.txt.html#a" class="d">a</a> new line of
           code.

        With <a href="insert.txt.html#a" class="d">a</a> <span class="s">{count}</span> different from zero, the hook <a href="motion.txt.html#is" class="d">is</a> called after every
        <span class="s">{count}</span> instructions.

        When called without arguments, the <span class="e">debug.sethook</span> turns off the hook.

        When the hook <a href="motion.txt.html#is" class="d">is</a> called, its first parameter <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> describing
        the event that triggered its call: <span class="e">"call"</span>, <span class="e">"return"</span> (or <a href="motion.txt.html#%60" class="d">`</a>"tail
        return"`), <span class="e">"line"</span>, and <span class="e">"count"</span>. For line events, the hook also
        gets the new line number <a href="motion.txt.html#as" class="d">as</a> its second parameter. Inside <a href="insert.txt.html#a" class="d">a</a> hook, you
        can call <span class="e">getinfo</span> with level 2 to get more information about the
        running function (level <a href="motion.txt.html#0" class="d">0</a> <a href="motion.txt.html#is" class="d">is</a> the <span class="e">getinfo</span> function, and level 1 <a href="motion.txt.html#is" class="d">is</a>
        the hook function), unless the event <a href="motion.txt.html#is" class="d">is</a> <a href="motion.txt.html#%60" class="d">`</a>"tail return"<a href="motion.txt.html#%60." class="d">`.</a> In this case,
        <a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> only simulating the return, and <a href="insert.txt.html#a" class="d">a</a> call to <span class="e">getinfo</span> will return
        invalid data.

debug.setlocal([{thread},] <span class="s">{level}</span>, <span class="s">{local}</span>, <span class="s">{value}</span>)         <span id="debug.setlocal%28%29" class="t">debug.setlocal()</span>
        This function assigns the value <span class="s">{value}</span> to the local variable with
        <a href="index.txt.html#index" class="d">index</a> <span class="s">{local}</span> of the function <a href="motion.txt.html#at" class="d">at</a> level <span class="s">{level}</span> of the stack. The
        function returns <span class="e">nil</span> if there <a href="motion.txt.html#is" class="d">is</a> no local variable with the given
        index, and raises an error when called with <a href="insert.txt.html#a" class="d">a</a> <span class="s">{level}</span> out of range.
        (You can call <span class="e">getinfo</span> to check whether the level <a href="motion.txt.html#is" class="d">is</a> valid.)
        Otherwise, <a href="motion.txt.html#it" class="d">it</a> returns the name of the local variable.

debug.setmetatable({object}, <span class="s">{table}</span>)                     <span id="debug.setmetatable%28%29" class="t">debug.setmetatable()</span>
        Sets the <a href="luaref.txt.html#metatable" class="d">metatable</a> <a href="luaref.txt.html#for" class="d">for</a> the given <span class="s">{object}</span> to the given <span class="s">{table}</span> (which
        can be <span class="e">nil</span>).

debug.setupvalue({func}, <span class="s">{up}</span>, <span class="s">{value}</span>)                     <span id="debug.setupvalue%28%29" class="t">debug.setupvalue()</span>
        This function assigns the value <span class="s">{value}</span> to the upvalue with <a href="index.txt.html#index" class="d">index</a> <span class="s">{up}</span>
        of the function <span class="s">{func}</span>. The function returns <span class="e">nil</span> if there <a href="motion.txt.html#is" class="d">is</a> no
        upvalue with the given index. Otherwise, <a href="motion.txt.html#it" class="d">it</a> returns the name of the
        upvalue.

debug.traceback([{thread},] [{message} [,{level}]])          <span id="debug.traceback%28%29" class="t">debug.traceback()</span>
        Returns <a href="insert.txt.html#a" class="d">a</a> <a href="vimeval.txt.html#string" class="d">string</a> with <a href="insert.txt.html#a" class="d">a</a> traceback of the call stack. An optional
        <span class="s">{message}</span> <a href="vimeval.txt.html#string" class="d">string</a> <a href="motion.txt.html#is" class="d">is</a> appended <a href="motion.txt.html#at" class="d">at</a> the beginning of the traceback. An
        optional <span class="s">{level}</span> number tells <a href="motion.txt.html#at" class="d">at</a> which level to start the traceback
        (default <a href="motion.txt.html#is" class="d">is</a> 1, the function calling <span class="e">traceback</span>).

<span class="h">==============================================================================</span>
<span class="c">A  BIBLIOGRAPHY</span>                                            <span id="lua-ref-bibliography" class="t">lua-ref-bibliography</span>

This <a href="helphelp.txt.html#help" class="d">help</a> file <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> minor adaptation from this main reference:

 <a href="motion.txt.html#-" class="d">-</a> R. Ierusalimschy, L. H. de Figueiredo, and W. Celes.,
   "Lua: 5.1 <a href="intro.txt.html#reference" class="d">reference</a> manual"<a href="motion.txt.html#%2C" class="d">,</a> <a class="u" href="https://www.lua.org/manual/5.1/manual.html">https://www.lua.org/manual/5.1/manual.html</a>

<a href="lua.txt.html#Lua" class="d">Lua</a> <a href="motion.txt.html#is" class="d">is</a> discussed in these references:

 <a href="motion.txt.html#-" class="d">-</a> R. Ierusalimschy, L. H. de Figueiredo, and W. Celes.,
   "<a href="lua.txt.html#Lua" class="d">Lua</a> <a href="starting.txt.html#---" class="d">---</a> an extensible extension language"<a href="repeat.txt.html#." class="d">.</a>
   "Software: Practice <a href="change.txt.html#%26" class="d">&amp;</a> Experience" 26, 6 (1996) 635-652.

 <a href="motion.txt.html#-" class="d">-</a> L. H. de Figueiredo, R. Ierusalimschy, and W. Celes.,
   "The design and implementation of <a href="insert.txt.html#a" class="d">a</a> language <a href="luaref.txt.html#for" class="d">for</a> extending applications"<a href="repeat.txt.html#." class="d">.</a>
   "Proc. of XXI Brazilian Seminar on Software and Hardware" (1994) 273-283.

 <a href="motion.txt.html#-" class="d">-</a> L. H. de Figueiredo, R. Ierusalimschy, and W. Celes.,
   "Lua: an extensible embedded language"<a href="repeat.txt.html#." class="d">.</a>
   "Dr. Dobb's Journal" 21, 12 (Dec 1996) 26-33.

 <a href="motion.txt.html#-" class="d">-</a> R. Ierusalimschy, L. H. de Figueiredo, and W. Celes.,
   "The evolution of an extension language: <a href="insert.txt.html#a" class="d">a</a> <a href="cmdline.txt.html#history" class="d">history</a> of <a href="lua.txt.html#Lua" class="d">Lua</a>"<a href="repeat.txt.html#." class="d">.</a>
   "Proc. of <a href="visual.txt.html#V" class="d">V</a> Brazilian Symposium on Programming Languages" (2001) B-14-B-28.

<span class="h">==============================================================================</span>
<span class="c">B  COPYRIGHT AND LICENSES</span>                               <span id="lua-ref-copyright" class="t">lua-ref-copyright</span>

This <a href="helphelp.txt.html#help" class="d">help</a> file has the same <a href="uganda.txt.html#copyright" class="d">copyright</a> and <a href="uganda.txt.html#license" class="d">license</a> <a href="motion.txt.html#as" class="d">as</a> <a href="lua.txt.html#Lua" class="d">Lua</a> 5.1 and the <a href="lua.txt.html#Lua" class="d">Lua</a> 5.1
 manual:

Copyright (c) 1994-2006 Lua.org, PUC-Rio.

Permission <a href="motion.txt.html#is" class="d">is</a> hereby granted, free of charge, to any person obtaining <a href="insert.txt.html#a" class="d">a</a> copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software <a href="motion.txt.html#is" class="d">is</a>
furnished to <a href="diff.txt.html#do" class="d">do</a> so, subject to the following conditions:

The above <a href="uganda.txt.html#copyright" class="d">copyright</a> notice and this permission notice shall be included in all
copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS"<a href="motion.txt.html#%2C" class="d">,</a> WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR <a href="insert.txt.html#A" class="d">A</a> PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

<span class="h">==============================================================================</span>
<span class="c">C  LUAREF DOC</span>                                   <span id="lua-ref-doc" class="t">lua-ref-doc</span>

This <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> Vim <a href="helphelp.txt.html#help" class="d">help</a> file containing <a href="insert.txt.html#a" class="d">a</a> <a href="intro.txt.html#reference" class="d">reference</a> <a href="luaref.txt.html#for" class="d">for</a> <a href="lua.txt.html#Lua" class="d">Lua</a> 5.1, and <a href="motion.txt.html#it" class="d">it</a> <a href="motion.txt.html#is" class="d">is</a> <a href="starting.txt.html#--" class="d">--</a> with
<a href="insert.txt.html#a" class="d">a</a> few exceptions and adaptations <a href="starting.txt.html#--" class="d">--</a> <a href="insert.txt.html#a" class="d">a</a> copy of the <a href="lua.txt.html#Lua" class="d">Lua</a> 5.1 Reference Manual
(see <a href="luaref.txt.html#lua-ref-bibliography" class="l">lua-ref-bibliography</a>). For usage information, refer to
<a href="luaref.txt.html#lua-ref-doc" class="l">lua-ref-doc</a><a href="repeat.txt.html#." class="d">.</a> For <a href="uganda.txt.html#copyright" class="d">copyright</a> information, see <a href="luaref.txt.html#lua-ref-copyright" class="l">lua-ref-copyright</a><a href="repeat.txt.html#." class="d">.</a>

The main ideas and concepts on how to implement this <a href="intro.txt.html#reference" class="d">reference</a> were taken from
Christian Habermann's CRefVim project
(https://www.vim.org/scripts/script.php?script_id=614).

Adapted <a href="luaref.txt.html#for" class="d">for</a> bundled Nvim documentation; the original <a href="usr_05.txt.html#plugin" class="d">plugin</a> can be found <a href="motion.txt.html#at" class="d">at</a>
<a class="u" href="https://www.vim.org/scripts/script.php?script_id=1291">https://www.vim.org/scripts/script.php?script_id=1291</a>

<span class="h">------------------------------------------------------------------------------</span>
 vi:tw=78:ts=4:ft=help:norl:et


</pre>
</div>
</main>
<p>Quick links:
<a href="index.html">help overview</a> &middot;
<a href="quickref.txt.html">quick reference</a> &middot;
<a href="usr_toc.txt.html">user manual toc</a> &middot;
<a href="index.html#reference_toc">reference manual toc</a>
</p>
<footer>This site is maintained by Carlo Teubner (<i>(my first name) at cteubner dot net</i>).</footer>
</body>
</html>