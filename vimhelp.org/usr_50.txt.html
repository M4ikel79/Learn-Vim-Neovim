<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="color-scheme" content="light dark">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Vim help pages, always up-to-date">
<title>Vim: usr_50.txt</title>
<link rel="shortcut icon" href="s/KXPobNpJBGAI5V1t/favicon-vim.ico">
<!-- favicon is based on http://amnoid.de/tmp/vim_solidbright_512.png and is used with permission by its author -->

<link rel="stylesheet" href="s/MsMIu46igYudff1x/tom-select.min.css">
<script defer src="s/RLcAbtLBYX-q5me0/tom-select.base.min.js"></script>

<link rel="stylesheet" href="s/QRMkrs52-wJfIQ-w/vimhelp.css">
<noscript><link rel="stylesheet" href="s/eRFCn9A-K4lmzV_A/noscript.css"></noscript>
<script defer src="s/KpwrKyx19dtnhPoe/vimhelp.js"></script>
</head>
<body>




<div class="bar">
  <div class="ql">Quick links:
<a href="index.html">help overview</a> &middot;
<a href="quickref.txt.html">quick reference</a> &middot;
<a href="usr_toc.txt.html">user manual toc</a> &middot;
<a href="index.html#reference_toc">reference manual toc</a>
&middot; <a href="vim_faq.txt.html">faq</a>
</div>
  <div class="tag srch need-js">
    <select id="vh-select-tag"></select>
    <div class="placeholder">Go to keyword<span class="not-mobile">&nbsp;(shortcut: <kbd>k</kbd>)</span></div>
  </div>
  <form class="site srch" action="https://duckduckgo.com" method="get" target="_blank" rel="noopener noreferrer">
    <input type="hidden" name="sites" value="vimhelp.org">
    <input type="search" name="q" id="vh-srch-input" placeholder="Site search">
    <div class="placeholder need-js">Site search<span class="not-mobile">&nbsp;(shortcut: <kbd>s</kbd>)</span></div>
  </form>
  <div id="theme-switcher" class="need-js">
  <button id="theme-current" title="Switch theme">Theme</button>
  <div id="theme-dropdown"><ul>
    <li><button id="theme-native" title="Switch to native theme">Native</button></li>
    <li><button id="theme-light" title="Switch to light theme">Light</button></li>
    <li><button id="theme-dark" title="Switch to dark theme">Dark</button></li>
  </ul></div>
</div>

</div>

<main>
<div id="vh-sidebar">
<ul><li><a href="usr_50.txt.html#">↑Top↑</a></li>
<li><a href="usr_50.txt.html#50.1">Exceptions</a></li>
<li><a href="usr_50.txt.html#50.2">Function with variable number of arguments</a></li>
<li><a href="usr_50.txt.html#50.3">Restoring the view</a></li>
</ul>
</div>
<div id="vh-content">
<pre>
<span id="usr_50.txt" class="t">usr_50.txt</span>  	For <span class="i">Vim version 9.1.</span>  Last change: 2025 Nov 09


		     VIM USER MANUAL	by <a href="version9.txt.html#Bram" class="d">Bram</a> <a href="version9.txt.html#Moolenaar" class="d">Moolenaar</a>


			 Advanced Vim <a href="usr_41.txt.html#script" class="d">script</a> <a href="editing.txt.html#writing" class="d">writing</a>


<a href="usr_50.txt.html#50.1" class="l">50.1</a>  	Exceptions
<a href="usr_50.txt.html#50.2" class="l">50.2</a>  	Function with variable number of arguments
<a href="usr_50.txt.html#50.3" class="l">50.3</a>  	Restoring the <a href="starting.txt.html#view" class="d">view</a>

     Next chapter: <a href="usr_51.txt.html#usr_51.txt" class="l">usr_51.txt</a>  Create <a href="insert.txt.html#a" class="d">a</a> <a href="usr_05.txt.html#plugin" class="d">plugin</a>
 Previous chapter: <a href="usr_45.txt.html#usr_45.txt" class="l">usr_45.txt</a>  <a href="visual.txt.html#Select" class="d">Select</a> your language (local)
Table of contents: <a href="usr_toc.txt.html#usr_toc.txt" class="l">usr_toc.txt</a>

<span class="h">==============================================================================</span>
<span id="50.1" class="t">50.1</span>  	Exceptions

Let's start with an example: 
<span class="e"></span>
<span class="e">	try</span>
<span class="e">	   read ~/templates/pascal.tmpl</span>
<span class="e">	catch /E484:/</span>
<span class="e">	   echo "Sorry, the Pascal template file cannot be found."</span>
<span class="e">	endtry</span>
<span class="e"></span>
The <span class="e">read</span> command will fail if the file does not exist.  Instead of
generating an error message, this code catches the error and gives the user <a href="insert.txt.html#a" class="d">a</a>
message with more information.

For the commands in between <span class="e">try</span> and <span class="e">endtry</span> <a href="message.txt.html#errors" class="d">errors</a> are turned into
exceptions.  An exception <a href="motion.txt.html#is" class="d">is</a> <a href="insert.txt.html#a" class="d">a</a> string.  In the <a href="change.txt.html#case" class="d">case</a> of an error the <a href="eval.txt.html#string" class="d">string</a>
contains the error message.  And every error message has <a href="insert.txt.html#a" class="d">a</a> number.  In this
case, the error we catch contains "E484:"<a href="repeat.txt.html#." class="d">.</a>  This number <a href="motion.txt.html#is" class="d">is</a> guaranteed to stay
the same (the text may change, e.g., <a href="motion.txt.html#it" class="d">it</a> may be translated).

Besides being able to give <a href="insert.txt.html#a" class="d">a</a> nice error message, Vim will also continue
executing commands after the <span class="e">:endtry</span>.  Otherwise, once an uncaught error <a href="motion.txt.html#is" class="d">is</a>
encountered, execution of the script/function/mapping will be aborted.

When the <span class="e">read</span> command causes another error, the <a href="pattern.txt.html#pattern" class="d">pattern</a> "E484:" will not
match in it.  Thus this exception will not be caught and result in the usual
error message and execution <a href="motion.txt.html#is" class="d">is</a> aborted.

You might be tempted to <a href="diff.txt.html#do" class="d">do</a> this: 
<span class="e"></span>
<span class="e">	try</span>
<span class="e">	   read ~/templates/pascal.tmpl</span>
<span class="e">	catch</span>
<span class="e">	   echo "Sorry, the Pascal template file cannot be found."</span>
<span class="e">	endtry</span>
<span class="e"></span>
This means all <a href="message.txt.html#errors" class="d">errors</a> are caught.  But then you will not see an error that
would indicate <a href="insert.txt.html#a" class="d">a</a> completely different problem, such <a href="motion.txt.html#as" class="d">as</a> "E21: Cannot make
changes, <a href="options.txt.html#%27modifiable%27" class="o">'modifiable'</a> <a href="motion.txt.html#is" class="d">is</a> off"<a href="repeat.txt.html#." class="d">.</a>  Think twice before you catch any error!

Another useful mechanism <a href="motion.txt.html#is" class="d">is</a> the <span class="e">finally</span> command: 
<span class="e"></span>
<span class="e">	var tmp = tempname()</span>
<span class="e">	try</span>
<span class="e">	   exe ":.,$write " .. tmp</span>
<span class="e">	   exe "!filter " .. tmp</span>
<span class="e">	   :.,$delete</span>
<span class="e">	   exe ":$read " .. tmp</span>
<span class="e">	finally</span>
<span class="e">	   delete(tmp)</span>
<span class="e">	endtry</span>
<span class="e"></span>
This filters the lines from the cursor until the <a href="intro.txt.html#end" class="d">end</a> of the file through the
"<a href="change.txt.html#filter" class="d">filter</a>" command, which takes <a href="insert.txt.html#a" class="d">a</a> file name argument.  No matter if the
filtering works, if something goes wrong in between <span class="e">try</span> and <span class="e">finally</span> or the
user cancels the filtering by pressing <a href="pattern.txt.html#CTRL-C" class="k">CTRL-C</a>, the <span class="e">delete(tmp)</span> call <a href="motion.txt.html#is" class="d">is</a>
always executed.  This makes sure you don't leave the temporary file behind.

The <span class="e">finally</span> does not catch the exception, the error will still abort
further execution.

More information about exception handling can be found in the <a href="intro.txt.html#reference" class="d">reference</a>
manual: <a href="eval.txt.html#exception-handling" class="l">exception-handling</a><a href="repeat.txt.html#." class="d">.</a>

<span class="h">==============================================================================</span>
<span id="50.2" class="t">50.2</span>  	Function with variable number of arguments

Vim enables you to define <a href="eval.txt.html#functions" class="d">functions</a> that have <a href="insert.txt.html#a" class="d">a</a> variable number of arguments.
The following command, for instance, defines <a href="insert.txt.html#a" class="d">a</a> function that <a href="vim_faq.txt.html#must" class="d">must</a> have 1
argument (start) and can have up to 20 additional arguments: 
<span class="e"></span>
<span class="e">	def Show(start: string, ...items: list&lt;string&gt;)</span>
<span class="e"></span>
The variable "items" will be <a href="insert.txt.html#a" class="d">a</a> <a href="eval.txt.html#list" class="d">list</a> in the function containing the extra
arguments.  You can use <a href="motion.txt.html#it" class="d">it</a> like any list, for example: 
<span class="e"></span>
<span class="e">	def Show(start: string, ...items: list&lt;string&gt;)</span>
<span class="e">	  echohl Title</span>
<span class="e">	  echo "start is " .. start</span>
<span class="e">	  echohl None</span>
<span class="e">	  for index in range(len(items))</span>
<span class="e">	    echon $"  Arg {index} is {items[index]}"</span>
<span class="e">	  endfor</span>
<span class="e">	  echo</span>
<span class="e">	enddef</span>
<span class="e"></span>
You can call <a href="motion.txt.html#it" class="d">it</a> like this: 
<span class="e"></span>
<span class="e">	Show('Title', 'one', 'two', 'three')</span>
<span class="h">	start is Title  Arg 0 is one  Arg 1 is two  Arg 2 is three </span>

This uses the <span class="e">echohl</span> command to specify the highlighting used for the
following <span class="e">echo</span> command.  `echohl None` stops <a href="motion.txt.html#it" class="d">it</a> again.  The <span class="e">echon</span> command
works like <span class="e">echo</span>, but doesn't output <a href="insert.txt.html#a" class="d">a</a> line break.

If you call <a href="motion.txt.html#it" class="d">it</a> with one argument the "items" <a href="eval.txt.html#list" class="d">list</a> will be empty.
<span class="e">range(len(items))</span> returns <a href="insert.txt.html#a" class="d">a</a> <a href="eval.txt.html#list" class="d">list</a> with the indexes, what <span class="e">for</span> loops over,
we'll explain that further down.

<span class="h">==============================================================================</span>
<span id="50.3" class="t">50.3</span>  	Restoring the <a href="starting.txt.html#view" class="d">view</a>

Sometimes you want to jump around, make <a href="insert.txt.html#a" class="d">a</a> change and then <a href="motion.txt.html#go" class="d">go</a> back to the same
position and view.  For example to change something in the file header.  This
can be done with two functions: 
<span class="e"></span>
<span class="e">	var view = winsaveview()</span>
<span class="e">	# Move around, make changes</span>
<span class="e">	winrestview(view)</span>
<span class="e"></span>
<span class="h">==============================================================================</span>

Next chapter: <a href="usr_51.txt.html#usr_51.txt" class="l">usr_51.txt</a>  Create <a href="insert.txt.html#a" class="d">a</a> <a href="usr_05.txt.html#plugin" class="d">plugin</a>

Copyright: see <a href="usr_01.txt.html#manual-copyright" class="l">manual-copyright</a>  vim:tw=78:ts=8:noet:ft=help:norl:


</pre>
</div>
</main>
<p>Quick links:
<a href="index.html">help overview</a> &middot;
<a href="quickref.txt.html">quick reference</a> &middot;
<a href="usr_toc.txt.html">user manual toc</a> &middot;
<a href="index.html#reference_toc">reference manual toc</a>
&middot; <a href="vim_faq.txt.html">faq</a>
</p>
<footer>This site is maintained by Carlo Teubner (<i>(my first name) at cteubner dot net</i>).</footer>
</body>
</html>